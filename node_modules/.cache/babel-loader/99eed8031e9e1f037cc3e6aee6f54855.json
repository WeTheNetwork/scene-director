{"ast":null,"code":"import _possibleConstructorReturn from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn.js\";import _regeneratorRuntime from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _createClass from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _classCallCheck from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _inherits from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import*as THREE from'../lib/three.min.js';import{EventEmitter}from'events';import{CSS3DRenderer}from'../lib/CSS3DRenderer.js';// The ScreenDirector //\n/* ------------------\r\n  Aware of the environment ( Window, Document, User Interface API, SceneAssets ), to the extent necessary to create a seemlessly animated web interface.\r\n  Scenes are complex, orchestrated animations which are driven by the ScreenDirector to create a rich user experience for webapp interactions.\r\n  Use this to prepare the user-interface for interaction, then to drive the interaction through each entry in your site's manifesto.\r\n*/var ScreenDirector=/*#__PURE__*/function(_EventEmitter){_inherits(ScreenDirector,_EventEmitter);var _super=_createSuper(ScreenDirector);// State Awareness Variable\n// Track the dictums by name in an array for efficient iteration control.\n// screenplay: This object contains the lights, cameras, ations... actors, directions, etc... to run the scene.\n// manifesto: The orchestrated performance of an animated THREE.js environment and the workflow of a web app.\n// start_now: Whether to begin immediately once the ScreenDirector has been generated, or to wait for the .start() method call.\nfunction ScreenDirector(screenplay,manifesto,start_now){var _this;_classCallCheck(this,ScreenDirector);_this=_super.call(this);// Instantiating the EventEmitter super class gives access to 'this'.\n// Listen to environmental changes, adjust accordingly.\n_this.active_dictum=0;_this.dictum_index=[];_this.start=function(){this.screenplay.animate();// Kickstart the animation loop\nthis.emit('first_dictum');// Begin the Manifesto\n};_this.onPointerDown=function(event){_this.mouse.x=event.clientX/window.innerWidth*2-1;_this.mouse.y=-(event.clientY/window.innerHeight)*2+1;_this.raycaster.setFromCamera(_this.mouse,_this.screenplay.scene_assets.active_cam);var intersects=_this.screenplay.scene_assets.interactives&&_this.screenplay.scene_assets.interactives.length>0?_this.raycaster.intersectObjects(_this.screenplay.scene_assets.interactives,false):[];if(intersects.length>0){// Capture the first clicked target\nvar object=intersects[0].object;var pos=object.position;object.click();// Fire the object's internal click handler if any.\n}};window.addEventListener('pointerdown',_this.onPointerDown);window.addEventListener('resize',_this.resize,{capture:true});_this.raycaster=new THREE.Raycaster();_this.mouse=new THREE.Vector2();_this.screenplay=screenplay;_this.manifesto=manifesto;// Iterate through the provided dictums, generating event-handing pathways to progress through the manifesto.\nfor(var dictum_name in _this.manifesto){_this.dictum_index.push(dictum_name);var dictum=_this.manifesto[dictum_name];// Keep track of the success and failure of the screenplay's dictum logic.\ndictum.progress={completed:0,failed:0,passed:0};// EventHandler <dictum_name>: When fired, executes the designated functions in order, reporting the progress to the <dictum_name>_progress eventhandler.\n_this.on(\"\".concat(dictum_name),/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(dictum_name){var dictum,logic_count,ndx,logic_response,_logic_response;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:// Run Entry Directions\ndictum=this.manifesto[dictum_name];_context.next=3;return dictum.directions.on_enter(this.screenplay);case 3:// Begin Idle Directions while continuing on to the dictum logic.\ndictum.directions.on_idle(this.screenplay);// Run the dictum logic\nlogic_count=0;if(dictum.logic){_context.next=7;break;}throw new Error('Dictums must be logical.  Declare a void function at least.');case 7:if(!Array.isArray(dictum.logic)){_context.next=20;break;}// Differentiate between singular functions and function arrays\nlogic_count=dictum.logic.length;ndx=0;case 10:if(!(ndx<dictum.logic.length)){_context.next=18;break;}_context.next=13;return dictum.logic[ndx](this.screenplay);case 13:logic_response=_context.sent;// Wait on the response for this dictum logic algorithm before moving to the next in the array... NOTE: Must be a valid thing to pass on to the _progress event.\nthis.emit(\"\".concat(dictum_name,\"_progress\"),dictum_name,logic_count,logic_response);// Emit the progress event for this dictum... along with how many there are to expect.\ncase 15:ndx++;_context.next=10;break;case 18:_context.next=25;break;case 20:logic_count=1;_context.next=23;return dictum.logic(this.screenplay);case 23:_logic_response=_context.sent;// Wait on the response to this dictum's one logic algorithm... NOTE: Must be a valid thing to pass on to the _progress event.\nthis.emit(\"\".concat(dictum_name,\"_progress\"),dictum_name,logic_count,_logic_response);// Emit the progress event for this dictum... along with 1, how many there are to expect.\ncase 25:case\"end\":return _context.stop();}}},_callee,this);}));return function(_x){return _ref.apply(this,arguments);};}());// EventHandler <dictum_name>_progress: When fired, determines success or failure of the dictum, and upon determination, responds to the 'confirm_dictum' or 'fail_dictum' eventhandlers respectively.\n_this.on(\"\".concat(dictum_name,\"_progress\"),/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(dictum_name,count,response){var dictum,ndx;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dictum=this.manifesto[dictum_name];dictum.progress.completed++;if(!response){_context2.next=22;break;}_context2.next=5;return dictum.directions.on_progress(this.screenplay);case 5:dictum.progress.passed++;if(!(dictum.progress.passed===count)){_context2.next=20;break;}if(!Array.isArray(dictum.directions.on_end)){_context2.next=17;break;}ndx=0;case 9:if(!(ndx<dictum.directions.on_end.length)){_context2.next=15;break;}_context2.next=12;return dictum.directions.on_end[ndx](this.screenplay);case 12:ndx++;_context2.next=9;break;case 15:_context2.next=19;break;case 17:_context2.next=19;return dictum.directions.on_end(this.screenplay);case 19:// Confirm this dictum step if all have passed successfully.\nthis.emit('confirm_dictum',dictum_name);case 20:_context2.next=25;break;case 22:dictum.progress.failed++;// Mark this as failed.\n_context2.next=25;return dictum.directions.on_failure(this.screenplay);case 25:// If there is a failure during this dictum step, then emit a failure... else it would have been confirmed above.\n// NOTE: Failure will need to progress or return to complete the step.\nif(dictum.progress.completed===count&&dictum.progress.failed>0)this.emit('fail_dictum',dictum_name);case 26:case\"end\":return _context2.stop();}}},_callee2,this);}));return function(_x2,_x3,_x4){return _ref2.apply(this,arguments);};}());}/* Static, Internal Event Functions */ // EventHandler 'first_dictum': When fired, begins the process by setting the ScreenDirector to the first dictum, then emitting that event immediately.\n_this.on('first_dictum',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee3(){var dictum_name;return _regeneratorRuntime().wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:dictum_name=this.dictum_index[0];this.emit(\"\".concat(dictum_name),dictum_name);case 2:case\"end\":return _context3.stop();}}},_callee3,this);})));// EventHandler 'next_dictum': When fired, increments the ScreenDirector to the next dictum, or past; emitting either that <dictum_name> event, or the 'manifesto_compete' event respectively.\n_this.on('next_dictum',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee4(){var dictum_name;return _regeneratorRuntime().wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:this.active_dictum++;dictum_name=this.dictum_index[this.active_dictum];if(this.active_dictum<this.dictum_index.length){this.emit(\"\".concat(dictum_name),dictum_name);}else{this.emit('manifesto_complete');}case 3:case\"end\":return _context4.stop();}}},_callee4,this);})));// EventHandler 'prev_dictum': When fired, decrements the ScreenDirector to the previous dictum, until the first; emitting either that <dictum_name> event, or the 'first_dictum' event respectively.\n_this.on('prev_dictum',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee5(){var dictum_name;return _regeneratorRuntime().wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:this.active_dictum--;dictum_name=this.dictum_index[this.active_dictum];if(this.active_dictum>0){this.emit(\"\".concat(dictum_name),dictum_name);}else{this.emit('first_dictum');}case 3:case\"end\":return _context5.stop();}}},_callee5,this);})));// EventHandler 'confirm_dictum': When fired, the ScreenDirector marks this dictum as confirmed, signalling that all dictums succeeded in their task.\n//                                Next, the 'next_dictum' event is fired to continue the production.\n_this.on('confirm_dictum',/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee6(dictum_name){return _regeneratorRuntime().wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:this.manifesto[dictum_name].result.complete=true;this.emit('next_dictum');case 2:case\"end\":return _context6.stop();}}},_callee6,this);}));return function(_x5){return _ref6.apply(this,arguments);};}());// EventHandler 'fail_dictum':  When fired, the ScreenDirector marks this dictum as failed, signalling that one or more dictums have not failed in their task.\n//                              Next, the 'next_dictum' event is fired to continue the production.\n_this.on('fail_dictum',/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee7(dictum_name){return _regeneratorRuntime().wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:if(this.manifesto[dictum_name].result.fok){if(this.manifesto[dictum_name].result.retry){this.emit(\"\".concat(dictum_name),dictum_name);}else{this.emit('next_dictum');}}else{this.emit(\"\".concat(dictum_name),dictum_name);}case 1:case\"end\":return _context7.stop();}}},_callee7,this);}));return function(_x6){return _ref7.apply(this,arguments);};}());// EventHandler 'manifesto_compete': When fired, the ScreenDirector takes a bow... idles to wait for more... or even closes if so desired.\n_this.on('manifesto_complete',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee8(){return _regeneratorRuntime().wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:case\"end\":return _context8.stop();}}},_callee8);})));_this.on('error',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee9(){return _regeneratorRuntime().wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:case\"end\":return _context9.stop();}}},_callee9);})));/* Best Practice: Node exits if not declared and an unhandled 'error' event is thrown. */ // Kick off the first dictum now that initialization has completed.\nif(start_now)_this.start();return _this;}return _createClass(ScreenDirector);}(EventEmitter);// Screenplay //\n/* ----------\r\n  As one might read a screenplay for a production in real-life, the ScreenDirector may learn the Screenplay provided to know how to progress the scene in tandem\r\n  with the user interface's workflow, referred to as the Manifesto.  The Screenplay owns the SceneAssets which it will be referring to during run-time, as well as\r\n  the SceneDirections which tell them what to be doing.\r\n*/var Screenplay=/*#__PURE__*/_createClass(// Place objects which must have their '.update()' function run during the render phase.\n// Populate this with the rendered objects which the user may interact with... improving the efficiency of the Raycaster.\n// Actors are SceneAsset3D objects which are defined with callable directions, whether cosmetic or complex routines, called by the ScreenDirector during Animate().\n// Standard-Issue Hollywood Magic Makers\n// Multiple cameras are able to be defined, thus called upon by the ScreenDirector.\n// Scene-wide actions are defined here... ie. \"Camera Shake\", \"Perspective Morph\", \"Scene Cut Transitions\".\n// This is the placeholder for the stage if created... though a stage is never required.\n// This is the placeholder for the background if created... though it is also not required.\n// Use this to create a Three.CubeCamera as a skybox... be sure to update the skybox camera during the render phase.\n// Rendering & Update Logic\n// Handle Viewscreen Changes\nfunction Screenplay(){var _this2=this;_classCallCheck(this,Screenplay);this.ENTIRE_SCENE=0;this.animate=function(){requestAnimationFrame(_this2.animate);_this2.delta+=_this2.clock.getDelta();if(_this2.delta>_this2.interval){_this2.update(_this2.delta);_this2.direct(_this2.delta);_this2.render();_this2.ui_render();_this2.delta=_this2.delta%_this2.interval;}};this.controls={};this.actives=[];this.interactives=[];this.actors={};this.lights={};this.actions={};this.stage={};this.backgroundScenery={};this.sceneBackground={};this.update=function(delta){_this2.updatables.forEach(function(updatable,name){if(updatable.update)updatable.update(delta);});};this.direct=function(delta){_this2.actives.forEach(function(active,name){if(!active.directions)debugger;active.directions.forEach(function(direction,name){direction(delta);});});};this.render=function(){_this2.renderer.render(_this2.scene,_this2.active_cam);};this.ui_render=function(){_this2.ui_renderer.render(_this2.ui_scene,_this2.active_cam);};this.resize=function(){var aspect=window.innerWidth/window.innerHeight;var active_cam=_this2.active_cam;active_cam.aspect=aspect;active_cam.updateProjectionMatrix();_this2.renderer.setSize(window.innerWidth,window.innerHeight);_this2.ui_renderer.setSize(window.innerWidth,window.innderHeight);};// Internal Clock\n// TODO: Set this to a configuration value\nvar clock=new THREE.Clock();this.clock=clock;var _delta=0;this.delta=_delta;var fps=30;var interval=1/fps;this.interval=interval;// Mouse Interaction Capture\nvar raycaster=new THREE.Raycaster();this.raycaster=raycaster;var mouse=new THREE.Vector2();this.mouse=mouse;this.updatables=new Map();this.cameras=new Map();this.active_cam=false;this.scene=new THREE.Scene();this.ui_scene=new THREE.Scene();this.scene.updates={update:function update(){},cache:{}};this.updatables.set('scene',this.scene.updates);// Scene Renderer\nvar renderer=new THREE.WebGLRenderer({antialias:true,logarithmicDepthBuffer:true,physicallyCorrectLights:true});renderer.shadowMap.enabled=true;renderer.shadowMap.type=THREE.PCFSoftShadowMap;renderer.setSize(window.innerWidth,window.innerHeight);renderer.setPixelRatio(window.devicePixelRatio?window.devicePixelRatio:1);var canvas=renderer.domElement;document.body.appendChild(canvas);this.renderer=renderer;// UI Renderer\nvar ui_renderer=new CSS3DRenderer();ui_renderer.setSize(window.innerWidth,window.innerHeight);var ui_canvas=ui_renderer.domElement;ui_canvas.style['background-color']='transparent';ui_canvas.style.position='fixed';document.body.appendChild(ui_canvas);this.ui_renderer=ui_renderer;});// SceneAsset3D //\n/* ------------\r\n  In order to optimize the Animate() phase of the ScreenPlay, SceneAsset3D objects own the directions they will be performing... to be called on-demand by the ScreenDirector.\r\n  Analogous to an actor in real-life learning their part of the production... their Director then simply calls upon them to perform it when the time comes.\r\n*/var SceneAsset3D=/*#__PURE__*/function(_THREE$Object3D){_inherits(SceneAsset3D,_THREE$Object3D);var _super2=_createSuper(SceneAsset3D);// Override this with a custom set of functions to be called by the ScreenDirector during the Animate() run of the Screenplay.\nfunction SceneAsset3D(){var _this3;var obj3D=arguments.length>0&&arguments[0]!==undefined?arguments[0]:new THREE.Object3D();_classCallCheck(this,SceneAsset3D);obj3D.directions=new Map();obj3D.click=function(){};return _possibleConstructorReturn(_this3,obj3D);}return _createClass(SceneAsset3D);}(THREE.Object3D);// SceneDirections //\n/* ---------------\r\n  Directions are declared as child functions of this object upon instantiation... and are defined entirely by the user.\r\n  // NOTE: Without any standardized functionality to declare, and no run-time construction requirements, a commented-out example is necessary to understand the expected syntax.\r\n*/var SceneDirections=/*#__PURE__*/_createClass(function SceneDirections(){_classCallCheck(this,SceneDirections);});// Workflow //\n/* --------\r\n  This is where the application logic is located, to be called by the ScreenDirector as defined by the Manifesto.\r\n  // NOTE: Without any standardized functionality to declare, and no run-time construction requirements, a commented-out example is necessary to understand the expected syntax.\r\n*/var Workflow=/*#__PURE__*/_createClass(function Workflow(){_classCallCheck(this,Workflow);});// Dictum //\n/* ------\r\n  The formal representation for a set of directions to coordinate alongside the logic algorithms of the WorkFlow.\r\n  Tracking the success or failure of the Dictum is included within on construction... defining what to do upon each outcome.\r\n*/var Dictum=/*#__PURE__*/_createClass(// logic: Passed on by the Manifesto from it's own construction\n// directions: JSON with functions to run for:\n//    on_enter, on_idle, on_progress, on_failure, on_end.\nfunction Dictum(logic,directions,okay_to_fail,prompt_on_fail){_classCallCheck(this,Dictum);this.logic=logic;this.directions=directions;this.result={fok:okay_to_fail,retry:prompt_on_fail};});// Manifesto //\n/* ---------\r\n  Literally a public declaration of intentions, this object is knit together by you ( the developer ), using the instantiated SceneDirections & Workflow objects.\r\n*/var Manifesto=/*#__PURE__*/_createClass(// NOTE: Though this constructor is not implemented, it is relevent to keep this for an explicit understanding of what is expected by the developer employing this solution.\nfunction Manifesto(scene_directions,workflow){_classCallCheck(this,Manifesto);});export{ScreenDirector,Screenplay,SceneAsset3D,SceneDirections,Workflow,Dictum,Manifesto};","map":{"version":3,"names":["THREE","EventEmitter","CSS3DRenderer","ScreenDirector","screenplay","manifesto","start_now","active_dictum","dictum_index","start","animate","emit","onPointerDown","event","mouse","x","clientX","window","innerWidth","y","clientY","innerHeight","raycaster","setFromCamera","scene_assets","active_cam","intersects","interactives","length","intersectObjects","object","pos","position","click","addEventListener","resize","capture","Raycaster","Vector2","dictum_name","push","dictum","progress","completed","failed","passed","on","directions","on_enter","on_idle","logic_count","logic","Error","Array","isArray","ndx","logic_response","count","response","on_progress","on_end","on_failure","result","complete","fok","retry","Screenplay","ENTIRE_SCENE","requestAnimationFrame","delta","clock","getDelta","interval","update","direct","render","ui_render","controls","actives","actors","lights","actions","stage","backgroundScenery","sceneBackground","updatables","forEach","updatable","name","active","direction","renderer","scene","ui_renderer","ui_scene","aspect","updateProjectionMatrix","setSize","innderHeight","Clock","fps","Map","cameras","Scene","updates","cache","set","WebGLRenderer","antialias","logarithmicDepthBuffer","physicallyCorrectLights","shadowMap","enabled","type","PCFSoftShadowMap","setPixelRatio","devicePixelRatio","canvas","domElement","document","body","appendChild","ui_canvas","style","SceneAsset3D","obj3D","Object3D","SceneDirections","Workflow","Dictum","okay_to_fail","prompt_on_fail","Manifesto","scene_directions","workflow"],"sources":["C:/Phox.Solutions/Workshop/GitHub-Repos/WeTheNetwork/scene-director/src/bin/ScreenDirector.js"],"sourcesContent":["import * as THREE from '../lib/three.min.js';\r\nimport { EventEmitter } from 'events';\r\nimport { CSS3DRenderer } from '../lib/CSS3DRenderer.js';\r\n\r\n// The ScreenDirector //\r\n/* ------------------\r\n  Aware of the environment ( Window, Document, User Interface API, SceneAssets ), to the extent necessary to create a seemlessly animated web interface.\r\n  Scenes are complex, orchestrated animations which are driven by the ScreenDirector to create a rich user experience for webapp interactions.\r\n  Use this to prepare the user-interface for interaction, then to drive the interaction through each entry in your site's manifesto.\r\n*/\r\nclass ScreenDirector extends EventEmitter {\r\n  active_dictum = 0;  // State Awareness Variable\r\n  dictum_index = [];  // Track the dictums by name in an array for efficient iteration control.\r\n\r\n  start = function(){\r\n    this.screenplay.animate();  // Kickstart the animation loop\r\n    this.emit('first_dictum');  // Begin the Manifesto\r\n  }\r\n\r\n  // GUI Interactions\r\n  raycaster; mouse;\r\n  onPointerDown = ( event )=> {\r\n    this.mouse.x = ( event.clientX / window.innerWidth ) * 2 - 1;\r\n    this.mouse.y = - ( event.clientY / window.innerHeight ) * 2 + 1;\r\n\r\n    this.raycaster.setFromCamera( this.mouse, this.screenplay.scene_assets.active_cam );\r\n    const intersects = (this.screenplay.scene_assets.interactives && this.screenplay.scene_assets.interactives.length > 0) ? this.raycaster.intersectObjects( this.screenplay.scene_assets.interactives, false ) : [];\r\n    if ( intersects.length > 0 ) {\r\n\r\n\r\n      // Capture the first clicked target\r\n      const object = intersects[ 0 ].object;\r\n      let pos = object.position;\r\n      object.click(); // Fire the object's internal click handler if any.\r\n\r\n    }\r\n  }\r\n\r\n  // screenplay: This object contains the lights, cameras, ations... actors, directions, etc... to run the scene.\r\n  // manifesto: The orchestrated performance of an animated THREE.js environment and the workflow of a web app.\r\n  // start_now: Whether to begin immediately once the ScreenDirector has been generated, or to wait for the .start() method call.\r\n  constructor( screenplay, manifesto, start_now ){\r\n    super();  // Instantiating the EventEmitter super class gives access to 'this'.\r\n    // Listen to environmental changes, adjust accordingly.\r\n    window.addEventListener( 'pointerdown', this.onPointerDown );\r\n    window.addEventListener( 'resize', this.resize, { capture: true } );\r\n\r\n\r\n    this.raycaster = new THREE.Raycaster();\r\n    this.mouse = new THREE.Vector2();\r\n\r\n    this.screenplay = screenplay;\r\n    this.manifesto = manifesto;\r\n\r\n    // Iterate through the provided dictums, generating event-handing pathways to progress through the manifesto.\r\n    for (const dictum_name in this.manifesto) {\r\n      this.dictum_index.push(dictum_name);\r\n      let dictum = this.manifesto[dictum_name];\r\n\r\n      // Keep track of the success and failure of the screenplay's dictum logic.\r\n      dictum.progress = { completed: 0, failed: 0, passed: 0 };\r\n\r\n      // EventHandler <dictum_name>: When fired, executes the designated functions in order, reporting the progress to the <dictum_name>_progress eventhandler.\r\n      this.on(`${dictum_name}`, async function( dictum_name ){\r\n\r\n        // Run Entry Directions\r\n        let dictum = this.manifesto[dictum_name];\r\n        await dictum.directions.on_enter(this.screenplay);\r\n\r\n        // Begin Idle Directions while continuing on to the dictum logic.\r\n        dictum.directions.on_idle(this.screenplay);\r\n\r\n        // Run the dictum logic\r\n        let logic_count = 0;\r\n        if(!dictum.logic) throw new Error('Dictums must be logical.  Declare a void function at least.');   // Feedback for the Dictum writers.\r\n        if(Array.isArray(dictum.logic)){     // Differentiate between singular functions and function arrays\r\n          logic_count = dictum.logic.length;\r\n          for(let ndx=0; ndx<dictum.logic.length;ndx++){\r\n            let logic_response = await dictum.logic[ndx]( this.screenplay ); // Wait on the response for this dictum logic algorithm before moving to the next in the array... NOTE: Must be a valid thing to pass on to the _progress event.\r\n            this.emit(`${dictum_name}_progress`, dictum_name, logic_count, logic_response);  // Emit the progress event for this dictum... along with how many there are to expect.\r\n          }\r\n        } else {\r\n          logic_count = 1;\r\n          let logic_response = await dictum.logic( this.screenplay );  // Wait on the response to this dictum's one logic algorithm... NOTE: Must be a valid thing to pass on to the _progress event.\r\n          this.emit(`${dictum_name}_progress`, dictum_name, logic_count, logic_response); // Emit the progress event for this dictum... along with 1, how many there are to expect.\r\n        }\r\n\r\n      });\r\n\r\n      // EventHandler <dictum_name>_progress: When fired, determines success or failure of the dictum, and upon determination, responds to the 'confirm_dictum' or 'fail_dictum' eventhandlers respectively.\r\n      this.on(`${dictum_name}_progress`, async function( dictum_name, count, response ){\r\n        let dictum = this.manifesto[dictum_name];\r\n        dictum.progress.completed++;\r\n        if(response) {\r\n          // Run Logic Progression directions\r\n          await dictum.directions.on_progress( this.screenplay );\r\n          dictum.progress.passed++;\r\n          if(dictum.progress.passed === count) {\r\n            // Perform the 'on_end' directions prior to confirming it and progressing on.\r\n            if(Array.isArray(dictum.directions.on_end)){  // Differentiate between singular functions and function arrays\r\n              for(let ndx=0;ndx<dictum.directions.on_end.length;ndx++){\r\n                await dictum.directions.on_end[ndx]( this.screenplay ); // Wait for the directions to complete before moving on to the next one.\r\n              }\r\n            } else {\r\n              await dictum.directions.on_end( this.screenplay );  // Wait for the directions to complete before moving on to confirm the step.\r\n            }\r\n            // Confirm this dictum step if all have passed successfully.\r\n            this.emit('confirm_dictum', dictum_name);\r\n          }\r\n        } else {\r\n          dictum.progress.failed++;  // Mark this as failed.\r\n          await dictum.directions.on_failure( this.screenplay );\r\n        }\r\n        // If there is a failure during this dictum step, then emit a failure... else it would have been confirmed above.\r\n        // NOTE: Failure will need to progress or return to complete the step.\r\n        if(dictum.progress.completed === count && dictum.progress.failed > 0) this.emit('fail_dictum', dictum_name);\r\n\r\n      })\r\n\r\n    }\r\n\r\n    /* Static, Internal Event Functions */\r\n    // EventHandler 'first_dictum': When fired, begins the process by setting the ScreenDirector to the first dictum, then emitting that event immediately.\r\n    this.on('first_dictum', async function(){\r\n      let dictum_name = this.dictum_index[0];\r\n      this.emit(`${dictum_name}`, dictum_name);\r\n    });\r\n\r\n    // EventHandler 'next_dictum': When fired, increments the ScreenDirector to the next dictum, or past; emitting either that <dictum_name> event, or the 'manifesto_compete' event respectively.\r\n    this.on('next_dictum', async function(){\r\n      this.active_dictum++;\r\n      let dictum_name = this.dictum_index[this.active_dictum];\r\n      if(this.active_dictum < this.dictum_index.length){\r\n        this.emit(`${dictum_name}`, dictum_name);\r\n      } else {\r\n        this.emit('manifesto_complete');\r\n      }\r\n    });\r\n\r\n    // EventHandler 'prev_dictum': When fired, decrements the ScreenDirector to the previous dictum, until the first; emitting either that <dictum_name> event, or the 'first_dictum' event respectively.\r\n    this.on('prev_dictum', async function(){\r\n      this.active_dictum--;\r\n      let dictum_name = this.dictum_index[this.active_dictum];\r\n      if(this.active_dictum > 0){\r\n        this.emit(`${dictum_name}`, dictum_name);\r\n      } else {\r\n        this.emit('first_dictum');\r\n      }\r\n    });\r\n\r\n    // EventHandler 'confirm_dictum': When fired, the ScreenDirector marks this dictum as confirmed, signalling that all dictums succeeded in their task.\r\n    //                                Next, the 'next_dictum' event is fired to continue the production.\r\n    this.on('confirm_dictum', async function(dictum_name){\r\n      this.manifesto[dictum_name].result.complete = true;\r\n      this.emit('next_dictum');\r\n    });\r\n\r\n    // EventHandler 'fail_dictum':  When fired, the ScreenDirector marks this dictum as failed, signalling that one or more dictums have not failed in their task.\r\n    //                              Next, the 'next_dictum' event is fired to continue the production.\r\n    this.on('fail_dictum', async function(dictum_name){\r\n      if(this.manifesto[dictum_name].result.fok){\r\n        if(this.manifesto[dictum_name].result.retry){\r\n          this.emit(`${dictum_name}`, dictum_name);\r\n        } else {\r\n          this.emit('next_dictum');\r\n        }\r\n      } else {\r\n          this.emit(`${dictum_name}`, dictum_name);\r\n      }\r\n\r\n    });\r\n\r\n    // EventHandler 'manifesto_compete': When fired, the ScreenDirector takes a bow... idles to wait for more... or even closes if so desired.\r\n    this.on('manifesto_complete', async function(){\r\n      // TODO: Take a bow | clean up after yourself.\r\n    });\r\n\r\n    this.on('error', async function(){}); /* Best Practice: Node exits if not declared and an unhandled 'error' event is thrown. */\r\n\r\n    // Kick off the first dictum now that initialization has completed.\r\n    if(start_now) this.start();\r\n  }\r\n}\r\n\r\n// Screenplay //\r\n/* ----------\r\n  As one might read a screenplay for a production in real-life, the ScreenDirector may learn the Screenplay provided to know how to progress the scene in tandem\r\n  with the user interface's workflow, referred to as the Manifesto.  The Screenplay owns the SceneAssets which it will be referring to during run-time, as well as\r\n  the SceneDirections which tell them what to be doing.\r\n*/\r\nclass Screenplay{\r\n  ENTIRE_SCENE = 0;\r\n  active_cam;\r\n  scene_assets; scene; ui_scene; renderer; ui_renderer;\r\n  clock; delta; fps; interval; raycaster; mouse;\r\n\r\n  animate = ()=>{\r\n    requestAnimationFrame( this.animate );\r\n    this.delta += this.clock.getDelta();\r\n    if (this.delta  > this.interval) {\r\n      this.update( this.delta );\r\n      this.direct( this.delta );\r\n      this.render();\r\n      this.ui_render();\r\n      this.delta = this.delta % this.interval;\r\n    }\r\n  }\r\n  controls = {};\r\n\r\n  // Grouping Arrays... Add models here to isolate unrelated items during processing (ie. Click / Tap events)\r\n  updatables;  // Place objects which must have their '.update()' function run during the render phase.\r\n  actives = [];\r\n  interactives = [];  // Populate this with the rendered objects which the user may interact with... improving the efficiency of the Raycaster.\r\n\r\n  actors = {};  // Actors are SceneAsset3D objects which are defined with callable directions, whether cosmetic or complex routines, called by the ScreenDirector during Animate().\r\n\r\n  // Standard-Issue Hollywood Magic Makers\r\n  lights = {};  // Any scene needs light to be... seen.\r\n  cameras; // Multiple cameras are able to be defined, thus called upon by the ScreenDirector.\r\n  actions = {}; // Scene-wide actions are defined here... ie. \"Camera Shake\", \"Perspective Morph\", \"Scene Cut Transitions\".\r\n\r\n  stage = {}; // This is the placeholder for the stage if created... though a stage is never required.\r\n  backgroundScenery = {};  // This is the placeholder for the background if created... though it is also not required.\r\n  sceneBackground = {}  // Use this to create a Three.CubeCamera as a skybox... be sure to update the skybox camera during the render phase.\r\n\r\n  // Rendering & Update Logic\r\n  update = ( delta )=>{\r\n    this.updatables.forEach(( updatable, name )=>{\r\n      if ( updatable.update ) updatable.update( delta );\r\n    });\r\n  }\r\n\r\n  direct = ( delta )=>{\r\n    this.actives.forEach( ( active, name )=>{\r\n      if( !active.directions ) debugger;\r\n      active.directions.forEach( ( direction, name )=>{\r\n        direction( delta );\r\n      } );\r\n    } );\r\n  }\r\n\r\n  render = ()=>{\r\n    this.renderer.render( this.scene, this.active_cam );\r\n  }\r\n\r\n  ui_render = ()=>{\r\n    this.ui_renderer.render( this.ui_scene, this.active_cam );\r\n  }\r\n\r\n  // Handle Viewscreen Changes\r\n  resize = ()=> {\r\n    let aspect = window.innerWidth / window.innerHeight;\r\n    let active_cam = this.active_cam;\r\n    active_cam.aspect = aspect;\r\n    active_cam.updateProjectionMatrix();\r\n    this.renderer.setSize( window.innerWidth, window.innerHeight );\r\n    this.ui_renderer.setSize( window.innerWidth, window.innderHeight );\r\n  }\r\n\r\n  constructor( ){\r\n\r\n    // Internal Clock\r\n    // TODO: Set this to a configuration value\r\n    const clock = new THREE.Clock();\r\n    this.clock = clock;\r\n    let delta = 0;\r\n    this.delta = delta;\r\n    let fps = 30;\r\n    let interval = 1 / fps;\r\n    this.interval = interval;\r\n\r\n    // Mouse Interaction Capture\r\n    const raycaster = new THREE.Raycaster();\r\n    this.raycaster = raycaster;\r\n    const mouse = new THREE.Vector2();\r\n    this.mouse = mouse;\r\n\r\n    this.updatables = new Map();\r\n    this.cameras = new Map();\r\n    this.active_cam = false;\r\n    this.scene = new THREE.Scene();\r\n    this.ui_scene = new THREE.Scene();\r\n    this.scene.updates = {\r\n      update: ()=>{},\r\n      cache: {}\r\n    };\r\n    this.updatables.set('scene', this.scene.updates );\r\n\r\n    // Scene Renderer\r\n    const renderer = new THREE.WebGLRenderer( { antialias: true, logarithmicDepthBuffer: true, physicallyCorrectLights: true } );\r\n    renderer.shadowMap.enabled = true;\r\n    renderer.shadowMap.type = THREE.PCFSoftShadowMap;\r\n    renderer.setSize( window.innerWidth, window.innerHeight );\r\n    renderer.setPixelRatio( window.devicePixelRatio ? window.devicePixelRatio : 1 );\r\n    let canvas = renderer.domElement;\r\n    document.body.appendChild( canvas );\r\n    this.renderer = renderer;\r\n\r\n    // UI Renderer\r\n    const ui_renderer = new CSS3DRenderer( );\r\n    ui_renderer.setSize( window.innerWidth, window.innerHeight );\r\n    let ui_canvas = ui_renderer.domElement;\r\n    ui_canvas.style['background-color'] = 'transparent';\r\n    ui_canvas.style.position = 'fixed';\r\n    document.body.appendChild( ui_canvas );\r\n    this.ui_renderer = ui_renderer;\r\n  }\r\n}\r\n\r\n// SceneAsset3D //\r\n/* ------------\r\n  In order to optimize the Animate() phase of the ScreenPlay, SceneAsset3D objects own the directions they will be performing... to be called on-demand by the ScreenDirector.\r\n  Analogous to an actor in real-life learning their part of the production... their Director then simply calls upon them to perform it when the time comes.\r\n*/\r\nclass SceneAsset3D extends THREE.Object3D{\r\n  directions;  // Override this with a custom set of functions to be called by the ScreenDirector during the Animate() run of the Screenplay.\r\n  click = ()=>{};\r\n\r\n  constructor( obj3D = new THREE.Object3D() ){\r\n    obj3D.directions = new Map();\r\n    obj3D.click = ()=>{};\r\n    return obj3D;\r\n  }\r\n}\r\n\r\n// SceneDirections //\r\n/* ---------------\r\n  Directions are declared as child functions of this object upon instantiation... and are defined entirely by the user.\r\n  // NOTE: Without any standardized functionality to declare, and no run-time construction requirements, a commented-out example is necessary to understand the expected syntax.\r\n*/\r\nclass SceneDirections{\r\n  //  Example Declaration Template //\r\n  /*  ----------------------------\r\n\r\n      enter_splash = async (screenplay)=>{\r\n        --> Reveal Splash Display... make it look nice.\r\n      };\r\n      progress_splash = async (scene)=>{\r\n        --> Show that progress has been made... simple feedback is all.\r\n      };\r\n      idle_on_splash = async (scene)=>{\r\n        --> Do this while waiting for the user to confirm and continue on... should prompt for interaction\r\n      };\r\n      end_splash = async (scene)=>{\r\n        --> Prepare the scene to begin the next step... make the splash disappear.\r\n      };\r\n      ready_for_anything = async (scene)=>{\r\n        --> Lights up, scenery set... ready to do something!  Happy Directing, and 'break a leg'!\r\n      };\r\n\r\n  */\r\n}\r\n\r\n// Workflow //\r\n/* --------\r\n  This is where the application logic is located, to be called by the ScreenDirector as defined by the Manifesto.\r\n  // NOTE: Without any standardized functionality to declare, and no run-time construction requirements, a commented-out example is necessary to understand the expected syntax.\r\n*/\r\nclass Workflow{\r\n\r\n  constructor(){\r\n  }\r\n}\r\n\r\n// Dictum //\r\n/* ------\r\n  The formal representation for a set of directions to coordinate alongside the logic algorithms of the WorkFlow.\r\n  Tracking the success or failure of the Dictum is included within on construction... defining what to do upon each outcome.\r\n*/\r\nclass Dictum{\r\n\r\n  // logic: Passed on by the Manifesto from it's own construction\r\n  // directions: JSON with functions to run for:\r\n  //    on_enter, on_idle, on_progress, on_failure, on_end.\r\n  constructor( logic, directions, okay_to_fail, prompt_on_fail ){\r\n    this.logic = logic;\r\n    this.directions = directions;\r\n\r\n    this.result = {\r\n      fok: okay_to_fail,\r\n      retry: prompt_on_fail\r\n    }\r\n  }\r\n}\r\n\r\n// Manifesto //\r\n/* ---------\r\n  Literally a public declaration of intentions, this object is knit together by you ( the developer ), using the instantiated SceneDirections & Workflow objects.\r\n*/\r\nclass Manifesto{\r\n  // NOTE: Though this constructor is not implemented, it is relevent to keep this for an explicit understanding of what is expected by the developer employing this solution.\r\n  constructor(scene_directions, workflow){}\r\n}\r\n\r\n\r\nexport { ScreenDirector, Screenplay, SceneAsset3D, SceneDirections, Workflow, Dictum, Manifesto  };\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}