{"ast":null,"code":"import _slicedToArray from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _createForOfIteratorHelper from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _assertThisInitialized from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _get from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/get.js\";import _getPrototypeOf from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/getPrototypeOf.js\";import _classCallCheck from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"C:/Users/SJayc/AppData/Roaming/npm/node_modules/react-scripts/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import{AnimationClip,Bone,Box3,BufferAttribute,BufferGeometry,ClampToEdgeWrapping,Color,DirectionalLight,DoubleSide,FileLoader,FrontSide,Group,ImageBitmapLoader,InterleavedBuffer,InterleavedBufferAttribute,Interpolant,InterpolateDiscrete,InterpolateLinear,Line,LineBasicMaterial,LineLoop,LineSegments,LinearFilter,LinearMipmapLinearFilter,LinearMipmapNearestFilter,Loader,LoaderUtils,Material,MathUtils,Matrix4,Mesh,MeshBasicMaterial,MeshPhysicalMaterial,MeshStandardMaterial,MirroredRepeatWrapping,NearestFilter,NearestMipmapLinearFilter,NearestMipmapNearestFilter,NumberKeyframeTrack,Object3D,OrthographicCamera,PerspectiveCamera,PointLight,Points,PointsMaterial,PropertyBinding,Quaternion,QuaternionKeyframeTrack,RepeatWrapping,Skeleton,SkinnedMesh,Sphere,SpotLight,TangentSpaceNormalMap,Texture,TextureLoader,TriangleFanDrawMode,TriangleStripDrawMode,Vector2,Vector3,VectorKeyframeTrack,sRGBEncoding}from'three';var GLTFLoader=/*#__PURE__*/function(_Loader){_inherits(GLTFLoader,_Loader);var _super=_createSuper(GLTFLoader);function GLTFLoader(manager){var _this;_classCallCheck(this,GLTFLoader);_this=_super.call(this,manager);_this.dracoLoader=null;_this.ktx2Loader=null;_this.meshoptDecoder=null;_this.pluginCallbacks=[];_this.register(function(parser){return new GLTFMaterialsClearcoatExtension(parser);});_this.register(function(parser){return new GLTFTextureBasisUExtension(parser);});_this.register(function(parser){return new GLTFTextureWebPExtension(parser);});_this.register(function(parser){return new GLTFMaterialsSheenExtension(parser);});_this.register(function(parser){return new GLTFMaterialsTransmissionExtension(parser);});_this.register(function(parser){return new GLTFMaterialsVolumeExtension(parser);});_this.register(function(parser){return new GLTFMaterialsIorExtension(parser);});_this.register(function(parser){return new GLTFMaterialsSpecularExtension(parser);});_this.register(function(parser){return new GLTFLightsExtension(parser);});_this.register(function(parser){return new GLTFMeshoptCompression(parser);});return _this;}_createClass(GLTFLoader,[{key:\"load\",value:function load(url,onLoad,onProgress,onError){var scope=this;var resourcePath;if(this.resourcePath!==''){resourcePath=this.resourcePath;}else if(this.path!==''){resourcePath=this.path;}else{resourcePath=LoaderUtils.extractUrlBase(url);}// Tells the LoadingManager to track an extra item, which resolves after\n// the model is fully loaded. This means the count of items loaded will\n// be incorrect, but ensures manager.onLoad() does not fire early.\nthis.manager.itemStart(url);var _onError=function _onError(e){if(onError){onError(e);}else{console.error(e);}scope.manager.itemError(url);scope.manager.itemEnd(url);};var loader=new FileLoader(this.manager);loader.setPath(this.path);loader.setResponseType('arraybuffer');loader.setRequestHeader(this.requestHeader);loader.setWithCredentials(this.withCredentials);loader.load(url,function(data){try{scope.parse(data,resourcePath,function(gltf){onLoad(gltf);scope.manager.itemEnd(url);},_onError);}catch(e){_onError(e);}},onProgress,_onError);}},{key:\"setDRACOLoader\",value:function setDRACOLoader(dracoLoader){this.dracoLoader=dracoLoader;return this;}},{key:\"setDDSLoader\",value:function setDDSLoader(){throw new Error('THREE.GLTFLoader: \"MSFT_texture_dds\" no longer supported. Please update to \"KHR_texture_basisu\".');}},{key:\"setKTX2Loader\",value:function setKTX2Loader(ktx2Loader){this.ktx2Loader=ktx2Loader;return this;}},{key:\"setMeshoptDecoder\",value:function setMeshoptDecoder(meshoptDecoder){this.meshoptDecoder=meshoptDecoder;return this;}},{key:\"register\",value:function register(callback){if(this.pluginCallbacks.indexOf(callback)===-1){this.pluginCallbacks.push(callback);}return this;}},{key:\"unregister\",value:function unregister(callback){if(this.pluginCallbacks.indexOf(callback)!==-1){this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(callback),1);}return this;}},{key:\"parse\",value:function parse(data,path,onLoad,onError){var content;var extensions={};var plugins={};if(typeof data==='string'){content=data;}else{var magic=LoaderUtils.decodeText(new Uint8Array(data,0,4));if(magic===BINARY_EXTENSION_HEADER_MAGIC){try{extensions[EXTENSIONS.KHR_BINARY_GLTF]=new GLTFBinaryExtension(data);}catch(error){if(onError)onError(error);return;}content=extensions[EXTENSIONS.KHR_BINARY_GLTF].content;}else{content=LoaderUtils.decodeText(new Uint8Array(data));}}var json=JSON.parse(content);if(json.asset===undefined||json.asset.version[0]<2){if(onError)onError(new Error('THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.'));return;}var parser=new GLTFParser(json,{path:path||this.resourcePath||'',crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});parser.fileLoader.setRequestHeader(this.requestHeader);for(var i=0;i<this.pluginCallbacks.length;i++){var plugin=this.pluginCallbacks[i](parser);plugins[plugin.name]=plugin;// Workaround to avoid determining as unknown extension\n// in addUnknownExtensionsToUserData().\n// Remove this workaround if we move all the existing\n// extension handlers to plugin system\nextensions[plugin.name]=true;}if(json.extensionsUsed){for(var _i=0;_i<json.extensionsUsed.length;++_i){var extensionName=json.extensionsUsed[_i];var extensionsRequired=json.extensionsRequired||[];switch(extensionName){case EXTENSIONS.KHR_MATERIALS_UNLIT:extensions[extensionName]=new GLTFMaterialsUnlitExtension();break;case EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:extensions[extensionName]=new GLTFMaterialsPbrSpecularGlossinessExtension();break;case EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:extensions[extensionName]=new GLTFDracoMeshCompressionExtension(json,this.dracoLoader);break;case EXTENSIONS.KHR_TEXTURE_TRANSFORM:extensions[extensionName]=new GLTFTextureTransformExtension();break;case EXTENSIONS.KHR_MESH_QUANTIZATION:extensions[extensionName]=new GLTFMeshQuantizationExtension();break;default:if(extensionsRequired.indexOf(extensionName)>=0&&plugins[extensionName]===undefined){console.warn('THREE.GLTFLoader: Unknown extension \"'+extensionName+'\".');}}}}parser.setExtensions(extensions);parser.setPlugins(plugins);parser.parse(onLoad,onError);}},{key:\"parseAsync\",value:function parseAsync(data,path){var scope=this;return new Promise(function(resolve,reject){scope.parse(data,path,resolve,reject);});}}]);return GLTFLoader;}(Loader);/* GLTFREGISTRY */function GLTFRegistry(){var objects={};return{get:function get(key){return objects[key];},add:function add(key,object){objects[key]=object;},remove:function remove(key){delete objects[key];},removeAll:function removeAll(){objects={};}};}/*********************************/ /********** EXTENSIONS ***********/ /*********************************/var EXTENSIONS={KHR_BINARY_GLTF:'KHR_binary_glTF',KHR_DRACO_MESH_COMPRESSION:'KHR_draco_mesh_compression',KHR_LIGHTS_PUNCTUAL:'KHR_lights_punctual',KHR_MATERIALS_CLEARCOAT:'KHR_materials_clearcoat',KHR_MATERIALS_IOR:'KHR_materials_ior',KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:'KHR_materials_pbrSpecularGlossiness',KHR_MATERIALS_SHEEN:'KHR_materials_sheen',KHR_MATERIALS_SPECULAR:'KHR_materials_specular',KHR_MATERIALS_TRANSMISSION:'KHR_materials_transmission',KHR_MATERIALS_UNLIT:'KHR_materials_unlit',KHR_MATERIALS_VOLUME:'KHR_materials_volume',KHR_TEXTURE_BASISU:'KHR_texture_basisu',KHR_TEXTURE_TRANSFORM:'KHR_texture_transform',KHR_MESH_QUANTIZATION:'KHR_mesh_quantization',EXT_TEXTURE_WEBP:'EXT_texture_webp',EXT_MESHOPT_COMPRESSION:'EXT_meshopt_compression'};/**\n * Punctual Lights Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n */var GLTFLightsExtension=/*#__PURE__*/function(){function GLTFLightsExtension(parser){_classCallCheck(this,GLTFLightsExtension);this.parser=parser;this.name=EXTENSIONS.KHR_LIGHTS_PUNCTUAL;// Object3D instance caches\nthis.cache={refs:{},uses:{}};}_createClass(GLTFLightsExtension,[{key:\"_markDefs\",value:function _markDefs(){var parser=this.parser;var nodeDefs=this.parser.json.nodes||[];for(var nodeIndex=0,nodeLength=nodeDefs.length;nodeIndex<nodeLength;nodeIndex++){var nodeDef=nodeDefs[nodeIndex];if(nodeDef.extensions&&nodeDef.extensions[this.name]&&nodeDef.extensions[this.name].light!==undefined){parser._addNodeRef(this.cache,nodeDef.extensions[this.name].light);}}}},{key:\"_loadLight\",value:function _loadLight(lightIndex){var parser=this.parser;var cacheKey='light:'+lightIndex;var dependency=parser.cache.get(cacheKey);if(dependency)return dependency;var json=parser.json;var extensions=json.extensions&&json.extensions[this.name]||{};var lightDefs=extensions.lights||[];var lightDef=lightDefs[lightIndex];var lightNode;var color=new Color(0xffffff);if(lightDef.color!==undefined)color.fromArray(lightDef.color);var range=lightDef.range!==undefined?lightDef.range:0;switch(lightDef.type){case'directional':lightNode=new DirectionalLight(color);lightNode.target.position.set(0,0,-1);lightNode.add(lightNode.target);break;case'point':lightNode=new PointLight(color);lightNode.distance=range;break;case'spot':lightNode=new SpotLight(color);lightNode.distance=range;// Handle spotlight properties.\nlightDef.spot=lightDef.spot||{};lightDef.spot.innerConeAngle=lightDef.spot.innerConeAngle!==undefined?lightDef.spot.innerConeAngle:0;lightDef.spot.outerConeAngle=lightDef.spot.outerConeAngle!==undefined?lightDef.spot.outerConeAngle:Math.PI/4.0;lightNode.angle=lightDef.spot.outerConeAngle;lightNode.penumbra=1.0-lightDef.spot.innerConeAngle/lightDef.spot.outerConeAngle;lightNode.target.position.set(0,0,-1);lightNode.add(lightNode.target);break;default:throw new Error('THREE.GLTFLoader: Unexpected light type: '+lightDef.type);}// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n// here, because node-level parsing will only override position if explicitly specified.\nlightNode.position.set(0,0,0);lightNode.decay=2;if(lightDef.intensity!==undefined)lightNode.intensity=lightDef.intensity;lightNode.name=parser.createUniqueName(lightDef.name||'light_'+lightIndex);dependency=Promise.resolve(lightNode);parser.cache.add(cacheKey,dependency);return dependency;}},{key:\"createNodeAttachment\",value:function createNodeAttachment(nodeIndex){var self=this;var parser=this.parser;var json=parser.json;var nodeDef=json.nodes[nodeIndex];var lightDef=nodeDef.extensions&&nodeDef.extensions[this.name]||{};var lightIndex=lightDef.light;if(lightIndex===undefined)return null;return this._loadLight(lightIndex).then(function(light){return parser._getNodeRef(self.cache,lightIndex,light);});}}]);return GLTFLightsExtension;}();/**\n * Unlit Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n */var GLTFMaterialsUnlitExtension=/*#__PURE__*/function(){function GLTFMaterialsUnlitExtension(){_classCallCheck(this,GLTFMaterialsUnlitExtension);this.name=EXTENSIONS.KHR_MATERIALS_UNLIT;}_createClass(GLTFMaterialsUnlitExtension,[{key:\"getMaterialType\",value:function getMaterialType(){return MeshBasicMaterial;}},{key:\"extendParams\",value:function extendParams(materialParams,materialDef,parser){var pending=[];materialParams.color=new Color(1.0,1.0,1.0);materialParams.opacity=1.0;var metallicRoughness=materialDef.pbrMetallicRoughness;if(metallicRoughness){if(Array.isArray(metallicRoughness.baseColorFactor)){var array=metallicRoughness.baseColorFactor;materialParams.color.fromArray(array);materialParams.opacity=array[3];}if(metallicRoughness.baseColorTexture!==undefined){pending.push(parser.assignTexture(materialParams,'map',metallicRoughness.baseColorTexture));}}return Promise.all(pending);}}]);return GLTFMaterialsUnlitExtension;}();/**\n * Clearcoat Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n */var GLTFMaterialsClearcoatExtension=/*#__PURE__*/function(){function GLTFMaterialsClearcoatExtension(parser){_classCallCheck(this,GLTFMaterialsClearcoatExtension);this.parser=parser;this.name=EXTENSIONS.KHR_MATERIALS_CLEARCOAT;}_createClass(GLTFMaterialsClearcoatExtension,[{key:\"getMaterialType\",value:function getMaterialType(materialIndex){var parser=this.parser;var materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name])return null;return MeshPhysicalMaterial;}},{key:\"extendMaterialParams\",value:function extendMaterialParams(materialIndex,materialParams){var parser=this.parser;var materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name]){return Promise.resolve();}var pending=[];var extension=materialDef.extensions[this.name];if(extension.clearcoatFactor!==undefined){materialParams.clearcoat=extension.clearcoatFactor;}if(extension.clearcoatTexture!==undefined){pending.push(parser.assignTexture(materialParams,'clearcoatMap',extension.clearcoatTexture));}if(extension.clearcoatRoughnessFactor!==undefined){materialParams.clearcoatRoughness=extension.clearcoatRoughnessFactor;}if(extension.clearcoatRoughnessTexture!==undefined){pending.push(parser.assignTexture(materialParams,'clearcoatRoughnessMap',extension.clearcoatRoughnessTexture));}if(extension.clearcoatNormalTexture!==undefined){pending.push(parser.assignTexture(materialParams,'clearcoatNormalMap',extension.clearcoatNormalTexture));if(extension.clearcoatNormalTexture.scale!==undefined){var scale=extension.clearcoatNormalTexture.scale;materialParams.clearcoatNormalScale=new Vector2(scale,scale);}}return Promise.all(pending);}}]);return GLTFMaterialsClearcoatExtension;}();/**\n * Sheen Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_sheen\n */var GLTFMaterialsSheenExtension=/*#__PURE__*/function(){function GLTFMaterialsSheenExtension(parser){_classCallCheck(this,GLTFMaterialsSheenExtension);this.parser=parser;this.name=EXTENSIONS.KHR_MATERIALS_SHEEN;}_createClass(GLTFMaterialsSheenExtension,[{key:\"getMaterialType\",value:function getMaterialType(materialIndex){var parser=this.parser;var materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name])return null;return MeshPhysicalMaterial;}},{key:\"extendMaterialParams\",value:function extendMaterialParams(materialIndex,materialParams){var parser=this.parser;var materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name]){return Promise.resolve();}var pending=[];materialParams.sheenColor=new Color(0,0,0);materialParams.sheenRoughness=0;materialParams.sheen=1;var extension=materialDef.extensions[this.name];if(extension.sheenColorFactor!==undefined){materialParams.sheenColor.fromArray(extension.sheenColorFactor);}if(extension.sheenRoughnessFactor!==undefined){materialParams.sheenRoughness=extension.sheenRoughnessFactor;}if(extension.sheenColorTexture!==undefined){pending.push(parser.assignTexture(materialParams,'sheenColorMap',extension.sheenColorTexture));}if(extension.sheenRoughnessTexture!==undefined){pending.push(parser.assignTexture(materialParams,'sheenRoughnessMap',extension.sheenRoughnessTexture));}return Promise.all(pending);}}]);return GLTFMaterialsSheenExtension;}();/**\n * Transmission Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_transmission\n * Draft: https://github.com/KhronosGroup/glTF/pull/1698\n */var GLTFMaterialsTransmissionExtension=/*#__PURE__*/function(){function GLTFMaterialsTransmissionExtension(parser){_classCallCheck(this,GLTFMaterialsTransmissionExtension);this.parser=parser;this.name=EXTENSIONS.KHR_MATERIALS_TRANSMISSION;}_createClass(GLTFMaterialsTransmissionExtension,[{key:\"getMaterialType\",value:function getMaterialType(materialIndex){var parser=this.parser;var materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name])return null;return MeshPhysicalMaterial;}},{key:\"extendMaterialParams\",value:function extendMaterialParams(materialIndex,materialParams){var parser=this.parser;var materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name]){return Promise.resolve();}var pending=[];var extension=materialDef.extensions[this.name];if(extension.transmissionFactor!==undefined){materialParams.transmission=extension.transmissionFactor;}if(extension.transmissionTexture!==undefined){pending.push(parser.assignTexture(materialParams,'transmissionMap',extension.transmissionTexture));}return Promise.all(pending);}}]);return GLTFMaterialsTransmissionExtension;}();/**\n * Materials Volume Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_volume\n */var GLTFMaterialsVolumeExtension=/*#__PURE__*/function(){function GLTFMaterialsVolumeExtension(parser){_classCallCheck(this,GLTFMaterialsVolumeExtension);this.parser=parser;this.name=EXTENSIONS.KHR_MATERIALS_VOLUME;}_createClass(GLTFMaterialsVolumeExtension,[{key:\"getMaterialType\",value:function getMaterialType(materialIndex){var parser=this.parser;var materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name])return null;return MeshPhysicalMaterial;}},{key:\"extendMaterialParams\",value:function extendMaterialParams(materialIndex,materialParams){var parser=this.parser;var materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name]){return Promise.resolve();}var pending=[];var extension=materialDef.extensions[this.name];materialParams.thickness=extension.thicknessFactor!==undefined?extension.thicknessFactor:0;if(extension.thicknessTexture!==undefined){pending.push(parser.assignTexture(materialParams,'thicknessMap',extension.thicknessTexture));}materialParams.attenuationDistance=extension.attenuationDistance||0;var colorArray=extension.attenuationColor||[1,1,1];materialParams.attenuationColor=new Color(colorArray[0],colorArray[1],colorArray[2]);return Promise.all(pending);}}]);return GLTFMaterialsVolumeExtension;}();/**\n * Materials ior Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_ior\n */var GLTFMaterialsIorExtension=/*#__PURE__*/function(){function GLTFMaterialsIorExtension(parser){_classCallCheck(this,GLTFMaterialsIorExtension);this.parser=parser;this.name=EXTENSIONS.KHR_MATERIALS_IOR;}_createClass(GLTFMaterialsIorExtension,[{key:\"getMaterialType\",value:function getMaterialType(materialIndex){var parser=this.parser;var materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name])return null;return MeshPhysicalMaterial;}},{key:\"extendMaterialParams\",value:function extendMaterialParams(materialIndex,materialParams){var parser=this.parser;var materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name]){return Promise.resolve();}var extension=materialDef.extensions[this.name];materialParams.ior=extension.ior!==undefined?extension.ior:1.5;return Promise.resolve();}}]);return GLTFMaterialsIorExtension;}();/**\n * Materials specular Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_specular\n */var GLTFMaterialsSpecularExtension=/*#__PURE__*/function(){function GLTFMaterialsSpecularExtension(parser){_classCallCheck(this,GLTFMaterialsSpecularExtension);this.parser=parser;this.name=EXTENSIONS.KHR_MATERIALS_SPECULAR;}_createClass(GLTFMaterialsSpecularExtension,[{key:\"getMaterialType\",value:function getMaterialType(materialIndex){var parser=this.parser;var materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name])return null;return MeshPhysicalMaterial;}},{key:\"extendMaterialParams\",value:function extendMaterialParams(materialIndex,materialParams){var parser=this.parser;var materialDef=parser.json.materials[materialIndex];if(!materialDef.extensions||!materialDef.extensions[this.name]){return Promise.resolve();}var pending=[];var extension=materialDef.extensions[this.name];materialParams.specularIntensity=extension.specularFactor!==undefined?extension.specularFactor:1.0;if(extension.specularTexture!==undefined){pending.push(parser.assignTexture(materialParams,'specularIntensityMap',extension.specularTexture));}var colorArray=extension.specularColorFactor||[1,1,1];materialParams.specularColor=new Color(colorArray[0],colorArray[1],colorArray[2]);if(extension.specularColorTexture!==undefined){pending.push(parser.assignTexture(materialParams,'specularColorMap',extension.specularColorTexture).then(function(texture){texture.encoding=sRGBEncoding;}));}return Promise.all(pending);}}]);return GLTFMaterialsSpecularExtension;}();/**\n * BasisU Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n */var GLTFTextureBasisUExtension=/*#__PURE__*/function(){function GLTFTextureBasisUExtension(parser){_classCallCheck(this,GLTFTextureBasisUExtension);this.parser=parser;this.name=EXTENSIONS.KHR_TEXTURE_BASISU;}_createClass(GLTFTextureBasisUExtension,[{key:\"loadTexture\",value:function loadTexture(textureIndex){var parser=this.parser;var json=parser.json;var textureDef=json.textures[textureIndex];if(!textureDef.extensions||!textureDef.extensions[this.name]){return null;}var extension=textureDef.extensions[this.name];var source=json.images[extension.source];var loader=parser.options.ktx2Loader;if(!loader){if(json.extensionsRequired&&json.extensionsRequired.indexOf(this.name)>=0){throw new Error('THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures');}else{// Assumes that the extension is optional and that a fallback texture is present\nreturn null;}}return parser.loadTextureImage(textureIndex,source,loader);}}]);return GLTFTextureBasisUExtension;}();/**\n * WebP Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_webp\n */var GLTFTextureWebPExtension=/*#__PURE__*/function(){function GLTFTextureWebPExtension(parser){_classCallCheck(this,GLTFTextureWebPExtension);this.parser=parser;this.name=EXTENSIONS.EXT_TEXTURE_WEBP;this.isSupported=null;}_createClass(GLTFTextureWebPExtension,[{key:\"loadTexture\",value:function loadTexture(textureIndex){var name=this.name;var parser=this.parser;var json=parser.json;var textureDef=json.textures[textureIndex];if(!textureDef.extensions||!textureDef.extensions[name]){return null;}var extension=textureDef.extensions[name];var source=json.images[extension.source];var loader=parser.textureLoader;if(source.uri){var handler=parser.options.manager.getHandler(source.uri);if(handler!==null)loader=handler;}return this.detectSupport().then(function(isSupported){if(isSupported)return parser.loadTextureImage(textureIndex,source,loader);if(json.extensionsRequired&&json.extensionsRequired.indexOf(name)>=0){throw new Error('THREE.GLTFLoader: WebP required by asset but unsupported.');}// Fall back to PNG or JPEG.\nreturn parser.loadTexture(textureIndex);});}},{key:\"detectSupport\",value:function detectSupport(){if(!this.isSupported){this.isSupported=new Promise(function(resolve){var image=new Image();// Lossy test image. Support for lossy images doesn't guarantee support for all\n// WebP images, unfortunately.\nimage.src='data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';image.onload=image.onerror=function(){resolve(image.height===1);};});}return this.isSupported;}}]);return GLTFTextureWebPExtension;}();/**\n * meshopt BufferView Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_meshopt_compression\n */var GLTFMeshoptCompression=/*#__PURE__*/function(){function GLTFMeshoptCompression(parser){_classCallCheck(this,GLTFMeshoptCompression);this.name=EXTENSIONS.EXT_MESHOPT_COMPRESSION;this.parser=parser;}_createClass(GLTFMeshoptCompression,[{key:\"loadBufferView\",value:function loadBufferView(index){var json=this.parser.json;var bufferView=json.bufferViews[index];if(bufferView.extensions&&bufferView.extensions[this.name]){var extensionDef=bufferView.extensions[this.name];var buffer=this.parser.getDependency('buffer',extensionDef.buffer);var decoder=this.parser.options.meshoptDecoder;if(!decoder||!decoder.supported){if(json.extensionsRequired&&json.extensionsRequired.indexOf(this.name)>=0){throw new Error('THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files');}else{// Assumes that the extension is optional and that fallback buffer data is present\nreturn null;}}return Promise.all([buffer,decoder.ready]).then(function(res){var byteOffset=extensionDef.byteOffset||0;var byteLength=extensionDef.byteLength||0;var count=extensionDef.count;var stride=extensionDef.byteStride;var result=new ArrayBuffer(count*stride);var source=new Uint8Array(res[0],byteOffset,byteLength);decoder.decodeGltfBuffer(new Uint8Array(result),count,stride,source,extensionDef.mode,extensionDef.filter);return result;});}else{return null;}}}]);return GLTFMeshoptCompression;}();/* BINARY EXTENSION */var BINARY_EXTENSION_HEADER_MAGIC='glTF';var BINARY_EXTENSION_HEADER_LENGTH=12;var BINARY_EXTENSION_CHUNK_TYPES={JSON:0x4E4F534A,BIN:0x004E4942};var GLTFBinaryExtension=/*#__PURE__*/_createClass(function GLTFBinaryExtension(data){_classCallCheck(this,GLTFBinaryExtension);this.name=EXTENSIONS.KHR_BINARY_GLTF;this.content=null;this.body=null;var headerView=new DataView(data,0,BINARY_EXTENSION_HEADER_LENGTH);this.header={magic:LoaderUtils.decodeText(new Uint8Array(data.slice(0,4))),version:headerView.getUint32(4,true),length:headerView.getUint32(8,true)};if(this.header.magic!==BINARY_EXTENSION_HEADER_MAGIC){throw new Error('THREE.GLTFLoader: Unsupported glTF-Binary header.');}else if(this.header.version<2.0){throw new Error('THREE.GLTFLoader: Legacy binary file detected.');}var chunkContentsLength=this.header.length-BINARY_EXTENSION_HEADER_LENGTH;var chunkView=new DataView(data,BINARY_EXTENSION_HEADER_LENGTH);var chunkIndex=0;while(chunkIndex<chunkContentsLength){var chunkLength=chunkView.getUint32(chunkIndex,true);chunkIndex+=4;var chunkType=chunkView.getUint32(chunkIndex,true);chunkIndex+=4;if(chunkType===BINARY_EXTENSION_CHUNK_TYPES.JSON){var contentArray=new Uint8Array(data,BINARY_EXTENSION_HEADER_LENGTH+chunkIndex,chunkLength);this.content=LoaderUtils.decodeText(contentArray);}else if(chunkType===BINARY_EXTENSION_CHUNK_TYPES.BIN){var byteOffset=BINARY_EXTENSION_HEADER_LENGTH+chunkIndex;this.body=data.slice(byteOffset,byteOffset+chunkLength);}// Clients must ignore chunks with unknown types.\nchunkIndex+=chunkLength;}if(this.content===null){throw new Error('THREE.GLTFLoader: JSON content not found.');}});/**\n * DRACO Mesh Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n */var GLTFDracoMeshCompressionExtension=/*#__PURE__*/function(){function GLTFDracoMeshCompressionExtension(json,dracoLoader){_classCallCheck(this,GLTFDracoMeshCompressionExtension);if(!dracoLoader){throw new Error('THREE.GLTFLoader: No DRACOLoader instance provided.');}this.name=EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;this.json=json;this.dracoLoader=dracoLoader;this.dracoLoader.preload();}_createClass(GLTFDracoMeshCompressionExtension,[{key:\"decodePrimitive\",value:function decodePrimitive(primitive,parser){var json=this.json;var dracoLoader=this.dracoLoader;var bufferViewIndex=primitive.extensions[this.name].bufferView;var gltfAttributeMap=primitive.extensions[this.name].attributes;var threeAttributeMap={};var attributeNormalizedMap={};var attributeTypeMap={};for(var attributeName in gltfAttributeMap){var threeAttributeName=ATTRIBUTES[attributeName]||attributeName.toLowerCase();threeAttributeMap[threeAttributeName]=gltfAttributeMap[attributeName];}for(var _attributeName in primitive.attributes){var _threeAttributeName=ATTRIBUTES[_attributeName]||_attributeName.toLowerCase();if(gltfAttributeMap[_attributeName]!==undefined){var accessorDef=json.accessors[primitive.attributes[_attributeName]];var componentType=WEBGL_COMPONENT_TYPES[accessorDef.componentType];attributeTypeMap[_threeAttributeName]=componentType;attributeNormalizedMap[_threeAttributeName]=accessorDef.normalized===true;}}return parser.getDependency('bufferView',bufferViewIndex).then(function(bufferView){return new Promise(function(resolve){dracoLoader.decodeDracoFile(bufferView,function(geometry){for(var _attributeName2 in geometry.attributes){var attribute=geometry.attributes[_attributeName2];var normalized=attributeNormalizedMap[_attributeName2];if(normalized!==undefined)attribute.normalized=normalized;}resolve(geometry);},threeAttributeMap,attributeTypeMap);});});}}]);return GLTFDracoMeshCompressionExtension;}();/**\n * Texture Transform Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n */var GLTFTextureTransformExtension=/*#__PURE__*/function(){function GLTFTextureTransformExtension(){_classCallCheck(this,GLTFTextureTransformExtension);this.name=EXTENSIONS.KHR_TEXTURE_TRANSFORM;}_createClass(GLTFTextureTransformExtension,[{key:\"extendTexture\",value:function extendTexture(texture,transform){if(transform.texCoord!==undefined){console.warn('THREE.GLTFLoader: Custom UV sets in \"'+this.name+'\" extension not yet supported.');}if(transform.offset===undefined&&transform.rotation===undefined&&transform.scale===undefined){// See https://github.com/mrdoob/three.js/issues/21819.\nreturn texture;}texture=texture.clone();if(transform.offset!==undefined){texture.offset.fromArray(transform.offset);}if(transform.rotation!==undefined){texture.rotation=transform.rotation;}if(transform.scale!==undefined){texture.repeat.fromArray(transform.scale);}texture.needsUpdate=true;return texture;}}]);return GLTFTextureTransformExtension;}();/**\n * Specular-Glossiness Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Archived/KHR_materials_pbrSpecularGlossiness\n */ /**\n * A sub class of StandardMaterial with some of the functionality\n * changed via the `onBeforeCompile` callback\n * @pailhead\n */var GLTFMeshStandardSGMaterial=/*#__PURE__*/function(_MeshStandardMaterial){_inherits(GLTFMeshStandardSGMaterial,_MeshStandardMaterial);var _super2=_createSuper(GLTFMeshStandardSGMaterial);function GLTFMeshStandardSGMaterial(params){var _this2;_classCallCheck(this,GLTFMeshStandardSGMaterial);_this2=_super2.call(this);_this2.isGLTFSpecularGlossinessMaterial=true;//various chunks that need replacing\nvar specularMapParsFragmentChunk=['#ifdef USE_SPECULARMAP','\tuniform sampler2D specularMap;','#endif'].join('\\n');var glossinessMapParsFragmentChunk=['#ifdef USE_GLOSSINESSMAP','\tuniform sampler2D glossinessMap;','#endif'].join('\\n');var specularMapFragmentChunk=['vec3 specularFactor = specular;','#ifdef USE_SPECULARMAP','\tvec4 texelSpecular = texture2D( specularMap, vUv );','\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture','\tspecularFactor *= texelSpecular.rgb;','#endif'].join('\\n');var glossinessMapFragmentChunk=['float glossinessFactor = glossiness;','#ifdef USE_GLOSSINESSMAP','\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );','\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture','\tglossinessFactor *= texelGlossiness.a;','#endif'].join('\\n');var lightPhysicalFragmentChunk=['PhysicalMaterial material;','material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );','vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );','float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );','material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.','material.roughness += geometryRoughness;','material.roughness = min( material.roughness, 1.0 );','material.specularColor = specularFactor;'].join('\\n');var uniforms={specular:{value:new Color().setHex(0xffffff)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};_this2._extraUniforms=uniforms;_this2.onBeforeCompile=function(shader){for(var uniformName in uniforms){shader.uniforms[uniformName]=uniforms[uniformName];}shader.fragmentShader=shader.fragmentShader.replace('uniform float roughness;','uniform vec3 specular;').replace('uniform float metalness;','uniform float glossiness;').replace('#include <roughnessmap_pars_fragment>',specularMapParsFragmentChunk).replace('#include <metalnessmap_pars_fragment>',glossinessMapParsFragmentChunk).replace('#include <roughnessmap_fragment>',specularMapFragmentChunk).replace('#include <metalnessmap_fragment>',glossinessMapFragmentChunk).replace('#include <lights_physical_fragment>',lightPhysicalFragmentChunk);};Object.defineProperties(_assertThisInitialized(_this2),{specular:{get:function get(){return uniforms.specular.value;},set:function set(v){uniforms.specular.value=v;}},specularMap:{get:function get(){return uniforms.specularMap.value;},set:function set(v){uniforms.specularMap.value=v;if(v){this.defines.USE_SPECULARMAP='';// USE_UV is set by the renderer for specular maps\n}else{delete this.defines.USE_SPECULARMAP;}}},glossiness:{get:function get(){return uniforms.glossiness.value;},set:function set(v){uniforms.glossiness.value=v;}},glossinessMap:{get:function get(){return uniforms.glossinessMap.value;},set:function set(v){uniforms.glossinessMap.value=v;if(v){this.defines.USE_GLOSSINESSMAP='';this.defines.USE_UV='';}else{delete this.defines.USE_GLOSSINESSMAP;delete this.defines.USE_UV;}}}});delete _this2.metalness;delete _this2.roughness;delete _this2.metalnessMap;delete _this2.roughnessMap;_this2.setValues(params);return _this2;}_createClass(GLTFMeshStandardSGMaterial,[{key:\"copy\",value:function copy(source){_get(_getPrototypeOf(GLTFMeshStandardSGMaterial.prototype),\"copy\",this).call(this,source);this.specularMap=source.specularMap;this.specular.copy(source.specular);this.glossinessMap=source.glossinessMap;this.glossiness=source.glossiness;delete this.metalness;delete this.roughness;delete this.metalnessMap;delete this.roughnessMap;return this;}}]);return GLTFMeshStandardSGMaterial;}(MeshStandardMaterial);var GLTFMaterialsPbrSpecularGlossinessExtension=/*#__PURE__*/function(){function GLTFMaterialsPbrSpecularGlossinessExtension(){_classCallCheck(this,GLTFMaterialsPbrSpecularGlossinessExtension);this.name=EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS;this.specularGlossinessParams=['color','map','lightMap','lightMapIntensity','aoMap','aoMapIntensity','emissive','emissiveIntensity','emissiveMap','bumpMap','bumpScale','normalMap','normalMapType','displacementMap','displacementScale','displacementBias','specularMap','specular','glossinessMap','glossiness','alphaMap','envMap','envMapIntensity','refractionRatio'];}_createClass(GLTFMaterialsPbrSpecularGlossinessExtension,[{key:\"getMaterialType\",value:function getMaterialType(){return GLTFMeshStandardSGMaterial;}},{key:\"extendParams\",value:function extendParams(materialParams,materialDef,parser){var pbrSpecularGlossiness=materialDef.extensions[this.name];materialParams.color=new Color(1.0,1.0,1.0);materialParams.opacity=1.0;var pending=[];if(Array.isArray(pbrSpecularGlossiness.diffuseFactor)){var array=pbrSpecularGlossiness.diffuseFactor;materialParams.color.fromArray(array);materialParams.opacity=array[3];}if(pbrSpecularGlossiness.diffuseTexture!==undefined){pending.push(parser.assignTexture(materialParams,'map',pbrSpecularGlossiness.diffuseTexture));}materialParams.emissive=new Color(0.0,0.0,0.0);materialParams.glossiness=pbrSpecularGlossiness.glossinessFactor!==undefined?pbrSpecularGlossiness.glossinessFactor:1.0;materialParams.specular=new Color(1.0,1.0,1.0);if(Array.isArray(pbrSpecularGlossiness.specularFactor)){materialParams.specular.fromArray(pbrSpecularGlossiness.specularFactor);}if(pbrSpecularGlossiness.specularGlossinessTexture!==undefined){var specGlossMapDef=pbrSpecularGlossiness.specularGlossinessTexture;pending.push(parser.assignTexture(materialParams,'glossinessMap',specGlossMapDef));pending.push(parser.assignTexture(materialParams,'specularMap',specGlossMapDef));}return Promise.all(pending);}},{key:\"createMaterial\",value:function createMaterial(materialParams){var material=new GLTFMeshStandardSGMaterial(materialParams);material.fog=true;material.color=materialParams.color;material.map=materialParams.map===undefined?null:materialParams.map;material.lightMap=null;material.lightMapIntensity=1.0;material.aoMap=materialParams.aoMap===undefined?null:materialParams.aoMap;material.aoMapIntensity=1.0;material.emissive=materialParams.emissive;material.emissiveIntensity=1.0;material.emissiveMap=materialParams.emissiveMap===undefined?null:materialParams.emissiveMap;material.bumpMap=materialParams.bumpMap===undefined?null:materialParams.bumpMap;material.bumpScale=1;material.normalMap=materialParams.normalMap===undefined?null:materialParams.normalMap;material.normalMapType=TangentSpaceNormalMap;if(materialParams.normalScale)material.normalScale=materialParams.normalScale;material.displacementMap=null;material.displacementScale=1;material.displacementBias=0;material.specularMap=materialParams.specularMap===undefined?null:materialParams.specularMap;material.specular=materialParams.specular;material.glossinessMap=materialParams.glossinessMap===undefined?null:materialParams.glossinessMap;material.glossiness=materialParams.glossiness;material.alphaMap=null;material.envMap=materialParams.envMap===undefined?null:materialParams.envMap;material.envMapIntensity=1.0;material.refractionRatio=0.98;return material;}}]);return GLTFMaterialsPbrSpecularGlossinessExtension;}();/**\n * Mesh Quantization Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n */var GLTFMeshQuantizationExtension=/*#__PURE__*/_createClass(function GLTFMeshQuantizationExtension(){_classCallCheck(this,GLTFMeshQuantizationExtension);this.name=EXTENSIONS.KHR_MESH_QUANTIZATION;});/*********************************/ /********** INTERPOLATION ********/ /*********************************/ // Spline Interpolation\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\nvar GLTFCubicSplineInterpolant=/*#__PURE__*/function(_Interpolant){_inherits(GLTFCubicSplineInterpolant,_Interpolant);var _super3=_createSuper(GLTFCubicSplineInterpolant);function GLTFCubicSplineInterpolant(parameterPositions,sampleValues,sampleSize,resultBuffer){_classCallCheck(this,GLTFCubicSplineInterpolant);return _super3.call(this,parameterPositions,sampleValues,sampleSize,resultBuffer);}_createClass(GLTFCubicSplineInterpolant,[{key:\"copySampleValue_\",value:function copySampleValue_(index){// Copies a sample value to the result buffer. See description of glTF\n// CUBICSPLINE values layout in interpolate_() function below.\nvar result=this.resultBuffer,values=this.sampleValues,valueSize=this.valueSize,offset=index*valueSize*3+valueSize;for(var i=0;i!==valueSize;i++){result[i]=values[offset+i];}return result;}}]);return GLTFCubicSplineInterpolant;}(Interpolant);GLTFCubicSplineInterpolant.prototype.beforeStart_=GLTFCubicSplineInterpolant.prototype.copySampleValue_;GLTFCubicSplineInterpolant.prototype.afterEnd_=GLTFCubicSplineInterpolant.prototype.copySampleValue_;GLTFCubicSplineInterpolant.prototype.interpolate_=function(i1,t0,t,t1){var result=this.resultBuffer;var values=this.sampleValues;var stride=this.valueSize;var stride2=stride*2;var stride3=stride*3;var td=t1-t0;var p=(t-t0)/td;var pp=p*p;var ppp=pp*p;var offset1=i1*stride3;var offset0=offset1-stride3;var s2=-2*ppp+3*pp;var s3=ppp-pp;var s0=1-s2;var s1=s3-pp+p;// Layout of keyframe output values for CUBICSPLINE animations:\n//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\nfor(var i=0;i!==stride;i++){var p0=values[offset0+i+stride];// splineVertex_k\nvar m0=values[offset0+i+stride2]*td;// outTangent_k * (t_k+1 - t_k)\nvar p1=values[offset1+i+stride];// splineVertex_k+1\nvar m1=values[offset1+i]*td;// inTangent_k+1 * (t_k+1 - t_k)\nresult[i]=s0*p0+s1*m0+s2*p1+s3*m1;}return result;};var _q=new Quaternion();var GLTFCubicSplineQuaternionInterpolant=/*#__PURE__*/function(_GLTFCubicSplineInter){_inherits(GLTFCubicSplineQuaternionInterpolant,_GLTFCubicSplineInter);var _super4=_createSuper(GLTFCubicSplineQuaternionInterpolant);function GLTFCubicSplineQuaternionInterpolant(){_classCallCheck(this,GLTFCubicSplineQuaternionInterpolant);return _super4.apply(this,arguments);}_createClass(GLTFCubicSplineQuaternionInterpolant,[{key:\"interpolate_\",value:function interpolate_(i1,t0,t,t1){var result=_get(_getPrototypeOf(GLTFCubicSplineQuaternionInterpolant.prototype),\"interpolate_\",this).call(this,i1,t0,t,t1);_q.fromArray(result).normalize().toArray(result);return result;}}]);return GLTFCubicSplineQuaternionInterpolant;}(GLTFCubicSplineInterpolant);/*********************************/ /********** INTERNALS ************/ /*********************************/ /* CONSTANTS */var WEBGL_CONSTANTS={FLOAT:5126,//FLOAT_MAT2: 35674,\nFLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123};var WEBGL_COMPONENT_TYPES={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};var WEBGL_FILTERS={9728:NearestFilter,9729:LinearFilter,9984:NearestMipmapNearestFilter,9985:LinearMipmapNearestFilter,9986:NearestMipmapLinearFilter,9987:LinearMipmapLinearFilter};var WEBGL_WRAPPINGS={33071:ClampToEdgeWrapping,33648:MirroredRepeatWrapping,10497:RepeatWrapping};var WEBGL_TYPE_SIZES={'SCALAR':1,'VEC2':2,'VEC3':3,'VEC4':4,'MAT2':4,'MAT3':9,'MAT4':16};var ATTRIBUTES={POSITION:'position',NORMAL:'normal',TANGENT:'tangent',TEXCOORD_0:'uv',TEXCOORD_1:'uv2',COLOR_0:'color',WEIGHTS_0:'skinWeight',JOINTS_0:'skinIndex'};var PATH_PROPERTIES={scale:'scale',translation:'position',rotation:'quaternion',weights:'morphTargetInfluences'};var INTERPOLATION={CUBICSPLINE:undefined,// We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n// keyframe track will be initialized with a default interpolation type, then modified.\nLINEAR:InterpolateLinear,STEP:InterpolateDiscrete};var ALPHA_MODES={OPAQUE:'OPAQUE',MASK:'MASK',BLEND:'BLEND'};/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n */function createDefaultMaterial(cache){if(cache['DefaultMaterial']===undefined){cache['DefaultMaterial']=new MeshStandardMaterial({color:0xFFFFFF,emissive:0x000000,metalness:1,roughness:1,transparent:false,depthTest:true,side:FrontSide});}return cache['DefaultMaterial'];}function addUnknownExtensionsToUserData(knownExtensions,object,objectDef){// Add unknown glTF extensions to an object's userData.\nfor(var name in objectDef.extensions){if(knownExtensions[name]===undefined){object.userData.gltfExtensions=object.userData.gltfExtensions||{};object.userData.gltfExtensions[name]=objectDef.extensions[name];}}}/**\n * @param {Object3D|Material|BufferGeometry} object\n * @param {GLTF.definition} gltfDef\n */function assignExtrasToUserData(object,gltfDef){if(gltfDef.extras!==undefined){if(typeof gltfDef.extras==='object'){Object.assign(object.userData,gltfDef.extras);}else{console.warn('THREE.GLTFLoader: Ignoring primitive type .extras, '+gltfDef.extras);}}}/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n *\n * @param {BufferGeometry} geometry\n * @param {Array<GLTF.Target>} targets\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */function addMorphTargets(geometry,targets,parser){var hasMorphPosition=false;var hasMorphNormal=false;for(var i=0,il=targets.length;i<il;i++){var target=targets[i];if(target.POSITION!==undefined)hasMorphPosition=true;if(target.NORMAL!==undefined)hasMorphNormal=true;if(hasMorphPosition&&hasMorphNormal)break;}if(!hasMorphPosition&&!hasMorphNormal)return Promise.resolve(geometry);var pendingPositionAccessors=[];var pendingNormalAccessors=[];for(var _i2=0,_il=targets.length;_i2<_il;_i2++){var _target=targets[_i2];if(hasMorphPosition){var pendingAccessor=_target.POSITION!==undefined?parser.getDependency('accessor',_target.POSITION):geometry.attributes.position;pendingPositionAccessors.push(pendingAccessor);}if(hasMorphNormal){var _pendingAccessor=_target.NORMAL!==undefined?parser.getDependency('accessor',_target.NORMAL):geometry.attributes.normal;pendingNormalAccessors.push(_pendingAccessor);}}return Promise.all([Promise.all(pendingPositionAccessors),Promise.all(pendingNormalAccessors)]).then(function(accessors){var morphPositions=accessors[0];var morphNormals=accessors[1];if(hasMorphPosition)geometry.morphAttributes.position=morphPositions;if(hasMorphNormal)geometry.morphAttributes.normal=morphNormals;geometry.morphTargetsRelative=true;return geometry;});}/**\n * @param {Mesh} mesh\n * @param {GLTF.Mesh} meshDef\n */function updateMorphTargets(mesh,meshDef){mesh.updateMorphTargets();if(meshDef.weights!==undefined){for(var i=0,il=meshDef.weights.length;i<il;i++){mesh.morphTargetInfluences[i]=meshDef.weights[i];}}// .extras has user-defined data, so check that .extras.targetNames is an array.\nif(meshDef.extras&&Array.isArray(meshDef.extras.targetNames)){var targetNames=meshDef.extras.targetNames;if(mesh.morphTargetInfluences.length===targetNames.length){mesh.morphTargetDictionary={};for(var _i3=0,_il2=targetNames.length;_i3<_il2;_i3++){mesh.morphTargetDictionary[targetNames[_i3]]=_i3;}}else{console.warn('THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.');}}}function createPrimitiveKey(primitiveDef){var dracoExtension=primitiveDef.extensions&&primitiveDef.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION];var geometryKey;if(dracoExtension){geometryKey='draco:'+dracoExtension.bufferView+':'+dracoExtension.indices+':'+createAttributesKey(dracoExtension.attributes);}else{geometryKey=primitiveDef.indices+':'+createAttributesKey(primitiveDef.attributes)+':'+primitiveDef.mode;}return geometryKey;}function createAttributesKey(attributes){var attributesKey='';var keys=Object.keys(attributes).sort();for(var i=0,il=keys.length;i<il;i++){attributesKey+=keys[i]+':'+attributes[keys[i]]+';';}return attributesKey;}function getNormalizedComponentScale(constructor){// Reference:\n// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization#encoding-quantized-data\nswitch(constructor){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error('THREE.GLTFLoader: Unsupported normalized accessor component type.');}}/* GLTF PARSER */var GLTFParser=/*#__PURE__*/function(){function GLTFParser(){var json=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var options=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};_classCallCheck(this,GLTFParser);this.json=json;this.extensions={};this.plugins={};this.options=options;// loader object cache\nthis.cache=new GLTFRegistry();// associations between Three.js objects and glTF elements\nthis.associations=new Map();// BufferGeometry caching\nthis.primitiveCache={};// Object3D instance caches\nthis.meshCache={refs:{},uses:{}};this.cameraCache={refs:{},uses:{}};this.lightCache={refs:{},uses:{}};this.textureCache={};// Track node names, to ensure no duplicates\nthis.nodeNamesUsed={};// Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n// expensive work of uploading a texture to the GPU off the main thread.\nif(typeof createImageBitmap!=='undefined'&&/Firefox|^((?!chrome|android).)*safari/i.test(navigator.userAgent)===false){this.textureLoader=new ImageBitmapLoader(this.options.manager);}else{this.textureLoader=new TextureLoader(this.options.manager);}this.textureLoader.setCrossOrigin(this.options.crossOrigin);this.textureLoader.setRequestHeader(this.options.requestHeader);this.fileLoader=new FileLoader(this.options.manager);this.fileLoader.setResponseType('arraybuffer');if(this.options.crossOrigin==='use-credentials'){this.fileLoader.setWithCredentials(true);}}_createClass(GLTFParser,[{key:\"setExtensions\",value:function setExtensions(extensions){this.extensions=extensions;}},{key:\"setPlugins\",value:function setPlugins(plugins){this.plugins=plugins;}},{key:\"parse\",value:function parse(onLoad,onError){var parser=this;var json=this.json;var extensions=this.extensions;// Clear the loader cache\nthis.cache.removeAll();// Mark the special nodes/meshes in json for efficient parse\nthis._invokeAll(function(ext){return ext._markDefs&&ext._markDefs();});Promise.all(this._invokeAll(function(ext){return ext.beforeRoot&&ext.beforeRoot();})).then(function(){return Promise.all([parser.getDependencies('scene'),parser.getDependencies('animation'),parser.getDependencies('camera')]);}).then(function(dependencies){var result={scene:dependencies[0][json.scene||0],scenes:dependencies[0],animations:dependencies[1],cameras:dependencies[2],asset:json.asset,parser:parser,userData:{}};addUnknownExtensionsToUserData(extensions,result,json);assignExtrasToUserData(result,json);Promise.all(parser._invokeAll(function(ext){return ext.afterRoot&&ext.afterRoot(result);})).then(function(){onLoad(result);});}).catch(onError);}/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */},{key:\"_markDefs\",value:function _markDefs(){var nodeDefs=this.json.nodes||[];var skinDefs=this.json.skins||[];var meshDefs=this.json.meshes||[];// Nothing in the node definition indicates whether it is a Bone or an\n// Object3D. Use the skins' joint references to mark bones.\nfor(var skinIndex=0,skinLength=skinDefs.length;skinIndex<skinLength;skinIndex++){var joints=skinDefs[skinIndex].joints;for(var i=0,il=joints.length;i<il;i++){nodeDefs[joints[i]].isBone=true;}}// Iterate over all nodes, marking references to shared resources,\n// as well as skeleton joints.\nfor(var nodeIndex=0,nodeLength=nodeDefs.length;nodeIndex<nodeLength;nodeIndex++){var nodeDef=nodeDefs[nodeIndex];if(nodeDef.mesh!==undefined){this._addNodeRef(this.meshCache,nodeDef.mesh);// Nothing in the mesh definition indicates whether it is\n// a SkinnedMesh or Mesh. Use the node's mesh reference\n// to mark SkinnedMesh if node has skin.\nif(nodeDef.skin!==undefined){meshDefs[nodeDef.mesh].isSkinnedMesh=true;}}if(nodeDef.camera!==undefined){this._addNodeRef(this.cameraCache,nodeDef.camera);}}}/**\n\t * Counts references to shared node / Object3D resources. These resources\n\t * can be reused, or \"instantiated\", at multiple nodes in the scene\n\t * hierarchy. Mesh, Camera, and Light instances are instantiated and must\n\t * be marked. Non-scenegraph resources (like Materials, Geometries, and\n\t * Textures) can be reused directly and are not marked here.\n\t *\n\t * Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t */},{key:\"_addNodeRef\",value:function _addNodeRef(cache,index){if(index===undefined)return;if(cache.refs[index]===undefined){cache.refs[index]=cache.uses[index]=0;}cache.refs[index]++;}/** Returns a reference to a shared resource, cloning it if necessary. */},{key:\"_getNodeRef\",value:function _getNodeRef(cache,index,object){var _this3=this;if(cache.refs[index]<=1)return object;var ref=object.clone();// Propagates mappings to the cloned object, prevents mappings on the\n// original object from being lost.\nvar updateMappings=function updateMappings(original,clone){var mappings=_this3.associations.get(original);if(mappings!=null){_this3.associations.set(clone,mappings);}var _iterator=_createForOfIteratorHelper(original.children.entries()),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var _step$value=_slicedToArray(_step.value,2),i=_step$value[0],child=_step$value[1];updateMappings(child,clone.children[i]);}}catch(err){_iterator.e(err);}finally{_iterator.f();}};updateMappings(object,ref);ref.name+='_instance_'+cache.uses[index]++;return ref;}},{key:\"_invokeOne\",value:function _invokeOne(func){var extensions=Object.values(this.plugins);extensions.push(this);for(var i=0;i<extensions.length;i++){var result=func(extensions[i]);if(result)return result;}return null;}},{key:\"_invokeAll\",value:function _invokeAll(func){var extensions=Object.values(this.plugins);extensions.unshift(this);var pending=[];for(var i=0;i<extensions.length;i++){var result=func(extensions[i]);if(result)pending.push(result);}return pending;}/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n\t */},{key:\"getDependency\",value:function getDependency(type,index){var cacheKey=type+':'+index;var dependency=this.cache.get(cacheKey);if(!dependency){switch(type){case'scene':dependency=this.loadScene(index);break;case'node':dependency=this.loadNode(index);break;case'mesh':dependency=this._invokeOne(function(ext){return ext.loadMesh&&ext.loadMesh(index);});break;case'accessor':dependency=this.loadAccessor(index);break;case'bufferView':dependency=this._invokeOne(function(ext){return ext.loadBufferView&&ext.loadBufferView(index);});break;case'buffer':dependency=this.loadBuffer(index);break;case'material':dependency=this._invokeOne(function(ext){return ext.loadMaterial&&ext.loadMaterial(index);});break;case'texture':dependency=this._invokeOne(function(ext){return ext.loadTexture&&ext.loadTexture(index);});break;case'skin':dependency=this.loadSkin(index);break;case'animation':dependency=this.loadAnimation(index);break;case'camera':dependency=this.loadCamera(index);break;default:throw new Error('Unknown type: '+type);}this.cache.add(cacheKey,dependency);}return dependency;}/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */},{key:\"getDependencies\",value:function getDependencies(type){var dependencies=this.cache.get(type);if(!dependencies){var parser=this;var defs=this.json[type+(type==='mesh'?'es':'s')]||[];dependencies=Promise.all(defs.map(function(def,index){return parser.getDependency(type,index);}));this.cache.add(type,dependencies);}return dependencies;}/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */},{key:\"loadBuffer\",value:function loadBuffer(bufferIndex){var bufferDef=this.json.buffers[bufferIndex];var loader=this.fileLoader;if(bufferDef.type&&bufferDef.type!=='arraybuffer'){throw new Error('THREE.GLTFLoader: '+bufferDef.type+' buffer type is not supported.');}// If present, GLB container is required to be the first buffer.\nif(bufferDef.uri===undefined&&bufferIndex===0){return Promise.resolve(this.extensions[EXTENSIONS.KHR_BINARY_GLTF].body);}var options=this.options;return new Promise(function(resolve,reject){loader.load(LoaderUtils.resolveURL(bufferDef.uri,options.path),resolve,undefined,function(){reject(new Error('THREE.GLTFLoader: Failed to load buffer \"'+bufferDef.uri+'\".'));});});}/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */},{key:\"loadBufferView\",value:function loadBufferView(bufferViewIndex){var bufferViewDef=this.json.bufferViews[bufferViewIndex];return this.getDependency('buffer',bufferViewDef.buffer).then(function(buffer){var byteLength=bufferViewDef.byteLength||0;var byteOffset=bufferViewDef.byteOffset||0;return buffer.slice(byteOffset,byteOffset+byteLength);});}/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n\t */},{key:\"loadAccessor\",value:function loadAccessor(accessorIndex){var parser=this;var json=this.json;var accessorDef=this.json.accessors[accessorIndex];if(accessorDef.bufferView===undefined&&accessorDef.sparse===undefined){// Ignore empty accessors, which may be used to declare runtime\n// information about attributes coming from another source (e.g. Draco\n// compression extension).\nreturn Promise.resolve(null);}var pendingBufferViews=[];if(accessorDef.bufferView!==undefined){pendingBufferViews.push(this.getDependency('bufferView',accessorDef.bufferView));}else{pendingBufferViews.push(null);}if(accessorDef.sparse!==undefined){pendingBufferViews.push(this.getDependency('bufferView',accessorDef.sparse.indices.bufferView));pendingBufferViews.push(this.getDependency('bufferView',accessorDef.sparse.values.bufferView));}return Promise.all(pendingBufferViews).then(function(bufferViews){var bufferView=bufferViews[0];var itemSize=WEBGL_TYPE_SIZES[accessorDef.type];var TypedArray=WEBGL_COMPONENT_TYPES[accessorDef.componentType];// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\nvar elementBytes=TypedArray.BYTES_PER_ELEMENT;var itemBytes=elementBytes*itemSize;var byteOffset=accessorDef.byteOffset||0;var byteStride=accessorDef.bufferView!==undefined?json.bufferViews[accessorDef.bufferView].byteStride:undefined;var normalized=accessorDef.normalized===true;var array,bufferAttribute;// The buffer is not interleaved if the stride is the item size in bytes.\nif(byteStride&&byteStride!==itemBytes){// Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n// This makes sure that IBA.count reflects accessor.count properly\nvar ibSlice=Math.floor(byteOffset/byteStride);var ibCacheKey='InterleavedBuffer:'+accessorDef.bufferView+':'+accessorDef.componentType+':'+ibSlice+':'+accessorDef.count;var ib=parser.cache.get(ibCacheKey);if(!ib){array=new TypedArray(bufferView,ibSlice*byteStride,accessorDef.count*byteStride/elementBytes);// Integer parameters to IB/IBA are in array elements, not bytes.\nib=new InterleavedBuffer(array,byteStride/elementBytes);parser.cache.add(ibCacheKey,ib);}bufferAttribute=new InterleavedBufferAttribute(ib,itemSize,byteOffset%byteStride/elementBytes,normalized);}else{if(bufferView===null){array=new TypedArray(accessorDef.count*itemSize);}else{array=new TypedArray(bufferView,byteOffset,accessorDef.count*itemSize);}bufferAttribute=new BufferAttribute(array,itemSize,normalized);}// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\nif(accessorDef.sparse!==undefined){var itemSizeIndices=WEBGL_TYPE_SIZES.SCALAR;var TypedArrayIndices=WEBGL_COMPONENT_TYPES[accessorDef.sparse.indices.componentType];var byteOffsetIndices=accessorDef.sparse.indices.byteOffset||0;var byteOffsetValues=accessorDef.sparse.values.byteOffset||0;var sparseIndices=new TypedArrayIndices(bufferViews[1],byteOffsetIndices,accessorDef.sparse.count*itemSizeIndices);var sparseValues=new TypedArray(bufferViews[2],byteOffsetValues,accessorDef.sparse.count*itemSize);if(bufferView!==null){// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\nbufferAttribute=new BufferAttribute(bufferAttribute.array.slice(),bufferAttribute.itemSize,bufferAttribute.normalized);}for(var i=0,il=sparseIndices.length;i<il;i++){var index=sparseIndices[i];bufferAttribute.setX(index,sparseValues[i*itemSize]);if(itemSize>=2)bufferAttribute.setY(index,sparseValues[i*itemSize+1]);if(itemSize>=3)bufferAttribute.setZ(index,sparseValues[i*itemSize+2]);if(itemSize>=4)bufferAttribute.setW(index,sparseValues[i*itemSize+3]);if(itemSize>=5)throw new Error('THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.');}}return bufferAttribute;});}/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture>}\n\t */},{key:\"loadTexture\",value:function loadTexture(textureIndex){var json=this.json;var options=this.options;var textureDef=json.textures[textureIndex];var source=json.images[textureDef.source];var loader=this.textureLoader;if(source.uri){var handler=options.manager.getHandler(source.uri);if(handler!==null)loader=handler;}return this.loadTextureImage(textureIndex,source,loader);}},{key:\"loadTextureImage\",value:function loadTextureImage(textureIndex,source,loader){var parser=this;var json=this.json;var options=this.options;var textureDef=json.textures[textureIndex];var cacheKey=(source.uri||source.bufferView)+':'+textureDef.sampler;if(this.textureCache[cacheKey]){// See https://github.com/mrdoob/three.js/issues/21559.\nreturn this.textureCache[cacheKey];}var URL=window.self.URL||window.self.webkitURL;var sourceURI=source.uri||'';var isObjectURL=false;if(source.bufferView!==undefined){// Load binary image data from bufferView, if provided.\nsourceURI=parser.getDependency('bufferView',source.bufferView).then(function(bufferView){isObjectURL=true;var blob=new Blob([bufferView],{type:source.mimeType});sourceURI=URL.createObjectURL(blob);return sourceURI;});}else if(source.uri===undefined){throw new Error('THREE.GLTFLoader: Image '+textureIndex+' is missing URI and bufferView');}var promise=Promise.resolve(sourceURI).then(function(sourceURI){return new Promise(function(resolve,reject){var onLoad=resolve;if(loader.isImageBitmapLoader===true){onLoad=function onLoad(imageBitmap){var texture=new Texture(imageBitmap);texture.needsUpdate=true;resolve(texture);};}loader.load(LoaderUtils.resolveURL(sourceURI,options.path),onLoad,undefined,reject);});}).then(function(texture){// Clean up resources and configure Texture.\nif(isObjectURL===true){URL.revokeObjectURL(sourceURI);}texture.flipY=false;if(textureDef.name)texture.name=textureDef.name;var samplers=json.samplers||{};var sampler=samplers[textureDef.sampler]||{};texture.magFilter=WEBGL_FILTERS[sampler.magFilter]||LinearFilter;texture.minFilter=WEBGL_FILTERS[sampler.minFilter]||LinearMipmapLinearFilter;texture.wrapS=WEBGL_WRAPPINGS[sampler.wrapS]||RepeatWrapping;texture.wrapT=WEBGL_WRAPPINGS[sampler.wrapT]||RepeatWrapping;parser.associations.set(texture,{textures:textureIndex});return texture;}).catch(function(){console.error('THREE.GLTFLoader: Couldn\\'t load texture',sourceURI);return null;});this.textureCache[cacheKey]=promise;return promise;}/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise<Texture>}\n\t */},{key:\"assignTexture\",value:function assignTexture(materialParams,mapName,mapDef){var parser=this;return this.getDependency('texture',mapDef.index).then(function(texture){// Materials sample aoMap from UV set 1 and other maps from UV set 0 - this can't be configured\n// However, we will copy UV set 0 to UV set 1 on demand for aoMap\nif(mapDef.texCoord!==undefined&&mapDef.texCoord!=0&&!(mapName==='aoMap'&&mapDef.texCoord==1)){console.warn('THREE.GLTFLoader: Custom UV set '+mapDef.texCoord+' for texture '+mapName+' not yet supported.');}if(parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]){var transform=mapDef.extensions!==undefined?mapDef.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM]:undefined;if(transform){var gltfReference=parser.associations.get(texture);texture=parser.extensions[EXTENSIONS.KHR_TEXTURE_TRANSFORM].extendTexture(texture,transform);parser.associations.set(texture,gltfReference);}}materialParams[mapName]=texture;return texture;});}/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accommodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {Object3D} mesh Mesh, Line, or Points instance.\n\t */},{key:\"assignFinalMaterial\",value:function assignFinalMaterial(mesh){var geometry=mesh.geometry;var material=mesh.material;var useDerivativeTangents=geometry.attributes.tangent===undefined;var useVertexColors=geometry.attributes.color!==undefined;var useFlatShading=geometry.attributes.normal===undefined;if(mesh.isPoints){var cacheKey='PointsMaterial:'+material.uuid;var pointsMaterial=this.cache.get(cacheKey);if(!pointsMaterial){pointsMaterial=new PointsMaterial();Material.prototype.copy.call(pointsMaterial,material);pointsMaterial.color.copy(material.color);pointsMaterial.map=material.map;pointsMaterial.sizeAttenuation=false;// glTF spec says points should be 1px\nthis.cache.add(cacheKey,pointsMaterial);}material=pointsMaterial;}else if(mesh.isLine){var _cacheKey='LineBasicMaterial:'+material.uuid;var lineMaterial=this.cache.get(_cacheKey);if(!lineMaterial){lineMaterial=new LineBasicMaterial();Material.prototype.copy.call(lineMaterial,material);lineMaterial.color.copy(material.color);this.cache.add(_cacheKey,lineMaterial);}material=lineMaterial;}// Clone the material if it will be modified\nif(useDerivativeTangents||useVertexColors||useFlatShading){var _cacheKey2='ClonedMaterial:'+material.uuid+':';if(material.isGLTFSpecularGlossinessMaterial)_cacheKey2+='specular-glossiness:';if(useDerivativeTangents)_cacheKey2+='derivative-tangents:';if(useVertexColors)_cacheKey2+='vertex-colors:';if(useFlatShading)_cacheKey2+='flat-shading:';var cachedMaterial=this.cache.get(_cacheKey2);if(!cachedMaterial){cachedMaterial=material.clone();if(useVertexColors)cachedMaterial.vertexColors=true;if(useFlatShading)cachedMaterial.flatShading=true;if(useDerivativeTangents){// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\nif(cachedMaterial.normalScale)cachedMaterial.normalScale.y*=-1;if(cachedMaterial.clearcoatNormalScale)cachedMaterial.clearcoatNormalScale.y*=-1;}this.cache.add(_cacheKey2,cachedMaterial);this.associations.set(cachedMaterial,this.associations.get(material));}material=cachedMaterial;}// workarounds for mesh and geometry\nif(material.aoMap&&geometry.attributes.uv2===undefined&&geometry.attributes.uv!==undefined){geometry.setAttribute('uv2',geometry.attributes.uv);}mesh.material=material;}},{key:\"getMaterialType\",value:function/* materialIndex */getMaterialType(){return MeshStandardMaterial;}/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<Material>}\n\t */},{key:\"loadMaterial\",value:function loadMaterial(materialIndex){var parser=this;var json=this.json;var extensions=this.extensions;var materialDef=json.materials[materialIndex];var materialType;var materialParams={};var materialExtensions=materialDef.extensions||{};var pending=[];if(materialExtensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var sgExtension=extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];materialType=sgExtension.getMaterialType();pending.push(sgExtension.extendParams(materialParams,materialDef,parser));}else if(materialExtensions[EXTENSIONS.KHR_MATERIALS_UNLIT]){var kmuExtension=extensions[EXTENSIONS.KHR_MATERIALS_UNLIT];materialType=kmuExtension.getMaterialType();pending.push(kmuExtension.extendParams(materialParams,materialDef,parser));}else{// Specification:\n// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\nvar metallicRoughness=materialDef.pbrMetallicRoughness||{};materialParams.color=new Color(1.0,1.0,1.0);materialParams.opacity=1.0;if(Array.isArray(metallicRoughness.baseColorFactor)){var array=metallicRoughness.baseColorFactor;materialParams.color.fromArray(array);materialParams.opacity=array[3];}if(metallicRoughness.baseColorTexture!==undefined){pending.push(parser.assignTexture(materialParams,'map',metallicRoughness.baseColorTexture));}materialParams.metalness=metallicRoughness.metallicFactor!==undefined?metallicRoughness.metallicFactor:1.0;materialParams.roughness=metallicRoughness.roughnessFactor!==undefined?metallicRoughness.roughnessFactor:1.0;if(metallicRoughness.metallicRoughnessTexture!==undefined){pending.push(parser.assignTexture(materialParams,'metalnessMap',metallicRoughness.metallicRoughnessTexture));pending.push(parser.assignTexture(materialParams,'roughnessMap',metallicRoughness.metallicRoughnessTexture));}materialType=this._invokeOne(function(ext){return ext.getMaterialType&&ext.getMaterialType(materialIndex);});pending.push(Promise.all(this._invokeAll(function(ext){return ext.extendMaterialParams&&ext.extendMaterialParams(materialIndex,materialParams);})));}if(materialDef.doubleSided===true){materialParams.side=DoubleSide;}var alphaMode=materialDef.alphaMode||ALPHA_MODES.OPAQUE;if(alphaMode===ALPHA_MODES.BLEND){materialParams.transparent=true;// See: https://github.com/mrdoob/three.js/issues/17706\nmaterialParams.depthWrite=false;}else{materialParams.transparent=false;if(alphaMode===ALPHA_MODES.MASK){materialParams.alphaTest=materialDef.alphaCutoff!==undefined?materialDef.alphaCutoff:0.5;}}if(materialDef.normalTexture!==undefined&&materialType!==MeshBasicMaterial){pending.push(parser.assignTexture(materialParams,'normalMap',materialDef.normalTexture));materialParams.normalScale=new Vector2(1,1);if(materialDef.normalTexture.scale!==undefined){var scale=materialDef.normalTexture.scale;materialParams.normalScale.set(scale,scale);}}if(materialDef.occlusionTexture!==undefined&&materialType!==MeshBasicMaterial){pending.push(parser.assignTexture(materialParams,'aoMap',materialDef.occlusionTexture));if(materialDef.occlusionTexture.strength!==undefined){materialParams.aoMapIntensity=materialDef.occlusionTexture.strength;}}if(materialDef.emissiveFactor!==undefined&&materialType!==MeshBasicMaterial){materialParams.emissive=new Color().fromArray(materialDef.emissiveFactor);}if(materialDef.emissiveTexture!==undefined&&materialType!==MeshBasicMaterial){pending.push(parser.assignTexture(materialParams,'emissiveMap',materialDef.emissiveTexture));}return Promise.all(pending).then(function(){var material;if(materialType===GLTFMeshStandardSGMaterial){material=extensions[EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(materialParams);}else{material=new materialType(materialParams);}if(materialDef.name)material.name=materialDef.name;// baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\nif(material.map)material.map.encoding=sRGBEncoding;if(material.emissiveMap)material.emissiveMap.encoding=sRGBEncoding;assignExtrasToUserData(material,materialDef);parser.associations.set(material,{materials:materialIndex});if(materialDef.extensions)addUnknownExtensionsToUserData(extensions,material,materialDef);return material;});}/** When Object3D instances are targeted by animation, they need unique names. */},{key:\"createUniqueName\",value:function createUniqueName(originalName){var sanitizedName=PropertyBinding.sanitizeNodeName(originalName||'');var name=sanitizedName;for(var i=1;this.nodeNamesUsed[name];++i){name=sanitizedName+'_'+i;}this.nodeNamesUsed[name]=true;return name;}/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<BufferGeometry>>}\n\t */},{key:\"loadGeometries\",value:function loadGeometries(primitives){var parser=this;var extensions=this.extensions;var cache=this.primitiveCache;function createDracoPrimitive(primitive){return extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(primitive,parser).then(function(geometry){return addPrimitiveAttributes(geometry,primitive,parser);});}var pending=[];for(var i=0,il=primitives.length;i<il;i++){var primitive=primitives[i];var cacheKey=createPrimitiveKey(primitive);// See if we've already created this geometry\nvar cached=cache[cacheKey];if(cached){// Use the cached geometry if it exists\npending.push(cached.promise);}else{var geometryPromise=void 0;if(primitive.extensions&&primitive.extensions[EXTENSIONS.KHR_DRACO_MESH_COMPRESSION]){// Use DRACO geometry if available\ngeometryPromise=createDracoPrimitive(primitive);}else{// Otherwise create a new geometry\ngeometryPromise=addPrimitiveAttributes(new BufferGeometry(),primitive,parser);}// Cache this geometry\ncache[cacheKey]={primitive:primitive,promise:geometryPromise};pending.push(geometryPromise);}}return Promise.all(pending);}/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<Group|Mesh|SkinnedMesh>}\n\t */},{key:\"loadMesh\",value:function loadMesh(meshIndex){var parser=this;var json=this.json;var extensions=this.extensions;var meshDef=json.meshes[meshIndex];var primitives=meshDef.primitives;var pending=[];for(var i=0,il=primitives.length;i<il;i++){var material=primitives[i].material===undefined?createDefaultMaterial(this.cache):this.getDependency('material',primitives[i].material);pending.push(material);}pending.push(parser.loadGeometries(primitives));return Promise.all(pending).then(function(results){var materials=results.slice(0,results.length-1);var geometries=results[results.length-1];var meshes=[];for(var _i4=0,_il3=geometries.length;_i4<_il3;_i4++){var geometry=geometries[_i4];var primitive=primitives[_i4];// 1. create Mesh\nvar mesh=void 0;var _material=materials[_i4];if(primitive.mode===WEBGL_CONSTANTS.TRIANGLES||primitive.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP||primitive.mode===WEBGL_CONSTANTS.TRIANGLE_FAN||primitive.mode===undefined){// .isSkinnedMesh isn't in glTF spec. See ._markDefs()\nmesh=meshDef.isSkinnedMesh===true?new SkinnedMesh(geometry,_material):new Mesh(geometry,_material);if(mesh.isSkinnedMesh===true&&!mesh.geometry.attributes.skinWeight.normalized){// we normalize floating point skin weight array to fix malformed assets (see #15319)\n// it's important to skip this for non-float32 data since normalizeSkinWeights assumes non-normalized inputs\nmesh.normalizeSkinWeights();}if(primitive.mode===WEBGL_CONSTANTS.TRIANGLE_STRIP){mesh.geometry=toTrianglesDrawMode(mesh.geometry,TriangleStripDrawMode);}else if(primitive.mode===WEBGL_CONSTANTS.TRIANGLE_FAN){mesh.geometry=toTrianglesDrawMode(mesh.geometry,TriangleFanDrawMode);}}else if(primitive.mode===WEBGL_CONSTANTS.LINES){mesh=new LineSegments(geometry,_material);}else if(primitive.mode===WEBGL_CONSTANTS.LINE_STRIP){mesh=new Line(geometry,_material);}else if(primitive.mode===WEBGL_CONSTANTS.LINE_LOOP){mesh=new LineLoop(geometry,_material);}else if(primitive.mode===WEBGL_CONSTANTS.POINTS){mesh=new Points(geometry,_material);}else{throw new Error('THREE.GLTFLoader: Primitive mode unsupported: '+primitive.mode);}if(Object.keys(mesh.geometry.morphAttributes).length>0){updateMorphTargets(mesh,meshDef);}mesh.name=parser.createUniqueName(meshDef.name||'mesh_'+meshIndex);assignExtrasToUserData(mesh,meshDef);if(primitive.extensions)addUnknownExtensionsToUserData(extensions,mesh,primitive);parser.assignFinalMaterial(mesh);meshes.push(mesh);}for(var _i5=0,_il4=meshes.length;_i5<_il4;_i5++){parser.associations.set(meshes[_i5],{meshes:meshIndex,primitives:_i5});}if(meshes.length===1){return meshes[0];}var group=new Group();parser.associations.set(group,{meshes:meshIndex});for(var _i6=0,_il5=meshes.length;_i6<_il5;_i6++){group.add(meshes[_i6]);}return group;});}/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */},{key:\"loadCamera\",value:function loadCamera(cameraIndex){var camera;var cameraDef=this.json.cameras[cameraIndex];var params=cameraDef[cameraDef.type];if(!params){console.warn('THREE.GLTFLoader: Missing camera parameters.');return;}if(cameraDef.type==='perspective'){camera=new PerspectiveCamera(MathUtils.radToDeg(params.yfov),params.aspectRatio||1,params.znear||1,params.zfar||2e6);}else if(cameraDef.type==='orthographic'){camera=new OrthographicCamera(-params.xmag,params.xmag,params.ymag,-params.ymag,params.znear,params.zfar);}if(cameraDef.name)camera.name=this.createUniqueName(cameraDef.name);assignExtrasToUserData(camera,cameraDef);return Promise.resolve(camera);}/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Object>}\n\t */},{key:\"loadSkin\",value:function loadSkin(skinIndex){var skinDef=this.json.skins[skinIndex];var skinEntry={joints:skinDef.joints};if(skinDef.inverseBindMatrices===undefined){return Promise.resolve(skinEntry);}return this.getDependency('accessor',skinDef.inverseBindMatrices).then(function(accessor){skinEntry.inverseBindMatrices=accessor;return skinEntry;});}/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<AnimationClip>}\n\t */},{key:\"loadAnimation\",value:function loadAnimation(animationIndex){var json=this.json;var animationDef=json.animations[animationIndex];var pendingNodes=[];var pendingInputAccessors=[];var pendingOutputAccessors=[];var pendingSamplers=[];var pendingTargets=[];for(var i=0,il=animationDef.channels.length;i<il;i++){var channel=animationDef.channels[i];var sampler=animationDef.samplers[channel.sampler];var target=channel.target;var name=target.node!==undefined?target.node:target.id;// NOTE: target.id is deprecated.\nvar input=animationDef.parameters!==undefined?animationDef.parameters[sampler.input]:sampler.input;var output=animationDef.parameters!==undefined?animationDef.parameters[sampler.output]:sampler.output;pendingNodes.push(this.getDependency('node',name));pendingInputAccessors.push(this.getDependency('accessor',input));pendingOutputAccessors.push(this.getDependency('accessor',output));pendingSamplers.push(sampler);pendingTargets.push(target);}return Promise.all([Promise.all(pendingNodes),Promise.all(pendingInputAccessors),Promise.all(pendingOutputAccessors),Promise.all(pendingSamplers),Promise.all(pendingTargets)]).then(function(dependencies){var nodes=dependencies[0];var inputAccessors=dependencies[1];var outputAccessors=dependencies[2];var samplers=dependencies[3];var targets=dependencies[4];var tracks=[];var _loop=function _loop(_i7,_il6){var node=nodes[_i7];var inputAccessor=inputAccessors[_i7];var outputAccessor=outputAccessors[_i7];var sampler=samplers[_i7];var target=targets[_i7];if(node===undefined)return\"continue\";node.updateMatrix();node.matrixAutoUpdate=true;var TypedKeyframeTrack=void 0;switch(PATH_PROPERTIES[target.path]){case PATH_PROPERTIES.weights:TypedKeyframeTrack=NumberKeyframeTrack;break;case PATH_PROPERTIES.rotation:TypedKeyframeTrack=QuaternionKeyframeTrack;break;case PATH_PROPERTIES.position:case PATH_PROPERTIES.scale:default:TypedKeyframeTrack=VectorKeyframeTrack;break;}var targetName=node.name?node.name:node.uuid;var interpolation=sampler.interpolation!==undefined?INTERPOLATION[sampler.interpolation]:InterpolateLinear;var targetNames=[];if(PATH_PROPERTIES[target.path]===PATH_PROPERTIES.weights){node.traverse(function(object){if(object.morphTargetInfluences){targetNames.push(object.name?object.name:object.uuid);}});}else{targetNames.push(targetName);}var outputArray=outputAccessor.array;if(outputAccessor.normalized){var scale=getNormalizedComponentScale(outputArray.constructor);var scaled=new Float32Array(outputArray.length);for(var j=0,jl=outputArray.length;j<jl;j++){scaled[j]=outputArray[j]*scale;}outputArray=scaled;}for(var _j=0,_jl=targetNames.length;_j<_jl;_j++){var track=new TypedKeyframeTrack(targetNames[_j]+'.'+PATH_PROPERTIES[target.path],inputAccessor.array,outputArray,interpolation);// Override interpolation with custom factory method.\nif(sampler.interpolation==='CUBICSPLINE'){track.createInterpolant=function InterpolantFactoryMethodGLTFCubicSpline(result){// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n// must be divided by three to get the interpolant's sampleSize argument.\nvar interpolantType=this instanceof QuaternionKeyframeTrack?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant;return new interpolantType(this.times,this.values,this.getValueSize()/3,result);};// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\ntrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=true;}tracks.push(track);}};for(var _i7=0,_il6=nodes.length;_i7<_il6;_i7++){var _ret=_loop(_i7,_il6);if(_ret===\"continue\")continue;}var name=animationDef.name?animationDef.name:'animation_'+animationIndex;return new AnimationClip(name,undefined,tracks);});}},{key:\"createNodeMesh\",value:function createNodeMesh(nodeIndex){var json=this.json;var parser=this;var nodeDef=json.nodes[nodeIndex];if(nodeDef.mesh===undefined)return null;return parser.getDependency('mesh',nodeDef.mesh).then(function(mesh){var node=parser._getNodeRef(parser.meshCache,nodeDef.mesh,mesh);// if weights are provided on the node, override weights on the mesh.\nif(nodeDef.weights!==undefined){node.traverse(function(o){if(!o.isMesh)return;for(var i=0,il=nodeDef.weights.length;i<il;i++){o.morphTargetInfluences[i]=nodeDef.weights[i];}});}return node;});}/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<Object3D>}\n\t */},{key:\"loadNode\",value:function loadNode(nodeIndex){var json=this.json;var extensions=this.extensions;var parser=this;var nodeDef=json.nodes[nodeIndex];// reserve node's name before its dependencies, so the root has the intended name.\nvar nodeName=nodeDef.name?parser.createUniqueName(nodeDef.name):'';return function(){var pending=[];var meshPromise=parser._invokeOne(function(ext){return ext.createNodeMesh&&ext.createNodeMesh(nodeIndex);});if(meshPromise){pending.push(meshPromise);}if(nodeDef.camera!==undefined){pending.push(parser.getDependency('camera',nodeDef.camera).then(function(camera){return parser._getNodeRef(parser.cameraCache,nodeDef.camera,camera);}));}parser._invokeAll(function(ext){return ext.createNodeAttachment&&ext.createNodeAttachment(nodeIndex);}).forEach(function(promise){pending.push(promise);});return Promise.all(pending);}().then(function(objects){var node;// .isBone isn't in glTF spec. See ._markDefs\nif(nodeDef.isBone===true){node=new Bone();}else if(objects.length>1){node=new Group();}else if(objects.length===1){node=objects[0];}else{node=new Object3D();}if(node!==objects[0]){for(var i=0,il=objects.length;i<il;i++){node.add(objects[i]);}}if(nodeDef.name){node.userData.name=nodeDef.name;node.name=nodeName;}assignExtrasToUserData(node,nodeDef);if(nodeDef.extensions)addUnknownExtensionsToUserData(extensions,node,nodeDef);if(nodeDef.matrix!==undefined){var matrix=new Matrix4();matrix.fromArray(nodeDef.matrix);node.applyMatrix4(matrix);}else{if(nodeDef.translation!==undefined){node.position.fromArray(nodeDef.translation);}if(nodeDef.rotation!==undefined){node.quaternion.fromArray(nodeDef.rotation);}if(nodeDef.scale!==undefined){node.scale.fromArray(nodeDef.scale);}}if(!parser.associations.has(node)){parser.associations.set(node,{});}parser.associations.get(node).nodes=nodeIndex;return node;});}/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<Group>}\n\t */},{key:\"loadScene\",value:function loadScene(sceneIndex){var json=this.json;var extensions=this.extensions;var sceneDef=this.json.scenes[sceneIndex];var parser=this;// Loader returns Group, not Scene.\n// See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\nvar scene=new Group();if(sceneDef.name)scene.name=parser.createUniqueName(sceneDef.name);assignExtrasToUserData(scene,sceneDef);if(sceneDef.extensions)addUnknownExtensionsToUserData(extensions,scene,sceneDef);var nodeIds=sceneDef.nodes||[];var pending=[];for(var i=0,il=nodeIds.length;i<il;i++){pending.push(buildNodeHierarchy(nodeIds[i],scene,json,parser));}return Promise.all(pending).then(function(){// Removes dangling associations, associations that reference a node that\n// didn't make it into the scene.\nvar reduceAssociations=function reduceAssociations(node){var reducedAssociations=new Map();var _iterator2=_createForOfIteratorHelper(parser.associations),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var _step2$value=_slicedToArray(_step2.value,2),key=_step2$value[0],value=_step2$value[1];if(key instanceof Material||key instanceof Texture){reducedAssociations.set(key,value);}}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}node.traverse(function(node){var mappings=parser.associations.get(node);if(mappings!=null){reducedAssociations.set(node,mappings);}});return reducedAssociations;};parser.associations=reduceAssociations(scene);return scene;});}}]);return GLTFParser;}();function buildNodeHierarchy(nodeId,parentObject,json,parser){var nodeDef=json.nodes[nodeId];return parser.getDependency('node',nodeId).then(function(node){if(nodeDef.skin===undefined)return node;// build skeleton here as well\nvar skinEntry;return parser.getDependency('skin',nodeDef.skin).then(function(skin){skinEntry=skin;var pendingJoints=[];for(var i=0,il=skinEntry.joints.length;i<il;i++){pendingJoints.push(parser.getDependency('node',skinEntry.joints[i]));}return Promise.all(pendingJoints);}).then(function(jointNodes){node.traverse(function(mesh){if(!mesh.isMesh)return;var bones=[];var boneInverses=[];for(var j=0,jl=jointNodes.length;j<jl;j++){var jointNode=jointNodes[j];if(jointNode){bones.push(jointNode);var mat=new Matrix4();if(skinEntry.inverseBindMatrices!==undefined){mat.fromArray(skinEntry.inverseBindMatrices.array,j*16);}boneInverses.push(mat);}else{console.warn('THREE.GLTFLoader: Joint \"%s\" could not be found.',skinEntry.joints[j]);}}mesh.bind(new Skeleton(bones,boneInverses),mesh.matrixWorld);});return node;});}).then(function(node){// build node hierachy\nparentObject.add(node);var pending=[];if(nodeDef.children){var children=nodeDef.children;for(var i=0,il=children.length;i<il;i++){var child=children[i];pending.push(buildNodeHierarchy(child,node,json,parser));}}return Promise.all(pending);});}/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n */function computeBounds(geometry,primitiveDef,parser){var attributes=primitiveDef.attributes;var box=new Box3();if(attributes.POSITION!==undefined){var accessor=parser.json.accessors[attributes.POSITION];var min=accessor.min;var max=accessor.max;// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\nif(min!==undefined&&max!==undefined){box.set(new Vector3(min[0],min[1],min[2]),new Vector3(max[0],max[1],max[2]));if(accessor.normalized){var boxScale=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[accessor.componentType]);box.min.multiplyScalar(boxScale);box.max.multiplyScalar(boxScale);}}else{console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');return;}}else{return;}var targets=primitiveDef.targets;if(targets!==undefined){var maxDisplacement=new Vector3();var vector=new Vector3();for(var i=0,il=targets.length;i<il;i++){var target=targets[i];if(target.POSITION!==undefined){var _accessor=parser.json.accessors[target.POSITION];var _min=_accessor.min;var _max=_accessor.max;// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\nif(_min!==undefined&&_max!==undefined){// we need to get max of absolute components because target weight is [-1,1]\nvector.setX(Math.max(Math.abs(_min[0]),Math.abs(_max[0])));vector.setY(Math.max(Math.abs(_min[1]),Math.abs(_max[1])));vector.setZ(Math.max(Math.abs(_min[2]),Math.abs(_max[2])));if(_accessor.normalized){var _boxScale=getNormalizedComponentScale(WEBGL_COMPONENT_TYPES[_accessor.componentType]);vector.multiplyScalar(_boxScale);}// Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n// to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n// are used to implement key-frame animations and as such only two are active at a time - this results in very large\n// boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\nmaxDisplacement.max(vector);}else{console.warn('THREE.GLTFLoader: Missing min/max properties for accessor POSITION.');}}}// As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\nbox.expandByVector(maxDisplacement);}geometry.boundingBox=box;var sphere=new Sphere();box.getCenter(sphere.center);sphere.radius=box.min.distanceTo(box.max)/2;geometry.boundingSphere=sphere;}/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */function addPrimitiveAttributes(geometry,primitiveDef,parser){var attributes=primitiveDef.attributes;var pending=[];function assignAttributeAccessor(accessorIndex,attributeName){return parser.getDependency('accessor',accessorIndex).then(function(accessor){geometry.setAttribute(attributeName,accessor);});}for(var gltfAttributeName in attributes){var threeAttributeName=ATTRIBUTES[gltfAttributeName]||gltfAttributeName.toLowerCase();// Skip attributes already provided by e.g. Draco extension.\nif(threeAttributeName in geometry.attributes)continue;pending.push(assignAttributeAccessor(attributes[gltfAttributeName],threeAttributeName));}if(primitiveDef.indices!==undefined&&!geometry.index){var accessor=parser.getDependency('accessor',primitiveDef.indices).then(function(accessor){geometry.setIndex(accessor);});pending.push(accessor);}assignExtrasToUserData(geometry,primitiveDef);computeBounds(geometry,primitiveDef,parser);return Promise.all(pending).then(function(){return primitiveDef.targets!==undefined?addMorphTargets(geometry,primitiveDef.targets,parser):geometry;});}/**\n * @param {BufferGeometry} geometry\n * @param {Number} drawMode\n * @return {BufferGeometry}\n */function toTrianglesDrawMode(geometry,drawMode){var index=geometry.getIndex();// generate index if not present\nif(index===null){var indices=[];var position=geometry.getAttribute('position');if(position!==undefined){for(var i=0;i<position.count;i++){indices.push(i);}geometry.setIndex(indices);index=geometry.getIndex();}else{console.error('THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.');return geometry;}}//\nvar numberOfTriangles=index.count-2;var newIndices=[];if(drawMode===TriangleFanDrawMode){// gl.TRIANGLE_FAN\nfor(var _i8=1;_i8<=numberOfTriangles;_i8++){newIndices.push(index.getX(0));newIndices.push(index.getX(_i8));newIndices.push(index.getX(_i8+1));}}else{// gl.TRIANGLE_STRIP\nfor(var _i9=0;_i9<numberOfTriangles;_i9++){if(_i9%2===0){newIndices.push(index.getX(_i9));newIndices.push(index.getX(_i9+1));newIndices.push(index.getX(_i9+2));}else{newIndices.push(index.getX(_i9+2));newIndices.push(index.getX(_i9+1));newIndices.push(index.getX(_i9));}}}if(newIndices.length/3!==numberOfTriangles){console.error('THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.');}// build final geometry\nvar newGeometry=geometry.clone();newGeometry.setIndex(newIndices);return newGeometry;}export{GLTFLoader};","map":{"version":3,"names":["AnimationClip","Bone","Box3","BufferAttribute","BufferGeometry","ClampToEdgeWrapping","Color","DirectionalLight","DoubleSide","FileLoader","FrontSide","Group","ImageBitmapLoader","InterleavedBuffer","InterleavedBufferAttribute","Interpolant","InterpolateDiscrete","InterpolateLinear","Line","LineBasicMaterial","LineLoop","LineSegments","LinearFilter","LinearMipmapLinearFilter","LinearMipmapNearestFilter","Loader","LoaderUtils","Material","MathUtils","Matrix4","Mesh","MeshBasicMaterial","MeshPhysicalMaterial","MeshStandardMaterial","MirroredRepeatWrapping","NearestFilter","NearestMipmapLinearFilter","NearestMipmapNearestFilter","NumberKeyframeTrack","Object3D","OrthographicCamera","PerspectiveCamera","PointLight","Points","PointsMaterial","PropertyBinding","Quaternion","QuaternionKeyframeTrack","RepeatWrapping","Skeleton","SkinnedMesh","Sphere","SpotLight","TangentSpaceNormalMap","Texture","TextureLoader","TriangleFanDrawMode","TriangleStripDrawMode","Vector2","Vector3","VectorKeyframeTrack","sRGBEncoding","GLTFLoader","manager","dracoLoader","ktx2Loader","meshoptDecoder","pluginCallbacks","register","parser","GLTFMaterialsClearcoatExtension","GLTFTextureBasisUExtension","GLTFTextureWebPExtension","GLTFMaterialsSheenExtension","GLTFMaterialsTransmissionExtension","GLTFMaterialsVolumeExtension","GLTFMaterialsIorExtension","GLTFMaterialsSpecularExtension","GLTFLightsExtension","GLTFMeshoptCompression","url","onLoad","onProgress","onError","scope","resourcePath","path","extractUrlBase","itemStart","_onError","e","console","error","itemError","itemEnd","loader","setPath","setResponseType","setRequestHeader","requestHeader","setWithCredentials","withCredentials","load","data","parse","gltf","Error","callback","indexOf","push","splice","content","extensions","plugins","magic","decodeText","Uint8Array","BINARY_EXTENSION_HEADER_MAGIC","EXTENSIONS","KHR_BINARY_GLTF","GLTFBinaryExtension","json","JSON","asset","undefined","version","GLTFParser","crossOrigin","fileLoader","i","length","plugin","name","extensionsUsed","extensionName","extensionsRequired","KHR_MATERIALS_UNLIT","GLTFMaterialsUnlitExtension","KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS","GLTFMaterialsPbrSpecularGlossinessExtension","KHR_DRACO_MESH_COMPRESSION","GLTFDracoMeshCompressionExtension","KHR_TEXTURE_TRANSFORM","GLTFTextureTransformExtension","KHR_MESH_QUANTIZATION","GLTFMeshQuantizationExtension","warn","setExtensions","setPlugins","Promise","resolve","reject","GLTFRegistry","objects","get","key","add","object","remove","removeAll","KHR_LIGHTS_PUNCTUAL","KHR_MATERIALS_CLEARCOAT","KHR_MATERIALS_IOR","KHR_MATERIALS_SHEEN","KHR_MATERIALS_SPECULAR","KHR_MATERIALS_TRANSMISSION","KHR_MATERIALS_VOLUME","KHR_TEXTURE_BASISU","EXT_TEXTURE_WEBP","EXT_MESHOPT_COMPRESSION","cache","refs","uses","nodeDefs","nodes","nodeIndex","nodeLength","nodeDef","light","_addNodeRef","lightIndex","cacheKey","dependency","lightDefs","lights","lightDef","lightNode","color","fromArray","range","type","target","position","set","distance","spot","innerConeAngle","outerConeAngle","Math","PI","angle","penumbra","decay","intensity","createUniqueName","self","_loadLight","then","_getNodeRef","materialParams","materialDef","pending","opacity","metallicRoughness","pbrMetallicRoughness","Array","isArray","baseColorFactor","array","baseColorTexture","assignTexture","all","materialIndex","materials","extension","clearcoatFactor","clearcoat","clearcoatTexture","clearcoatRoughnessFactor","clearcoatRoughness","clearcoatRoughnessTexture","clearcoatNormalTexture","scale","clearcoatNormalScale","sheenColor","sheenRoughness","sheen","sheenColorFactor","sheenRoughnessFactor","sheenColorTexture","sheenRoughnessTexture","transmissionFactor","transmission","transmissionTexture","thickness","thicknessFactor","thicknessTexture","attenuationDistance","colorArray","attenuationColor","ior","specularIntensity","specularFactor","specularTexture","specularColorFactor","specularColor","specularColorTexture","texture","encoding","textureIndex","textureDef","textures","source","images","options","loadTextureImage","isSupported","textureLoader","uri","handler","getHandler","detectSupport","loadTexture","image","Image","src","onload","onerror","height","index","bufferView","bufferViews","extensionDef","buffer","getDependency","decoder","supported","ready","res","byteOffset","byteLength","count","stride","byteStride","result","ArrayBuffer","decodeGltfBuffer","mode","filter","BINARY_EXTENSION_HEADER_LENGTH","BINARY_EXTENSION_CHUNK_TYPES","BIN","body","headerView","DataView","header","slice","getUint32","chunkContentsLength","chunkView","chunkIndex","chunkLength","chunkType","contentArray","preload","primitive","bufferViewIndex","gltfAttributeMap","attributes","threeAttributeMap","attributeNormalizedMap","attributeTypeMap","attributeName","threeAttributeName","ATTRIBUTES","toLowerCase","accessorDef","accessors","componentType","WEBGL_COMPONENT_TYPES","normalized","decodeDracoFile","geometry","attribute","transform","texCoord","offset","rotation","clone","repeat","needsUpdate","GLTFMeshStandardSGMaterial","params","isGLTFSpecularGlossinessMaterial","specularMapParsFragmentChunk","join","glossinessMapParsFragmentChunk","specularMapFragmentChunk","glossinessMapFragmentChunk","lightPhysicalFragmentChunk","uniforms","specular","value","setHex","glossiness","specularMap","glossinessMap","_extraUniforms","onBeforeCompile","shader","uniformName","fragmentShader","replace","Object","defineProperties","v","defines","USE_SPECULARMAP","USE_GLOSSINESSMAP","USE_UV","metalness","roughness","metalnessMap","roughnessMap","setValues","copy","specularGlossinessParams","pbrSpecularGlossiness","diffuseFactor","diffuseTexture","emissive","glossinessFactor","specularGlossinessTexture","specGlossMapDef","material","fog","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","normalScale","displacementMap","displacementScale","displacementBias","alphaMap","envMap","envMapIntensity","refractionRatio","GLTFCubicSplineInterpolant","parameterPositions","sampleValues","sampleSize","resultBuffer","values","valueSize","prototype","beforeStart_","copySampleValue_","afterEnd_","interpolate_","i1","t0","t","t1","stride2","stride3","td","p","pp","ppp","offset1","offset0","s2","s3","s0","s1","p0","m0","p1","m1","_q","GLTFCubicSplineQuaternionInterpolant","normalize","toArray","WEBGL_CONSTANTS","FLOAT","FLOAT_MAT3","FLOAT_MAT4","FLOAT_VEC2","FLOAT_VEC3","FLOAT_VEC4","LINEAR","REPEAT","SAMPLER_2D","POINTS","LINES","LINE_LOOP","LINE_STRIP","TRIANGLES","TRIANGLE_STRIP","TRIANGLE_FAN","UNSIGNED_BYTE","UNSIGNED_SHORT","Int8Array","Int16Array","Uint16Array","Uint32Array","Float32Array","WEBGL_FILTERS","WEBGL_WRAPPINGS","WEBGL_TYPE_SIZES","POSITION","NORMAL","TANGENT","TEXCOORD_0","TEXCOORD_1","COLOR_0","WEIGHTS_0","JOINTS_0","PATH_PROPERTIES","translation","weights","INTERPOLATION","CUBICSPLINE","STEP","ALPHA_MODES","OPAQUE","MASK","BLEND","createDefaultMaterial","transparent","depthTest","side","addUnknownExtensionsToUserData","knownExtensions","objectDef","userData","gltfExtensions","assignExtrasToUserData","gltfDef","extras","assign","addMorphTargets","targets","hasMorphPosition","hasMorphNormal","il","pendingPositionAccessors","pendingNormalAccessors","pendingAccessor","normal","morphPositions","morphNormals","morphAttributes","morphTargetsRelative","updateMorphTargets","mesh","meshDef","morphTargetInfluences","targetNames","morphTargetDictionary","createPrimitiveKey","primitiveDef","dracoExtension","geometryKey","indices","createAttributesKey","attributesKey","keys","sort","getNormalizedComponentScale","constructor","associations","Map","primitiveCache","meshCache","cameraCache","lightCache","textureCache","nodeNamesUsed","createImageBitmap","test","navigator","userAgent","setCrossOrigin","_invokeAll","ext","_markDefs","beforeRoot","getDependencies","dependencies","scene","scenes","animations","cameras","afterRoot","catch","skinDefs","skins","meshDefs","meshes","skinIndex","skinLength","joints","isBone","skin","isSkinnedMesh","camera","ref","updateMappings","original","mappings","children","entries","child","func","unshift","loadScene","loadNode","_invokeOne","loadMesh","loadAccessor","loadBufferView","loadBuffer","loadMaterial","loadSkin","loadAnimation","loadCamera","defs","def","bufferIndex","bufferDef","buffers","resolveURL","bufferViewDef","accessorIndex","sparse","pendingBufferViews","itemSize","TypedArray","elementBytes","BYTES_PER_ELEMENT","itemBytes","bufferAttribute","ibSlice","floor","ibCacheKey","ib","itemSizeIndices","SCALAR","TypedArrayIndices","byteOffsetIndices","byteOffsetValues","sparseIndices","sparseValues","setX","setY","setZ","setW","sampler","URL","window","webkitURL","sourceURI","isObjectURL","blob","Blob","mimeType","createObjectURL","promise","isImageBitmapLoader","imageBitmap","revokeObjectURL","flipY","samplers","magFilter","minFilter","wrapS","wrapT","mapName","mapDef","gltfReference","extendTexture","useDerivativeTangents","tangent","useVertexColors","useFlatShading","isPoints","uuid","pointsMaterial","call","sizeAttenuation","isLine","lineMaterial","cachedMaterial","vertexColors","flatShading","y","uv2","uv","setAttribute","materialType","materialExtensions","sgExtension","getMaterialType","extendParams","kmuExtension","metallicFactor","roughnessFactor","metallicRoughnessTexture","extendMaterialParams","doubleSided","alphaMode","depthWrite","alphaTest","alphaCutoff","normalTexture","occlusionTexture","strength","emissiveFactor","emissiveTexture","createMaterial","originalName","sanitizedName","sanitizeNodeName","primitives","createDracoPrimitive","decodePrimitive","addPrimitiveAttributes","cached","geometryPromise","meshIndex","loadGeometries","results","geometries","skinWeight","normalizeSkinWeights","toTrianglesDrawMode","assignFinalMaterial","group","cameraIndex","cameraDef","radToDeg","yfov","aspectRatio","znear","zfar","xmag","ymag","skinDef","skinEntry","inverseBindMatrices","accessor","animationIndex","animationDef","pendingNodes","pendingInputAccessors","pendingOutputAccessors","pendingSamplers","pendingTargets","channels","channel","node","id","input","parameters","output","inputAccessors","outputAccessors","tracks","inputAccessor","outputAccessor","updateMatrix","matrixAutoUpdate","TypedKeyframeTrack","targetName","interpolation","traverse","outputArray","scaled","j","jl","track","createInterpolant","InterpolantFactoryMethodGLTFCubicSpline","interpolantType","times","getValueSize","isInterpolantFactoryMethodGLTFCubicSpline","o","isMesh","nodeName","meshPromise","createNodeMesh","createNodeAttachment","forEach","matrix","applyMatrix4","quaternion","has","sceneIndex","sceneDef","nodeIds","buildNodeHierarchy","reduceAssociations","reducedAssociations","nodeId","parentObject","pendingJoints","jointNodes","bones","boneInverses","jointNode","mat","bind","matrixWorld","computeBounds","box","min","max","boxScale","multiplyScalar","maxDisplacement","vector","abs","expandByVector","boundingBox","sphere","getCenter","center","radius","distanceTo","boundingSphere","assignAttributeAccessor","gltfAttributeName","setIndex","drawMode","getIndex","getAttribute","numberOfTriangles","newIndices","getX","newGeometry"],"sources":["C:/Phox.Solutions/Workshop/GitHub-Repos/WeTheNetwork/scene-director/src/lib/GLTFLoader.js"],"sourcesContent":["import {\n\tAnimationClip,\n\tBone,\n\tBox3,\n\tBufferAttribute,\n\tBufferGeometry,\n\tClampToEdgeWrapping,\n\tColor,\n\tDirectionalLight,\n\tDoubleSide,\n\tFileLoader,\n\tFrontSide,\n\tGroup,\n\tImageBitmapLoader,\n\tInterleavedBuffer,\n\tInterleavedBufferAttribute,\n\tInterpolant,\n\tInterpolateDiscrete,\n\tInterpolateLinear,\n\tLine,\n\tLineBasicMaterial,\n\tLineLoop,\n\tLineSegments,\n\tLinearFilter,\n\tLinearMipmapLinearFilter,\n\tLinearMipmapNearestFilter,\n\tLoader,\n\tLoaderUtils,\n\tMaterial,\n\tMathUtils,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tMeshPhysicalMaterial,\n\tMeshStandardMaterial,\n\tMirroredRepeatWrapping,\n\tNearestFilter,\n\tNearestMipmapLinearFilter,\n\tNearestMipmapNearestFilter,\n\tNumberKeyframeTrack,\n\tObject3D,\n\tOrthographicCamera,\n\tPerspectiveCamera,\n\tPointLight,\n\tPoints,\n\tPointsMaterial,\n\tPropertyBinding,\n\tQuaternion,\n\tQuaternionKeyframeTrack,\n\tRepeatWrapping,\n\tSkeleton,\n\tSkinnedMesh,\n\tSphere,\n\tSpotLight,\n\tTangentSpaceNormalMap,\n\tTexture,\n\tTextureLoader,\n\tTriangleFanDrawMode,\n\tTriangleStripDrawMode,\n\tVector2,\n\tVector3,\n\tVectorKeyframeTrack,\n\tsRGBEncoding\n} from 'three';\n\nclass GLTFLoader extends Loader {\n\n\tconstructor( manager ) {\n\n\t\tsuper( manager );\n\n\t\tthis.dracoLoader = null;\n\t\tthis.ktx2Loader = null;\n\t\tthis.meshoptDecoder = null;\n\n\t\tthis.pluginCallbacks = [];\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsClearcoatExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureBasisUExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFTextureWebPExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSheenExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsTransmissionExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsVolumeExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsIorExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMaterialsSpecularExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFLightsExtension( parser );\n\n\t\t} );\n\n\t\tthis.register( function ( parser ) {\n\n\t\t\treturn new GLTFMeshoptCompression( parser );\n\n\t\t} );\n\n\t}\n\n\tload( url, onLoad, onProgress, onError ) {\n\t\tconst scope = this;\n\n\t\tlet resourcePath;\n\n\t\tif ( this.resourcePath !== '' ) {\n\n\t\t\tresourcePath = this.resourcePath;\n\n\t\t} else if ( this.path !== '' ) {\n\n\t\t\tresourcePath = this.path;\n\n\t\t} else {\n\n\t\t\tresourcePath = LoaderUtils.extractUrlBase( url );\n\n\t\t}\n\n\t\t// Tells the LoadingManager to track an extra item, which resolves after\n\t\t// the model is fully loaded. This means the count of items loaded will\n\t\t// be incorrect, but ensures manager.onLoad() does not fire early.\n\t\tthis.manager.itemStart( url );\n\n\t\tconst _onError = function ( e ) {\n\n\t\t\tif ( onError ) {\n\n\t\t\t\tonError( e );\n\n\t\t\t} else {\n\n\t\t\t\tconsole.error( e );\n\n\t\t\t}\n\n\t\t\tscope.manager.itemError( url );\n\t\t\tscope.manager.itemEnd( url );\n\n\t\t};\n\n\t\tconst loader = new FileLoader( this.manager );\n\n\t\tloader.setPath( this.path );\n\t\tloader.setResponseType( 'arraybuffer' );\n\t\tloader.setRequestHeader( this.requestHeader );\n\t\tloader.setWithCredentials( this.withCredentials );\n\t\tloader.load( url, function ( data ) {\n\n\t\t\ttry {\n\n\t\t\t\tscope.parse( data, resourcePath, function ( gltf ) {\n\n\t\t\t\t\tonLoad( gltf );\n\n\t\t\t\t\tscope.manager.itemEnd( url );\n\n\t\t\t\t}, _onError );\n\n\t\t\t} catch ( e ) {\n\n\t\t\t\t_onError( e );\n\n\t\t\t}\n\n\t\t}, onProgress, _onError );\n\n\t}\n\n\tsetDRACOLoader( dracoLoader ) {\n\n\t\tthis.dracoLoader = dracoLoader;\n\t\treturn this;\n\n\t}\n\n\tsetDDSLoader() {\n\n\t\tthrow new Error(\n\n\t\t\t'THREE.GLTFLoader: \"MSFT_texture_dds\" no longer supported. Please update to \"KHR_texture_basisu\".'\n\n\t\t);\n\n\t}\n\n\tsetKTX2Loader( ktx2Loader ) {\n\n\t\tthis.ktx2Loader = ktx2Loader;\n\t\treturn this;\n\n\t}\n\n\tsetMeshoptDecoder( meshoptDecoder ) {\n\n\t\tthis.meshoptDecoder = meshoptDecoder;\n\t\treturn this;\n\n\t}\n\n\tregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) === - 1 ) {\n\n\t\t\tthis.pluginCallbacks.push( callback );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tunregister( callback ) {\n\n\t\tif ( this.pluginCallbacks.indexOf( callback ) !== - 1 ) {\n\n\t\t\tthis.pluginCallbacks.splice( this.pluginCallbacks.indexOf( callback ), 1 );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\tparse( data, path, onLoad, onError ) {\n\n\t\tlet content;\n\t\tconst extensions = {};\n\t\tconst plugins = {};\n\n\t\tif ( typeof data === 'string' ) {\n\n\t\t\tcontent = data;\n\n\t\t} else {\n\n\t\t\tconst magic = LoaderUtils.decodeText( new Uint8Array( data, 0, 4 ) );\n\n\t\t\tif ( magic === BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\t\ttry {\n\n\t\t\t\t\textensions[ EXTENSIONS.KHR_BINARY_GLTF ] = new GLTFBinaryExtension( data );\n\n\t\t\t\t} catch ( error ) {\n\n\t\t\t\t\tif ( onError ) onError( error );\n\t\t\t\t\treturn;\n\n\t\t\t\t}\n\n\t\t\t\tcontent = extensions[ EXTENSIONS.KHR_BINARY_GLTF ].content;\n\n\t\t\t} else {\n\n\t\t\t\tcontent = LoaderUtils.decodeText( new Uint8Array( data ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\tconst json = JSON.parse( content );\n\n\t\tif ( json.asset === undefined || json.asset.version[ 0 ] < 2 ) {\n\n\t\t\tif ( onError ) onError( new Error( 'THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.' ) );\n\t\t\treturn;\n\n\t\t}\n\n\t\tconst parser = new GLTFParser( json, {\n\n\t\t\tpath: path || this.resourcePath || '',\n\t\t\tcrossOrigin: this.crossOrigin,\n\t\t\trequestHeader: this.requestHeader,\n\t\t\tmanager: this.manager,\n\t\t\tktx2Loader: this.ktx2Loader,\n\t\t\tmeshoptDecoder: this.meshoptDecoder\n\n\t\t} );\n\n\t\tparser.fileLoader.setRequestHeader( this.requestHeader );\n\n\t\tfor ( let i = 0; i < this.pluginCallbacks.length; i ++ ) {\n\n\t\t\tconst plugin = this.pluginCallbacks[ i ]( parser );\n\t\t\tplugins[ plugin.name ] = plugin;\n\n\t\t\t// Workaround to avoid determining as unknown extension\n\t\t\t// in addUnknownExtensionsToUserData().\n\t\t\t// Remove this workaround if we move all the existing\n\t\t\t// extension handlers to plugin system\n\t\t\textensions[ plugin.name ] = true;\n\n\t\t}\n\n\t\tif ( json.extensionsUsed ) {\n\n\t\t\tfor ( let i = 0; i < json.extensionsUsed.length; ++ i ) {\n\n\t\t\t\tconst extensionName = json.extensionsUsed[ i ];\n\t\t\t\tconst extensionsRequired = json.extensionsRequired || [];\n\n\t\t\t\tswitch ( extensionName ) {\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_UNLIT:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsUnlitExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMaterialsPbrSpecularGlossinessExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_DRACO_MESH_COMPRESSION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFDracoMeshCompressionExtension( json, this.dracoLoader );\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_TEXTURE_TRANSFORM:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFTextureTransformExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase EXTENSIONS.KHR_MESH_QUANTIZATION:\n\t\t\t\t\t\textensions[ extensionName ] = new GLTFMeshQuantizationExtension();\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tif ( extensionsRequired.indexOf( extensionName ) >= 0 && plugins[ extensionName ] === undefined ) {\n\n\t\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Unknown extension \"' + extensionName + '\".' );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\tparser.setExtensions( extensions );\n\t\tparser.setPlugins( plugins );\n\t\tparser.parse( onLoad, onError );\n\n\t}\n\n\tparseAsync( data, path ) {\n\n\t\tconst scope = this;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tscope.parse( data, path, resolve, reject );\n\n\t\t} );\n\n\t}\n\n}\n\n/* GLTFREGISTRY */\n\nfunction GLTFRegistry() {\n\n\tlet objects = {};\n\n\treturn\t{\n\n\t\tget: function ( key ) {\n\n\t\t\treturn objects[ key ];\n\n\t\t},\n\n\t\tadd: function ( key, object ) {\n\n\t\t\tobjects[ key ] = object;\n\n\t\t},\n\n\t\tremove: function ( key ) {\n\n\t\t\tdelete objects[ key ];\n\n\t\t},\n\n\t\tremoveAll: function () {\n\n\t\t\tobjects = {};\n\n\t\t}\n\n\t};\n\n}\n\n/*********************************/\n/********** EXTENSIONS ***********/\n/*********************************/\n\nconst EXTENSIONS = {\n\tKHR_BINARY_GLTF: 'KHR_binary_glTF',\n\tKHR_DRACO_MESH_COMPRESSION: 'KHR_draco_mesh_compression',\n\tKHR_LIGHTS_PUNCTUAL: 'KHR_lights_punctual',\n\tKHR_MATERIALS_CLEARCOAT: 'KHR_materials_clearcoat',\n\tKHR_MATERIALS_IOR: 'KHR_materials_ior',\n\tKHR_MATERIALS_PBR_SPECULAR_GLOSSINESS: 'KHR_materials_pbrSpecularGlossiness',\n\tKHR_MATERIALS_SHEEN: 'KHR_materials_sheen',\n\tKHR_MATERIALS_SPECULAR: 'KHR_materials_specular',\n\tKHR_MATERIALS_TRANSMISSION: 'KHR_materials_transmission',\n\tKHR_MATERIALS_UNLIT: 'KHR_materials_unlit',\n\tKHR_MATERIALS_VOLUME: 'KHR_materials_volume',\n\tKHR_TEXTURE_BASISU: 'KHR_texture_basisu',\n\tKHR_TEXTURE_TRANSFORM: 'KHR_texture_transform',\n\tKHR_MESH_QUANTIZATION: 'KHR_mesh_quantization',\n\tEXT_TEXTURE_WEBP: 'EXT_texture_webp',\n\tEXT_MESHOPT_COMPRESSION: 'EXT_meshopt_compression'\n};\n\n/**\n * Punctual Lights Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_lights_punctual\n */\nclass GLTFLightsExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_LIGHTS_PUNCTUAL;\n\n\t\t// Object3D instance caches\n\t\tthis.cache = { refs: {}, uses: {} };\n\n\t}\n\n\t_markDefs() {\n\n\t\tconst parser = this.parser;\n\t\tconst nodeDefs = this.parser.json.nodes || [];\n\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.extensions\n\t\t\t\t\t&& nodeDef.extensions[ this.name ]\n\t\t\t\t\t&& nodeDef.extensions[ this.name ].light !== undefined ) {\n\n\t\t\t\tparser._addNodeRef( this.cache, nodeDef.extensions[ this.name ].light );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t_loadLight( lightIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst cacheKey = 'light:' + lightIndex;\n\t\tlet dependency = parser.cache.get( cacheKey );\n\n\t\tif ( dependency ) return dependency;\n\n\t\tconst json = parser.json;\n\t\tconst extensions = ( json.extensions && json.extensions[ this.name ] ) || {};\n\t\tconst lightDefs = extensions.lights || [];\n\t\tconst lightDef = lightDefs[ lightIndex ];\n\t\tlet lightNode;\n\n\t\tconst color = new Color( 0xffffff );\n\n\t\tif ( lightDef.color !== undefined ) color.fromArray( lightDef.color );\n\n\t\tconst range = lightDef.range !== undefined ? lightDef.range : 0;\n\n\t\tswitch ( lightDef.type ) {\n\n\t\t\tcase 'directional':\n\t\t\t\tlightNode = new DirectionalLight( color );\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tcase 'point':\n\t\t\t\tlightNode = new PointLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\tbreak;\n\n\t\t\tcase 'spot':\n\t\t\t\tlightNode = new SpotLight( color );\n\t\t\t\tlightNode.distance = range;\n\t\t\t\t// Handle spotlight properties.\n\t\t\t\tlightDef.spot = lightDef.spot || {};\n\t\t\t\tlightDef.spot.innerConeAngle = lightDef.spot.innerConeAngle !== undefined ? lightDef.spot.innerConeAngle : 0;\n\t\t\t\tlightDef.spot.outerConeAngle = lightDef.spot.outerConeAngle !== undefined ? lightDef.spot.outerConeAngle : Math.PI / 4.0;\n\t\t\t\tlightNode.angle = lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.penumbra = 1.0 - lightDef.spot.innerConeAngle / lightDef.spot.outerConeAngle;\n\t\t\t\tlightNode.target.position.set( 0, 0, - 1 );\n\t\t\t\tlightNode.add( lightNode.target );\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Unexpected light type: ' + lightDef.type );\n\n\t\t}\n\n\t\t// Some lights (e.g. spot) default to a position other than the origin. Reset the position\n\t\t// here, because node-level parsing will only override position if explicitly specified.\n\t\tlightNode.position.set( 0, 0, 0 );\n\n\t\tlightNode.decay = 2;\n\n\t\tif ( lightDef.intensity !== undefined ) lightNode.intensity = lightDef.intensity;\n\n\t\tlightNode.name = parser.createUniqueName( lightDef.name || ( 'light_' + lightIndex ) );\n\n\t\tdependency = Promise.resolve( lightNode );\n\n\t\tparser.cache.add( cacheKey, dependency );\n\n\t\treturn dependency;\n\n\t}\n\n\tcreateNodeAttachment( nodeIndex ) {\n\n\t\tconst self = this;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\t\tconst lightDef = ( nodeDef.extensions && nodeDef.extensions[ this.name ] ) || {};\n\t\tconst lightIndex = lightDef.light;\n\n\t\tif ( lightIndex === undefined ) return null;\n\n\t\treturn this._loadLight( lightIndex ).then( function ( light ) {\n\n\t\t\treturn parser._getNodeRef( self.cache, lightIndex, light );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Unlit Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_unlit\n */\nclass GLTFMaterialsUnlitExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_UNLIT;\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn MeshBasicMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness;\n\n\t\tif ( metallicRoughness ) {\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Clearcoat Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_clearcoat\n */\nclass GLTFMaterialsClearcoatExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_CLEARCOAT;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.clearcoatFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoat = extension.clearcoatFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatMap', extension.clearcoatTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.clearcoatRoughness = extension.clearcoatRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.clearcoatRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatRoughnessMap', extension.clearcoatRoughnessTexture ) );\n\n\t\t}\n\n\t\tif ( extension.clearcoatNormalTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'clearcoatNormalMap', extension.clearcoatNormalTexture ) );\n\n\t\t\tif ( extension.clearcoatNormalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = extension.clearcoatNormalTexture.scale;\n\n\t\t\t\tmaterialParams.clearcoatNormalScale = new Vector2( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Sheen Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Khronos/KHR_materials_sheen\n */\nclass GLTFMaterialsSheenExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SHEEN;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tmaterialParams.sheenColor = new Color( 0, 0, 0 );\n\t\tmaterialParams.sheenRoughness = 0;\n\t\tmaterialParams.sheen = 1;\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.sheenColorFactor !== undefined ) {\n\n\t\t\tmaterialParams.sheenColor.fromArray( extension.sheenColorFactor );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessFactor !== undefined ) {\n\n\t\t\tmaterialParams.sheenRoughness = extension.sheenRoughnessFactor;\n\n\t\t}\n\n\t\tif ( extension.sheenColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenColorMap', extension.sheenColorTexture ) );\n\n\t\t}\n\n\t\tif ( extension.sheenRoughnessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'sheenRoughnessMap', extension.sheenRoughnessTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Transmission Materials Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_transmission\n * Draft: https://github.com/KhronosGroup/glTF/pull/1698\n */\nclass GLTFMaterialsTransmissionExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_TRANSMISSION;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tif ( extension.transmissionFactor !== undefined ) {\n\n\t\t\tmaterialParams.transmission = extension.transmissionFactor;\n\n\t\t}\n\n\t\tif ( extension.transmissionTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'transmissionMap', extension.transmissionTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials Volume Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_volume\n */\nclass GLTFMaterialsVolumeExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_VOLUME;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.thickness = extension.thicknessFactor !== undefined ? extension.thicknessFactor : 0;\n\n\t\tif ( extension.thicknessTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'thicknessMap', extension.thicknessTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.attenuationDistance = extension.attenuationDistance || 0;\n\n\t\tconst colorArray = extension.attenuationColor || [ 1, 1, 1 ];\n\t\tmaterialParams.attenuationColor = new Color( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ] );\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * Materials ior Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_ior\n */\nclass GLTFMaterialsIorExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_IOR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.ior = extension.ior !== undefined ? extension.ior : 1.5;\n\n\t\treturn Promise.resolve();\n\n\t}\n\n}\n\n/**\n * Materials specular Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_materials_specular\n */\nclass GLTFMaterialsSpecularExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_SPECULAR;\n\n\t}\n\n\tgetMaterialType( materialIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) return null;\n\n\t\treturn MeshPhysicalMaterial;\n\n\t}\n\n\textendMaterialParams( materialIndex, materialParams ) {\n\n\t\tconst parser = this.parser;\n\t\tconst materialDef = parser.json.materials[ materialIndex ];\n\n\t\tif ( ! materialDef.extensions || ! materialDef.extensions[ this.name ] ) {\n\n\t\t\treturn Promise.resolve();\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tconst extension = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.specularIntensity = extension.specularFactor !== undefined ? extension.specularFactor : 1.0;\n\n\t\tif ( extension.specularTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularIntensityMap', extension.specularTexture ) );\n\n\t\t}\n\n\t\tconst colorArray = extension.specularColorFactor || [ 1, 1, 1 ];\n\t\tmaterialParams.specularColor = new Color( colorArray[ 0 ], colorArray[ 1 ], colorArray[ 2 ] );\n\n\t\tif ( extension.specularColorTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularColorMap', extension.specularColorTexture ).then( function ( texture ) {\n\n\t\t\t\ttexture.encoding = sRGBEncoding;\n\n\t\t\t} ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n}\n\n/**\n * BasisU Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_basisu\n */\nclass GLTFTextureBasisUExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_BASISU;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ this.name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ this.name ];\n\t\tconst source = json.images[ extension.source ];\n\t\tconst loader = parser.options.ktx2Loader;\n\n\t\tif ( ! loader ) {\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures' );\n\n\t\t\t} else {\n\n\t\t\t\t// Assumes that the extension is optional and that a fallback texture is present\n\t\t\t\treturn null;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.loadTextureImage( textureIndex, source, loader );\n\n\t}\n\n}\n\n/**\n * WebP Texture Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_texture_webp\n */\nclass GLTFTextureWebPExtension {\n\n\tconstructor( parser ) {\n\n\t\tthis.parser = parser;\n\t\tthis.name = EXTENSIONS.EXT_TEXTURE_WEBP;\n\t\tthis.isSupported = null;\n\n\t}\n\n\tloadTexture( textureIndex ) {\n\n\t\tconst name = this.name;\n\t\tconst parser = this.parser;\n\t\tconst json = parser.json;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tif ( ! textureDef.extensions || ! textureDef.extensions[ name ] ) {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t\tconst extension = textureDef.extensions[ name ];\n\t\tconst source = json.images[ extension.source ];\n\n\t\tlet loader = parser.textureLoader;\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = parser.options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.detectSupport().then( function ( isSupported ) {\n\n\t\t\tif ( isSupported ) return parser.loadTextureImage( textureIndex, source, loader );\n\n\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( name ) >= 0 ) {\n\n\t\t\t\tthrow new Error( 'THREE.GLTFLoader: WebP required by asset but unsupported.' );\n\n\t\t\t}\n\n\t\t\t// Fall back to PNG or JPEG.\n\t\t\treturn parser.loadTexture( textureIndex );\n\n\t\t} );\n\n\t}\n\n\tdetectSupport() {\n\n\t\tif ( ! this.isSupported ) {\n\n\t\t\tthis.isSupported = new Promise( function ( resolve ) {\n\n\t\t\t\tconst image = new Image();\n\n\t\t\t\t// Lossy test image. Support for lossy images doesn't guarantee support for all\n\t\t\t\t// WebP images, unfortunately.\n\t\t\t\timage.src = 'data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA';\n\n\t\t\t\timage.onload = image.onerror = function () {\n\n\t\t\t\t\tresolve( image.height === 1 );\n\n\t\t\t\t};\n\n\t\t\t} );\n\n\t\t}\n\n\t\treturn this.isSupported;\n\n\t}\n\n}\n\n/**\n * meshopt BufferView Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_meshopt_compression\n */\nclass GLTFMeshoptCompression {\n\n\tconstructor( parser ) {\n\n\t\tthis.name = EXTENSIONS.EXT_MESHOPT_COMPRESSION;\n\t\tthis.parser = parser;\n\n\t}\n\n\tloadBufferView( index ) {\n\n\t\tconst json = this.parser.json;\n\t\tconst bufferView = json.bufferViews[ index ];\n\n\t\tif ( bufferView.extensions && bufferView.extensions[ this.name ] ) {\n\n\t\t\tconst extensionDef = bufferView.extensions[ this.name ];\n\n\t\t\tconst buffer = this.parser.getDependency( 'buffer', extensionDef.buffer );\n\t\t\tconst decoder = this.parser.options.meshoptDecoder;\n\n\t\t\tif ( ! decoder || ! decoder.supported ) {\n\n\t\t\t\tif ( json.extensionsRequired && json.extensionsRequired.indexOf( this.name ) >= 0 ) {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files' );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Assumes that the extension is optional and that fallback buffer data is present\n\t\t\t\t\treturn null;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn Promise.all( [ buffer, decoder.ready ] ).then( function ( res ) {\n\n\t\t\t\tconst byteOffset = extensionDef.byteOffset || 0;\n\t\t\t\tconst byteLength = extensionDef.byteLength || 0;\n\n\t\t\t\tconst count = extensionDef.count;\n\t\t\t\tconst stride = extensionDef.byteStride;\n\n\t\t\t\tconst result = new ArrayBuffer( count * stride );\n\t\t\t\tconst source = new Uint8Array( res[ 0 ], byteOffset, byteLength );\n\n\t\t\t\tdecoder.decodeGltfBuffer( new Uint8Array( result ), count, stride, source, extensionDef.mode, extensionDef.filter );\n\t\t\t\treturn result;\n\n\t\t\t} );\n\n\t\t} else {\n\n\t\t\treturn null;\n\n\t\t}\n\n\t}\n\n}\n\n/* BINARY EXTENSION */\nconst BINARY_EXTENSION_HEADER_MAGIC = 'glTF';\nconst BINARY_EXTENSION_HEADER_LENGTH = 12;\nconst BINARY_EXTENSION_CHUNK_TYPES = { JSON: 0x4E4F534A, BIN: 0x004E4942 };\n\nclass GLTFBinaryExtension {\n\n\tconstructor( data ) {\n\n\t\tthis.name = EXTENSIONS.KHR_BINARY_GLTF;\n\t\tthis.content = null;\n\t\tthis.body = null;\n\n\t\tconst headerView = new DataView( data, 0, BINARY_EXTENSION_HEADER_LENGTH );\n\n\t\tthis.header = {\n\t\t\tmagic: LoaderUtils.decodeText( new Uint8Array( data.slice( 0, 4 ) ) ),\n\t\t\tversion: headerView.getUint32( 4, true ),\n\t\t\tlength: headerView.getUint32( 8, true )\n\t\t};\n\n\t\tif ( this.header.magic !== BINARY_EXTENSION_HEADER_MAGIC ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported glTF-Binary header.' );\n\n\t\t} else if ( this.header.version < 2.0 ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Legacy binary file detected.' );\n\n\t\t}\n\n\t\tconst chunkContentsLength = this.header.length - BINARY_EXTENSION_HEADER_LENGTH;\n\t\tconst chunkView = new DataView( data, BINARY_EXTENSION_HEADER_LENGTH );\n\t\tlet chunkIndex = 0;\n\n\t\twhile ( chunkIndex < chunkContentsLength ) {\n\n\t\t\tconst chunkLength = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tconst chunkType = chunkView.getUint32( chunkIndex, true );\n\t\t\tchunkIndex += 4;\n\n\t\t\tif ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.JSON ) {\n\n\t\t\t\tconst contentArray = new Uint8Array( data, BINARY_EXTENSION_HEADER_LENGTH + chunkIndex, chunkLength );\n\t\t\t\tthis.content = LoaderUtils.decodeText( contentArray );\n\n\t\t\t} else if ( chunkType === BINARY_EXTENSION_CHUNK_TYPES.BIN ) {\n\n\t\t\t\tconst byteOffset = BINARY_EXTENSION_HEADER_LENGTH + chunkIndex;\n\t\t\t\tthis.body = data.slice( byteOffset, byteOffset + chunkLength );\n\n\t\t\t}\n\n\t\t\t// Clients must ignore chunks with unknown types.\n\n\t\t\tchunkIndex += chunkLength;\n\n\t\t}\n\n\t\tif ( this.content === null ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: JSON content not found.' );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * DRACO Mesh Compression Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_draco_mesh_compression\n */\nclass GLTFDracoMeshCompressionExtension {\n\n\tconstructor( json, dracoLoader ) {\n\n\t\tif ( ! dracoLoader ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: No DRACOLoader instance provided.' );\n\n\t\t}\n\n\t\tthis.name = EXTENSIONS.KHR_DRACO_MESH_COMPRESSION;\n\t\tthis.json = json;\n\t\tthis.dracoLoader = dracoLoader;\n\t\tthis.dracoLoader.preload();\n\n\t}\n\n\tdecodePrimitive( primitive, parser ) {\n\n\t\tconst json = this.json;\n\t\tconst dracoLoader = this.dracoLoader;\n\t\tconst bufferViewIndex = primitive.extensions[ this.name ].bufferView;\n\t\tconst gltfAttributeMap = primitive.extensions[ this.name ].attributes;\n\t\tconst threeAttributeMap = {};\n\t\tconst attributeNormalizedMap = {};\n\t\tconst attributeTypeMap = {};\n\n\t\tfor ( const attributeName in gltfAttributeMap ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tthreeAttributeMap[ threeAttributeName ] = gltfAttributeMap[ attributeName ];\n\n\t\t}\n\n\t\tfor ( const attributeName in primitive.attributes ) {\n\n\t\t\tconst threeAttributeName = ATTRIBUTES[ attributeName ] || attributeName.toLowerCase();\n\n\t\t\tif ( gltfAttributeMap[ attributeName ] !== undefined ) {\n\n\t\t\t\tconst accessorDef = json.accessors[ primitive.attributes[ attributeName ] ];\n\t\t\t\tconst componentType = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t\tattributeTypeMap[ threeAttributeName ] = componentType;\n\t\t\t\tattributeNormalizedMap[ threeAttributeName ] = accessorDef.normalized === true;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn parser.getDependency( 'bufferView', bufferViewIndex ).then( function ( bufferView ) {\n\n\t\t\treturn new Promise( function ( resolve ) {\n\n\t\t\t\tdracoLoader.decodeDracoFile( bufferView, function ( geometry ) {\n\n\t\t\t\t\tfor ( const attributeName in geometry.attributes ) {\n\n\t\t\t\t\t\tconst attribute = geometry.attributes[ attributeName ];\n\t\t\t\t\t\tconst normalized = attributeNormalizedMap[ attributeName ];\n\n\t\t\t\t\t\tif ( normalized !== undefined ) attribute.normalized = normalized;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tresolve( geometry );\n\n\t\t\t\t}, threeAttributeMap, attributeTypeMap );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n}\n\n/**\n * Texture Transform Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_texture_transform\n */\nclass GLTFTextureTransformExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_TEXTURE_TRANSFORM;\n\n\t}\n\n\textendTexture( texture, transform ) {\n\n\t\tif ( transform.texCoord !== undefined ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV sets in \"' + this.name + '\" extension not yet supported.' );\n\n\t\t}\n\n\t\tif ( transform.offset === undefined && transform.rotation === undefined && transform.scale === undefined ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21819.\n\t\t\treturn texture;\n\n\t\t}\n\n\t\ttexture = texture.clone();\n\n\t\tif ( transform.offset !== undefined ) {\n\n\t\t\ttexture.offset.fromArray( transform.offset );\n\n\t\t}\n\n\t\tif ( transform.rotation !== undefined ) {\n\n\t\t\ttexture.rotation = transform.rotation;\n\n\t\t}\n\n\t\tif ( transform.scale !== undefined ) {\n\n\t\t\ttexture.repeat.fromArray( transform.scale );\n\n\t\t}\n\n\t\ttexture.needsUpdate = true;\n\n\t\treturn texture;\n\n\t}\n\n}\n\n/**\n * Specular-Glossiness Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/main/extensions/2.0/Archived/KHR_materials_pbrSpecularGlossiness\n */\n\n/**\n * A sub class of StandardMaterial with some of the functionality\n * changed via the `onBeforeCompile` callback\n * @pailhead\n */\nclass GLTFMeshStandardSGMaterial extends MeshStandardMaterial {\n\n\tconstructor( params ) {\n\n\t\tsuper();\n\n\t\tthis.isGLTFSpecularGlossinessMaterial = true;\n\n\t\t//various chunks that need replacing\n\t\tconst specularMapParsFragmentChunk = [\n\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t'\tuniform sampler2D specularMap;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst glossinessMapParsFragmentChunk = [\n\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t'\tuniform sampler2D glossinessMap;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst specularMapFragmentChunk = [\n\t\t\t'vec3 specularFactor = specular;',\n\t\t\t'#ifdef USE_SPECULARMAP',\n\t\t\t'\tvec4 texelSpecular = texture2D( specularMap, vUv );',\n\t\t\t'\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t'\tspecularFactor *= texelSpecular.rgb;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst glossinessMapFragmentChunk = [\n\t\t\t'float glossinessFactor = glossiness;',\n\t\t\t'#ifdef USE_GLOSSINESSMAP',\n\t\t\t'\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );',\n\t\t\t'\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture',\n\t\t\t'\tglossinessFactor *= texelGlossiness.a;',\n\t\t\t'#endif'\n\t\t].join( '\\n' );\n\n\t\tconst lightPhysicalFragmentChunk = [\n\t\t\t'PhysicalMaterial material;',\n\t\t\t'material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );',\n\t\t\t'vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );',\n\t\t\t'float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );',\n\t\t\t'material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.',\n\t\t\t'material.roughness += geometryRoughness;',\n\t\t\t'material.roughness = min( material.roughness, 1.0 );',\n\t\t\t'material.specularColor = specularFactor;',\n\t\t].join( '\\n' );\n\n\t\tconst uniforms = {\n\t\t\tspecular: { value: new Color().setHex( 0xffffff ) },\n\t\t\tglossiness: { value: 1 },\n\t\t\tspecularMap: { value: null },\n\t\t\tglossinessMap: { value: null }\n\t\t};\n\n\t\tthis._extraUniforms = uniforms;\n\n\t\tthis.onBeforeCompile = function ( shader ) {\n\n\t\t\tfor ( const uniformName in uniforms ) {\n\n\t\t\t\tshader.uniforms[ uniformName ] = uniforms[ uniformName ];\n\n\t\t\t}\n\n\t\t\tshader.fragmentShader = shader.fragmentShader\n\t\t\t\t.replace( 'uniform float roughness;', 'uniform vec3 specular;' )\n\t\t\t\t.replace( 'uniform float metalness;', 'uniform float glossiness;' )\n\t\t\t\t.replace( '#include <roughnessmap_pars_fragment>', specularMapParsFragmentChunk )\n\t\t\t\t.replace( '#include <metalnessmap_pars_fragment>', glossinessMapParsFragmentChunk )\n\t\t\t\t.replace( '#include <roughnessmap_fragment>', specularMapFragmentChunk )\n\t\t\t\t.replace( '#include <metalnessmap_fragment>', glossinessMapFragmentChunk )\n\t\t\t\t.replace( '#include <lights_physical_fragment>', lightPhysicalFragmentChunk );\n\n\t\t};\n\n\t\tObject.defineProperties( this, {\n\n\t\t\tspecular: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.specular.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.specular.value = v;\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tspecularMap: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.specularMap.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.specularMap.value = v;\n\n\t\t\t\t\tif ( v ) {\n\n\t\t\t\t\t\tthis.defines.USE_SPECULARMAP = ''; // USE_UV is set by the renderer for specular maps\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdelete this.defines.USE_SPECULARMAP;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tglossiness: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.glossiness.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.glossiness.value = v;\n\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tglossinessMap: {\n\t\t\t\tget: function () {\n\n\t\t\t\t\treturn uniforms.glossinessMap.value;\n\n\t\t\t\t},\n\t\t\t\tset: function ( v ) {\n\n\t\t\t\t\tuniforms.glossinessMap.value = v;\n\n\t\t\t\t\tif ( v ) {\n\n\t\t\t\t\t\tthis.defines.USE_GLOSSINESSMAP = '';\n\t\t\t\t\t\tthis.defines.USE_UV = '';\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tdelete this.defines.USE_GLOSSINESSMAP;\n\t\t\t\t\t\tdelete this.defines.USE_UV;\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\t\t\t}\n\n\t\t} );\n\n\t\tdelete this.metalness;\n\t\tdelete this.roughness;\n\t\tdelete this.metalnessMap;\n\t\tdelete this.roughnessMap;\n\n\t\tthis.setValues( params );\n\n\t}\n\n\tcopy( source ) {\n\n\t\tsuper.copy( source );\n\n\t\tthis.specularMap = source.specularMap;\n\t\tthis.specular.copy( source.specular );\n\t\tthis.glossinessMap = source.glossinessMap;\n\t\tthis.glossiness = source.glossiness;\n\t\tdelete this.metalness;\n\t\tdelete this.roughness;\n\t\tdelete this.metalnessMap;\n\t\tdelete this.roughnessMap;\n\t\treturn this;\n\n\t}\n\n}\n\n\nclass GLTFMaterialsPbrSpecularGlossinessExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS;\n\n\t\tthis.specularGlossinessParams = [\n\t\t\t'color',\n\t\t\t'map',\n\t\t\t'lightMap',\n\t\t\t'lightMapIntensity',\n\t\t\t'aoMap',\n\t\t\t'aoMapIntensity',\n\t\t\t'emissive',\n\t\t\t'emissiveIntensity',\n\t\t\t'emissiveMap',\n\t\t\t'bumpMap',\n\t\t\t'bumpScale',\n\t\t\t'normalMap',\n\t\t\t'normalMapType',\n\t\t\t'displacementMap',\n\t\t\t'displacementScale',\n\t\t\t'displacementBias',\n\t\t\t'specularMap',\n\t\t\t'specular',\n\t\t\t'glossinessMap',\n\t\t\t'glossiness',\n\t\t\t'alphaMap',\n\t\t\t'envMap',\n\t\t\t'envMapIntensity',\n\t\t\t'refractionRatio',\n\t\t];\n\n\t}\n\n\tgetMaterialType() {\n\n\t\treturn GLTFMeshStandardSGMaterial;\n\n\t}\n\n\textendParams( materialParams, materialDef, parser ) {\n\n\t\tconst pbrSpecularGlossiness = materialDef.extensions[ this.name ];\n\n\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\tmaterialParams.opacity = 1.0;\n\n\t\tconst pending = [];\n\n\t\tif ( Array.isArray( pbrSpecularGlossiness.diffuseFactor ) ) {\n\n\t\t\tconst array = pbrSpecularGlossiness.diffuseFactor;\n\n\t\t\tmaterialParams.color.fromArray( array );\n\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t}\n\n\t\tif ( pbrSpecularGlossiness.diffuseTexture !== undefined ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'map', pbrSpecularGlossiness.diffuseTexture ) );\n\n\t\t}\n\n\t\tmaterialParams.emissive = new Color( 0.0, 0.0, 0.0 );\n\t\tmaterialParams.glossiness = pbrSpecularGlossiness.glossinessFactor !== undefined ? pbrSpecularGlossiness.glossinessFactor : 1.0;\n\t\tmaterialParams.specular = new Color( 1.0, 1.0, 1.0 );\n\n\t\tif ( Array.isArray( pbrSpecularGlossiness.specularFactor ) ) {\n\n\t\t\tmaterialParams.specular.fromArray( pbrSpecularGlossiness.specularFactor );\n\n\t\t}\n\n\t\tif ( pbrSpecularGlossiness.specularGlossinessTexture !== undefined ) {\n\n\t\t\tconst specGlossMapDef = pbrSpecularGlossiness.specularGlossinessTexture;\n\t\t\tpending.push( parser.assignTexture( materialParams, 'glossinessMap', specGlossMapDef ) );\n\t\t\tpending.push( parser.assignTexture( materialParams, 'specularMap', specGlossMapDef ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\tcreateMaterial( materialParams ) {\n\n\t\tconst material = new GLTFMeshStandardSGMaterial( materialParams );\n\t\tmaterial.fog = true;\n\n\t\tmaterial.color = materialParams.color;\n\n\t\tmaterial.map = materialParams.map === undefined ? null : materialParams.map;\n\n\t\tmaterial.lightMap = null;\n\t\tmaterial.lightMapIntensity = 1.0;\n\n\t\tmaterial.aoMap = materialParams.aoMap === undefined ? null : materialParams.aoMap;\n\t\tmaterial.aoMapIntensity = 1.0;\n\n\t\tmaterial.emissive = materialParams.emissive;\n\t\tmaterial.emissiveIntensity = 1.0;\n\t\tmaterial.emissiveMap = materialParams.emissiveMap === undefined ? null : materialParams.emissiveMap;\n\n\t\tmaterial.bumpMap = materialParams.bumpMap === undefined ? null : materialParams.bumpMap;\n\t\tmaterial.bumpScale = 1;\n\n\t\tmaterial.normalMap = materialParams.normalMap === undefined ? null : materialParams.normalMap;\n\t\tmaterial.normalMapType = TangentSpaceNormalMap;\n\n\t\tif ( materialParams.normalScale ) material.normalScale = materialParams.normalScale;\n\n\t\tmaterial.displacementMap = null;\n\t\tmaterial.displacementScale = 1;\n\t\tmaterial.displacementBias = 0;\n\n\t\tmaterial.specularMap = materialParams.specularMap === undefined ? null : materialParams.specularMap;\n\t\tmaterial.specular = materialParams.specular;\n\n\t\tmaterial.glossinessMap = materialParams.glossinessMap === undefined ? null : materialParams.glossinessMap;\n\t\tmaterial.glossiness = materialParams.glossiness;\n\n\t\tmaterial.alphaMap = null;\n\n\t\tmaterial.envMap = materialParams.envMap === undefined ? null : materialParams.envMap;\n\t\tmaterial.envMapIntensity = 1.0;\n\n\t\tmaterial.refractionRatio = 0.98;\n\n\t\treturn material;\n\n\t}\n\n}\n\n/**\n * Mesh Quantization Extension\n *\n * Specification: https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization\n */\nclass GLTFMeshQuantizationExtension {\n\n\tconstructor() {\n\n\t\tthis.name = EXTENSIONS.KHR_MESH_QUANTIZATION;\n\n\t}\n\n}\n\n/*********************************/\n/********** INTERPOLATION ********/\n/*********************************/\n\n// Spline Interpolation\n// Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#appendix-c-spline-interpolation\nclass GLTFCubicSplineInterpolant extends Interpolant {\n\n\tconstructor( parameterPositions, sampleValues, sampleSize, resultBuffer ) {\n\n\t\tsuper( parameterPositions, sampleValues, sampleSize, resultBuffer );\n\n\t}\n\n\tcopySampleValue_( index ) {\n\n\t\t// Copies a sample value to the result buffer. See description of glTF\n\t\t// CUBICSPLINE values layout in interpolate_() function below.\n\n\t\tconst result = this.resultBuffer,\n\t\t\tvalues = this.sampleValues,\n\t\t\tvalueSize = this.valueSize,\n\t\t\toffset = index * valueSize * 3 + valueSize;\n\n\t\tfor ( let i = 0; i !== valueSize; i ++ ) {\n\n\t\t\tresult[ i ] = values[ offset + i ];\n\n\t\t}\n\n\t\treturn result;\n\n\t}\n\n}\n\nGLTFCubicSplineInterpolant.prototype.beforeStart_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\nGLTFCubicSplineInterpolant.prototype.afterEnd_ = GLTFCubicSplineInterpolant.prototype.copySampleValue_;\n\nGLTFCubicSplineInterpolant.prototype.interpolate_ = function ( i1, t0, t, t1 ) {\n\n\tconst result = this.resultBuffer;\n\tconst values = this.sampleValues;\n\tconst stride = this.valueSize;\n\n\tconst stride2 = stride * 2;\n\tconst stride3 = stride * 3;\n\n\tconst td = t1 - t0;\n\n\tconst p = ( t - t0 ) / td;\n\tconst pp = p * p;\n\tconst ppp = pp * p;\n\n\tconst offset1 = i1 * stride3;\n\tconst offset0 = offset1 - stride3;\n\n\tconst s2 = - 2 * ppp + 3 * pp;\n\tconst s3 = ppp - pp;\n\tconst s0 = 1 - s2;\n\tconst s1 = s3 - pp + p;\n\n\t// Layout of keyframe output values for CUBICSPLINE animations:\n\t//   [ inTangent_1, splineVertex_1, outTangent_1, inTangent_2, splineVertex_2, ... ]\n\tfor ( let i = 0; i !== stride; i ++ ) {\n\n\t\tconst p0 = values[ offset0 + i + stride ]; // splineVertex_k\n\t\tconst m0 = values[ offset0 + i + stride2 ] * td; // outTangent_k * (t_k+1 - t_k)\n\t\tconst p1 = values[ offset1 + i + stride ]; // splineVertex_k+1\n\t\tconst m1 = values[ offset1 + i ] * td; // inTangent_k+1 * (t_k+1 - t_k)\n\n\t\tresult[ i ] = s0 * p0 + s1 * m0 + s2 * p1 + s3 * m1;\n\n\t}\n\n\treturn result;\n\n};\n\nconst _q = new Quaternion();\n\nclass GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant {\n\n\tinterpolate_( i1, t0, t, t1 ) {\n\n\t\tconst result = super.interpolate_( i1, t0, t, t1 );\n\n\t\t_q.fromArray( result ).normalize().toArray( result );\n\n\t\treturn result;\n\n\t}\n\n}\n\n\n/*********************************/\n/********** INTERNALS ************/\n/*********************************/\n\n/* CONSTANTS */\n\nconst WEBGL_CONSTANTS = {\n\tFLOAT: 5126,\n\t//FLOAT_MAT2: 35674,\n\tFLOAT_MAT3: 35675,\n\tFLOAT_MAT4: 35676,\n\tFLOAT_VEC2: 35664,\n\tFLOAT_VEC3: 35665,\n\tFLOAT_VEC4: 35666,\n\tLINEAR: 9729,\n\tREPEAT: 10497,\n\tSAMPLER_2D: 35678,\n\tPOINTS: 0,\n\tLINES: 1,\n\tLINE_LOOP: 2,\n\tLINE_STRIP: 3,\n\tTRIANGLES: 4,\n\tTRIANGLE_STRIP: 5,\n\tTRIANGLE_FAN: 6,\n\tUNSIGNED_BYTE: 5121,\n\tUNSIGNED_SHORT: 5123\n};\n\nconst WEBGL_COMPONENT_TYPES = {\n\t5120: Int8Array,\n\t5121: Uint8Array,\n\t5122: Int16Array,\n\t5123: Uint16Array,\n\t5125: Uint32Array,\n\t5126: Float32Array\n};\n\nconst WEBGL_FILTERS = {\n\t9728: NearestFilter,\n\t9729: LinearFilter,\n\t9984: NearestMipmapNearestFilter,\n\t9985: LinearMipmapNearestFilter,\n\t9986: NearestMipmapLinearFilter,\n\t9987: LinearMipmapLinearFilter\n};\n\nconst WEBGL_WRAPPINGS = {\n\t33071: ClampToEdgeWrapping,\n\t33648: MirroredRepeatWrapping,\n\t10497: RepeatWrapping\n};\n\nconst WEBGL_TYPE_SIZES = {\n\t'SCALAR': 1,\n\t'VEC2': 2,\n\t'VEC3': 3,\n\t'VEC4': 4,\n\t'MAT2': 4,\n\t'MAT3': 9,\n\t'MAT4': 16\n};\n\nconst ATTRIBUTES = {\n\tPOSITION: 'position',\n\tNORMAL: 'normal',\n\tTANGENT: 'tangent',\n\tTEXCOORD_0: 'uv',\n\tTEXCOORD_1: 'uv2',\n\tCOLOR_0: 'color',\n\tWEIGHTS_0: 'skinWeight',\n\tJOINTS_0: 'skinIndex',\n};\n\nconst PATH_PROPERTIES = {\n\tscale: 'scale',\n\ttranslation: 'position',\n\trotation: 'quaternion',\n\tweights: 'morphTargetInfluences'\n};\n\nconst INTERPOLATION = {\n\tCUBICSPLINE: undefined, // We use a custom interpolant (GLTFCubicSplineInterpolation) for CUBICSPLINE tracks. Each\n\t\t                        // keyframe track will be initialized with a default interpolation type, then modified.\n\tLINEAR: InterpolateLinear,\n\tSTEP: InterpolateDiscrete\n};\n\nconst ALPHA_MODES = {\n\tOPAQUE: 'OPAQUE',\n\tMASK: 'MASK',\n\tBLEND: 'BLEND'\n};\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#default-material\n */\nfunction createDefaultMaterial( cache ) {\n\n\tif ( cache[ 'DefaultMaterial' ] === undefined ) {\n\n\t\tcache[ 'DefaultMaterial' ] = new MeshStandardMaterial( {\n\t\t\tcolor: 0xFFFFFF,\n\t\t\temissive: 0x000000,\n\t\t\tmetalness: 1,\n\t\t\troughness: 1,\n\t\t\ttransparent: false,\n\t\t\tdepthTest: true,\n\t\t\tside: FrontSide\n\t\t} );\n\n\t}\n\n\treturn cache[ 'DefaultMaterial' ];\n\n}\n\nfunction addUnknownExtensionsToUserData( knownExtensions, object, objectDef ) {\n\n\t// Add unknown glTF extensions to an object's userData.\n\n\tfor ( const name in objectDef.extensions ) {\n\n\t\tif ( knownExtensions[ name ] === undefined ) {\n\n\t\t\tobject.userData.gltfExtensions = object.userData.gltfExtensions || {};\n\t\t\tobject.userData.gltfExtensions[ name ] = objectDef.extensions[ name ];\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * @param {Object3D|Material|BufferGeometry} object\n * @param {GLTF.definition} gltfDef\n */\nfunction assignExtrasToUserData( object, gltfDef ) {\n\n\tif ( gltfDef.extras !== undefined ) {\n\n\t\tif ( typeof gltfDef.extras === 'object' ) {\n\n\t\t\tObject.assign( object.userData, gltfDef.extras );\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Ignoring primitive type .extras, ' + gltfDef.extras );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#morph-targets\n *\n * @param {BufferGeometry} geometry\n * @param {Array<GLTF.Target>} targets\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addMorphTargets( geometry, targets, parser ) {\n\n\tlet hasMorphPosition = false;\n\tlet hasMorphNormal = false;\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( target.POSITION !== undefined ) hasMorphPosition = true;\n\t\tif ( target.NORMAL !== undefined ) hasMorphNormal = true;\n\n\t\tif ( hasMorphPosition && hasMorphNormal ) break;\n\n\t}\n\n\tif ( ! hasMorphPosition && ! hasMorphNormal ) return Promise.resolve( geometry );\n\n\tconst pendingPositionAccessors = [];\n\tconst pendingNormalAccessors = [];\n\n\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\tconst target = targets[ i ];\n\n\t\tif ( hasMorphPosition ) {\n\n\t\t\tconst pendingAccessor = target.POSITION !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.POSITION )\n\t\t\t\t: geometry.attributes.position;\n\n\t\t\tpendingPositionAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t\tif ( hasMorphNormal ) {\n\n\t\t\tconst pendingAccessor = target.NORMAL !== undefined\n\t\t\t\t? parser.getDependency( 'accessor', target.NORMAL )\n\t\t\t\t: geometry.attributes.normal;\n\n\t\t\tpendingNormalAccessors.push( pendingAccessor );\n\n\t\t}\n\n\t}\n\n\treturn Promise.all( [\n\t\tPromise.all( pendingPositionAccessors ),\n\t\tPromise.all( pendingNormalAccessors )\n\t] ).then( function ( accessors ) {\n\n\t\tconst morphPositions = accessors[ 0 ];\n\t\tconst morphNormals = accessors[ 1 ];\n\n\t\tif ( hasMorphPosition ) geometry.morphAttributes.position = morphPositions;\n\t\tif ( hasMorphNormal ) geometry.morphAttributes.normal = morphNormals;\n\t\tgeometry.morphTargetsRelative = true;\n\n\t\treturn geometry;\n\n\t} );\n\n}\n\n/**\n * @param {Mesh} mesh\n * @param {GLTF.Mesh} meshDef\n */\nfunction updateMorphTargets( mesh, meshDef ) {\n\n\tmesh.updateMorphTargets();\n\n\tif ( meshDef.weights !== undefined ) {\n\n\t\tfor ( let i = 0, il = meshDef.weights.length; i < il; i ++ ) {\n\n\t\t\tmesh.morphTargetInfluences[ i ] = meshDef.weights[ i ];\n\n\t\t}\n\n\t}\n\n\t// .extras has user-defined data, so check that .extras.targetNames is an array.\n\tif ( meshDef.extras && Array.isArray( meshDef.extras.targetNames ) ) {\n\n\t\tconst targetNames = meshDef.extras.targetNames;\n\n\t\tif ( mesh.morphTargetInfluences.length === targetNames.length ) {\n\n\t\t\tmesh.morphTargetDictionary = {};\n\n\t\t\tfor ( let i = 0, il = targetNames.length; i < il; i ++ ) {\n\n\t\t\t\tmesh.morphTargetDictionary[ targetNames[ i ] ] = i;\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.' );\n\n\t\t}\n\n\t}\n\n}\n\nfunction createPrimitiveKey( primitiveDef ) {\n\n\tconst dracoExtension = primitiveDef.extensions && primitiveDef.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ];\n\tlet geometryKey;\n\n\tif ( dracoExtension ) {\n\n\t\tgeometryKey = 'draco:' + dracoExtension.bufferView\n\t\t\t\t+ ':' + dracoExtension.indices\n\t\t\t\t+ ':' + createAttributesKey( dracoExtension.attributes );\n\n\t} else {\n\n\t\tgeometryKey = primitiveDef.indices + ':' + createAttributesKey( primitiveDef.attributes ) + ':' + primitiveDef.mode;\n\n\t}\n\n\treturn geometryKey;\n\n}\n\nfunction createAttributesKey( attributes ) {\n\n\tlet attributesKey = '';\n\n\tconst keys = Object.keys( attributes ).sort();\n\n\tfor ( let i = 0, il = keys.length; i < il; i ++ ) {\n\n\t\tattributesKey += keys[ i ] + ':' + attributes[ keys[ i ] ] + ';';\n\n\t}\n\n\treturn attributesKey;\n\n}\n\nfunction getNormalizedComponentScale( constructor ) {\n\n\t// Reference:\n\t// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Khronos/KHR_mesh_quantization#encoding-quantized-data\n\n\tswitch ( constructor ) {\n\n\t\tcase Int8Array:\n\t\t\treturn 1 / 127;\n\n\t\tcase Uint8Array:\n\t\t\treturn 1 / 255;\n\n\t\tcase Int16Array:\n\t\t\treturn 1 / 32767;\n\n\t\tcase Uint16Array:\n\t\t\treturn 1 / 65535;\n\n\t\tdefault:\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Unsupported normalized accessor component type.' );\n\n\t}\n\n}\n\n/* GLTF PARSER */\n\nclass GLTFParser {\n\n\tconstructor( json = {}, options = {} ) {\n\n\t\tthis.json = json;\n\t\tthis.extensions = {};\n\t\tthis.plugins = {};\n\t\tthis.options = options;\n\n\t\t// loader object cache\n\t\tthis.cache = new GLTFRegistry();\n\n\t\t// associations between Three.js objects and glTF elements\n\t\tthis.associations = new Map();\n\n\t\t// BufferGeometry caching\n\t\tthis.primitiveCache = {};\n\n\t\t// Object3D instance caches\n\t\tthis.meshCache = { refs: {}, uses: {} };\n\t\tthis.cameraCache = { refs: {}, uses: {} };\n\t\tthis.lightCache = { refs: {}, uses: {} };\n\n\t\tthis.textureCache = {};\n\n\t\t// Track node names, to ensure no duplicates\n\t\tthis.nodeNamesUsed = {};\n\n\t\t// Use an ImageBitmapLoader if imageBitmaps are supported. Moves much of the\n\t\t// expensive work of uploading a texture to the GPU off the main thread.\n\t\tif ( typeof createImageBitmap !== 'undefined' && /Firefox|^((?!chrome|android).)*safari/i.test( navigator.userAgent ) === false ) {\n\n\t\t\tthis.textureLoader = new ImageBitmapLoader( this.options.manager );\n\n\t\t} else {\n\n\t\t\tthis.textureLoader = new TextureLoader( this.options.manager );\n\n\t\t}\n\n\t\tthis.textureLoader.setCrossOrigin( this.options.crossOrigin );\n\t\tthis.textureLoader.setRequestHeader( this.options.requestHeader );\n\n\t\tthis.fileLoader = new FileLoader( this.options.manager );\n\t\tthis.fileLoader.setResponseType( 'arraybuffer' );\n\n\t\tif ( this.options.crossOrigin === 'use-credentials' ) {\n\n\t\t\tthis.fileLoader.setWithCredentials( true );\n\n\t\t}\n\n\t}\n\n\tsetExtensions( extensions ) {\n\n\t\tthis.extensions = extensions;\n\n\t}\n\n\tsetPlugins( plugins ) {\n\n\t\tthis.plugins = plugins;\n\n\t}\n\n\tparse( onLoad, onError ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\t// Clear the loader cache\n\t\tthis.cache.removeAll();\n\n\t\t// Mark the special nodes/meshes in json for efficient parse\n\t\tthis._invokeAll( function ( ext ) {\n\n\t\t\treturn ext._markDefs && ext._markDefs();\n\n\t\t} );\n\n\t\tPromise.all( this._invokeAll( function ( ext ) {\n\n\t\t\treturn ext.beforeRoot && ext.beforeRoot();\n\n\t\t} ) ).then( function () {\n\n\t\t\treturn Promise.all( [\n\n\t\t\t\tparser.getDependencies( 'scene' ),\n\t\t\t\tparser.getDependencies( 'animation' ),\n\t\t\t\tparser.getDependencies( 'camera' ),\n\n\t\t\t] );\n\n\t\t} ).then( function ( dependencies ) {\n\n\t\t\tconst result = {\n\t\t\t\tscene: dependencies[ 0 ][ json.scene || 0 ],\n\t\t\t\tscenes: dependencies[ 0 ],\n\t\t\t\tanimations: dependencies[ 1 ],\n\t\t\t\tcameras: dependencies[ 2 ],\n\t\t\t\tasset: json.asset,\n\t\t\t\tparser: parser,\n\t\t\t\tuserData: {}\n\t\t\t};\n\n\t\t\taddUnknownExtensionsToUserData( extensions, result, json );\n\n\t\t\tassignExtrasToUserData( result, json );\n\n\t\t\tPromise.all( parser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.afterRoot && ext.afterRoot( result );\n\n\t\t\t} ) ).then( function () {\n\n\t\t\t\tonLoad( result );\n\n\t\t\t} );\n\n\t\t} ).catch( onError );\n\n\t}\n\n\t/**\n\t * Marks the special nodes/meshes in json for efficient parse.\n\t */\n\t_markDefs() {\n\n\t\tconst nodeDefs = this.json.nodes || [];\n\t\tconst skinDefs = this.json.skins || [];\n\t\tconst meshDefs = this.json.meshes || [];\n\n\t\t// Nothing in the node definition indicates whether it is a Bone or an\n\t\t// Object3D. Use the skins' joint references to mark bones.\n\t\tfor ( let skinIndex = 0, skinLength = skinDefs.length; skinIndex < skinLength; skinIndex ++ ) {\n\n\t\t\tconst joints = skinDefs[ skinIndex ].joints;\n\n\t\t\tfor ( let i = 0, il = joints.length; i < il; i ++ ) {\n\n\t\t\t\tnodeDefs[ joints[ i ] ].isBone = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\t// Iterate over all nodes, marking references to shared resources,\n\t\t// as well as skeleton joints.\n\t\tfor ( let nodeIndex = 0, nodeLength = nodeDefs.length; nodeIndex < nodeLength; nodeIndex ++ ) {\n\n\t\t\tconst nodeDef = nodeDefs[ nodeIndex ];\n\n\t\t\tif ( nodeDef.mesh !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.meshCache, nodeDef.mesh );\n\n\t\t\t\t// Nothing in the mesh definition indicates whether it is\n\t\t\t\t// a SkinnedMesh or Mesh. Use the node's mesh reference\n\t\t\t\t// to mark SkinnedMesh if node has skin.\n\t\t\t\tif ( nodeDef.skin !== undefined ) {\n\n\t\t\t\t\tmeshDefs[ nodeDef.mesh ].isSkinnedMesh = true;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tthis._addNodeRef( this.cameraCache, nodeDef.camera );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\t/**\n\t * Counts references to shared node / Object3D resources. These resources\n\t * can be reused, or \"instantiated\", at multiple nodes in the scene\n\t * hierarchy. Mesh, Camera, and Light instances are instantiated and must\n\t * be marked. Non-scenegraph resources (like Materials, Geometries, and\n\t * Textures) can be reused directly and are not marked here.\n\t *\n\t * Example: CesiumMilkTruck sample model reuses \"Wheel\" meshes.\n\t */\n\t_addNodeRef( cache, index ) {\n\n\t\tif ( index === undefined ) return;\n\n\t\tif ( cache.refs[ index ] === undefined ) {\n\n\t\t\tcache.refs[ index ] = cache.uses[ index ] = 0;\n\n\t\t}\n\n\t\tcache.refs[ index ] ++;\n\n\t}\n\n\t/** Returns a reference to a shared resource, cloning it if necessary. */\n\t_getNodeRef( cache, index, object ) {\n\n\t\tif ( cache.refs[ index ] <= 1 ) return object;\n\n\t\tconst ref = object.clone();\n\n\t\t// Propagates mappings to the cloned object, prevents mappings on the\n\t\t// original object from being lost.\n\t\tconst updateMappings = ( original, clone ) => {\n\n\t\t\tconst mappings = this.associations.get( original );\n\t\t\tif ( mappings != null ) {\n\n\t\t\t\tthis.associations.set( clone, mappings );\n\n\t\t\t}\n\n\t\t\tfor ( const [ i, child ] of original.children.entries() ) {\n\n\t\t\t\tupdateMappings( child, clone.children[ i ] );\n\n\t\t\t}\n\n\t\t};\n\n\t\tupdateMappings( object, ref );\n\n\t\tref.name += '_instance_' + ( cache.uses[ index ] ++ );\n\n\t\treturn ref;\n\n\t}\n\n\t_invokeOne( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.push( this );\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) return result;\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\t_invokeAll( func ) {\n\n\t\tconst extensions = Object.values( this.plugins );\n\t\textensions.unshift( this );\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0; i < extensions.length; i ++ ) {\n\n\t\t\tconst result = func( extensions[ i ] );\n\n\t\t\tif ( result ) pending.push( result );\n\n\t\t}\n\n\t\treturn pending;\n\n\t}\n\n\t/**\n\t * Requests the specified dependency asynchronously, with caching.\n\t * @param {string} type\n\t * @param {number} index\n\t * @return {Promise<Object3D|Material|THREE.Texture|AnimationClip|ArrayBuffer|Object>}\n\t */\n\tgetDependency( type, index ) {\n\n\t\tconst cacheKey = type + ':' + index;\n\t\tlet dependency = this.cache.get( cacheKey );\n\n\t\tif ( ! dependency ) {\n\n\t\t\tswitch ( type ) {\n\n\t\t\t\tcase 'scene':\n\t\t\t\t\tdependency = this.loadScene( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'node':\n\t\t\t\t\tdependency = this.loadNode( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'mesh':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMesh && ext.loadMesh( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'accessor':\n\t\t\t\t\tdependency = this.loadAccessor( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'bufferView':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadBufferView && ext.loadBufferView( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'buffer':\n\t\t\t\t\tdependency = this.loadBuffer( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'material':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadMaterial && ext.loadMaterial( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'texture':\n\t\t\t\t\tdependency = this._invokeOne( function ( ext ) {\n\n\t\t\t\t\t\treturn ext.loadTexture && ext.loadTexture( index );\n\n\t\t\t\t\t} );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'skin':\n\t\t\t\t\tdependency = this.loadSkin( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'animation':\n\t\t\t\t\tdependency = this.loadAnimation( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase 'camera':\n\t\t\t\t\tdependency = this.loadCamera( index );\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tthrow new Error( 'Unknown type: ' + type );\n\n\t\t\t}\n\n\t\t\tthis.cache.add( cacheKey, dependency );\n\n\t\t}\n\n\t\treturn dependency;\n\n\t}\n\n\t/**\n\t * Requests all dependencies of the specified type asynchronously, with caching.\n\t * @param {string} type\n\t * @return {Promise<Array<Object>>}\n\t */\n\tgetDependencies( type ) {\n\n\t\tlet dependencies = this.cache.get( type );\n\n\t\tif ( ! dependencies ) {\n\n\t\t\tconst parser = this;\n\t\t\tconst defs = this.json[ type + ( type === 'mesh' ? 'es' : 's' ) ] || [];\n\n\t\t\tdependencies = Promise.all( defs.map( function ( def, index ) {\n\n\t\t\t\treturn parser.getDependency( type, index );\n\n\t\t\t} ) );\n\n\t\t\tthis.cache.add( type, dependencies );\n\n\t\t}\n\n\t\treturn dependencies;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBuffer( bufferIndex ) {\n\n\t\tconst bufferDef = this.json.buffers[ bufferIndex ];\n\t\tconst loader = this.fileLoader;\n\n\t\tif ( bufferDef.type && bufferDef.type !== 'arraybuffer' ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: ' + bufferDef.type + ' buffer type is not supported.' );\n\n\t\t}\n\n\t\t// If present, GLB container is required to be the first buffer.\n\t\tif ( bufferDef.uri === undefined && bufferIndex === 0 ) {\n\n\t\t\treturn Promise.resolve( this.extensions[ EXTENSIONS.KHR_BINARY_GLTF ].body );\n\n\t\t}\n\n\t\tconst options = this.options;\n\n\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\tloader.load( LoaderUtils.resolveURL( bufferDef.uri, options.path ), resolve, undefined, function () {\n\n\t\t\t\treject( new Error( 'THREE.GLTFLoader: Failed to load buffer \"' + bufferDef.uri + '\".' ) );\n\n\t\t\t} );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#buffers-and-buffer-views\n\t * @param {number} bufferViewIndex\n\t * @return {Promise<ArrayBuffer>}\n\t */\n\tloadBufferView( bufferViewIndex ) {\n\n\t\tconst bufferViewDef = this.json.bufferViews[ bufferViewIndex ];\n\n\t\treturn this.getDependency( 'buffer', bufferViewDef.buffer ).then( function ( buffer ) {\n\n\t\t\tconst byteLength = bufferViewDef.byteLength || 0;\n\t\t\tconst byteOffset = bufferViewDef.byteOffset || 0;\n\t\t\treturn buffer.slice( byteOffset, byteOffset + byteLength );\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#accessors\n\t * @param {number} accessorIndex\n\t * @return {Promise<BufferAttribute|InterleavedBufferAttribute>}\n\t */\n\tloadAccessor( accessorIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\n\t\tconst accessorDef = this.json.accessors[ accessorIndex ];\n\n\t\tif ( accessorDef.bufferView === undefined && accessorDef.sparse === undefined ) {\n\n\t\t\t// Ignore empty accessors, which may be used to declare runtime\n\t\t\t// information about attributes coming from another source (e.g. Draco\n\t\t\t// compression extension).\n\t\t\treturn Promise.resolve( null );\n\n\t\t}\n\n\t\tconst pendingBufferViews = [];\n\n\t\tif ( accessorDef.bufferView !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.bufferView ) );\n\n\t\t} else {\n\n\t\t\tpendingBufferViews.push( null );\n\n\t\t}\n\n\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.indices.bufferView ) );\n\t\t\tpendingBufferViews.push( this.getDependency( 'bufferView', accessorDef.sparse.values.bufferView ) );\n\n\t\t}\n\n\t\treturn Promise.all( pendingBufferViews ).then( function ( bufferViews ) {\n\n\t\t\tconst bufferView = bufferViews[ 0 ];\n\n\t\t\tconst itemSize = WEBGL_TYPE_SIZES[ accessorDef.type ];\n\t\t\tconst TypedArray = WEBGL_COMPONENT_TYPES[ accessorDef.componentType ];\n\n\t\t\t// For VEC3: itemSize is 3, elementBytes is 4, itemBytes is 12.\n\t\t\tconst elementBytes = TypedArray.BYTES_PER_ELEMENT;\n\t\t\tconst itemBytes = elementBytes * itemSize;\n\t\t\tconst byteOffset = accessorDef.byteOffset || 0;\n\t\t\tconst byteStride = accessorDef.bufferView !== undefined ? json.bufferViews[ accessorDef.bufferView ].byteStride : undefined;\n\t\t\tconst normalized = accessorDef.normalized === true;\n\t\t\tlet array, bufferAttribute;\n\n\t\t\t// The buffer is not interleaved if the stride is the item size in bytes.\n\t\t\tif ( byteStride && byteStride !== itemBytes ) {\n\n\t\t\t\t// Each \"slice\" of the buffer, as defined by 'count' elements of 'byteStride' bytes, gets its own InterleavedBuffer\n\t\t\t\t// This makes sure that IBA.count reflects accessor.count properly\n\t\t\t\tconst ibSlice = Math.floor( byteOffset / byteStride );\n\t\t\t\tconst ibCacheKey = 'InterleavedBuffer:' + accessorDef.bufferView + ':' + accessorDef.componentType + ':' + ibSlice + ':' + accessorDef.count;\n\t\t\t\tlet ib = parser.cache.get( ibCacheKey );\n\n\t\t\t\tif ( ! ib ) {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, ibSlice * byteStride, accessorDef.count * byteStride / elementBytes );\n\n\t\t\t\t\t// Integer parameters to IB/IBA are in array elements, not bytes.\n\t\t\t\t\tib = new InterleavedBuffer( array, byteStride / elementBytes );\n\n\t\t\t\t\tparser.cache.add( ibCacheKey, ib );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new InterleavedBufferAttribute( ib, itemSize, ( byteOffset % byteStride ) / elementBytes, normalized );\n\n\t\t\t} else {\n\n\t\t\t\tif ( bufferView === null ) {\n\n\t\t\t\t\tarray = new TypedArray( accessorDef.count * itemSize );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tarray = new TypedArray( bufferView, byteOffset, accessorDef.count * itemSize );\n\n\t\t\t\t}\n\n\t\t\t\tbufferAttribute = new BufferAttribute( array, itemSize, normalized );\n\n\t\t\t}\n\n\t\t\t// https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#sparse-accessors\n\t\t\tif ( accessorDef.sparse !== undefined ) {\n\n\t\t\t\tconst itemSizeIndices = WEBGL_TYPE_SIZES.SCALAR;\n\t\t\t\tconst TypedArrayIndices = WEBGL_COMPONENT_TYPES[ accessorDef.sparse.indices.componentType ];\n\n\t\t\t\tconst byteOffsetIndices = accessorDef.sparse.indices.byteOffset || 0;\n\t\t\t\tconst byteOffsetValues = accessorDef.sparse.values.byteOffset || 0;\n\n\t\t\t\tconst sparseIndices = new TypedArrayIndices( bufferViews[ 1 ], byteOffsetIndices, accessorDef.sparse.count * itemSizeIndices );\n\t\t\t\tconst sparseValues = new TypedArray( bufferViews[ 2 ], byteOffsetValues, accessorDef.sparse.count * itemSize );\n\n\t\t\t\tif ( bufferView !== null ) {\n\n\t\t\t\t\t// Avoid modifying the original ArrayBuffer, if the bufferView wasn't initialized with zeroes.\n\t\t\t\t\tbufferAttribute = new BufferAttribute( bufferAttribute.array.slice(), bufferAttribute.itemSize, bufferAttribute.normalized );\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let i = 0, il = sparseIndices.length; i < il; i ++ ) {\n\n\t\t\t\t\tconst index = sparseIndices[ i ];\n\n\t\t\t\t\tbufferAttribute.setX( index, sparseValues[ i * itemSize ] );\n\t\t\t\t\tif ( itemSize >= 2 ) bufferAttribute.setY( index, sparseValues[ i * itemSize + 1 ] );\n\t\t\t\t\tif ( itemSize >= 3 ) bufferAttribute.setZ( index, sparseValues[ i * itemSize + 2 ] );\n\t\t\t\t\tif ( itemSize >= 4 ) bufferAttribute.setW( index, sparseValues[ i * itemSize + 3 ] );\n\t\t\t\t\tif ( itemSize >= 5 ) throw new Error( 'THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\treturn bufferAttribute;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#textures\n\t * @param {number} textureIndex\n\t * @return {Promise<THREE.Texture>}\n\t */\n\tloadTexture( textureIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\t\tconst textureDef = json.textures[ textureIndex ];\n\t\tconst source = json.images[ textureDef.source ];\n\n\t\tlet loader = this.textureLoader;\n\n\t\tif ( source.uri ) {\n\n\t\t\tconst handler = options.manager.getHandler( source.uri );\n\t\t\tif ( handler !== null ) loader = handler;\n\n\t\t}\n\n\t\treturn this.loadTextureImage( textureIndex, source, loader );\n\n\t}\n\n\tloadTextureImage( textureIndex, source, loader ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst options = this.options;\n\n\t\tconst textureDef = json.textures[ textureIndex ];\n\n\t\tconst cacheKey = ( source.uri || source.bufferView ) + ':' + textureDef.sampler;\n\n\t\tif ( this.textureCache[ cacheKey ] ) {\n\n\t\t\t// See https://github.com/mrdoob/three.js/issues/21559.\n\t\t\treturn this.textureCache[ cacheKey ];\n\n\t\t}\n\t\tconst URL = window.self.URL || window.self.webkitURL;\n\n\t\tlet sourceURI = source.uri || '';\n\t\tlet isObjectURL = false;\n\n\t\tif ( source.bufferView !== undefined ) {\n\n\t\t\t// Load binary image data from bufferView, if provided.\n\n\t\t\tsourceURI = parser.getDependency( 'bufferView', source.bufferView ).then( function ( bufferView ) {\n\n\t\t\t\tisObjectURL = true;\n\t\t\t\tconst blob = new Blob( [ bufferView ], { type: source.mimeType } );\n\t\t\t\tsourceURI = URL.createObjectURL( blob );\n\t\t\t\treturn sourceURI;\n\n\t\t\t} );\n\n\t\t} else if ( source.uri === undefined ) {\n\n\t\t\tthrow new Error( 'THREE.GLTFLoader: Image ' + textureIndex + ' is missing URI and bufferView' );\n\n\t\t}\n\n\t\tconst promise = Promise.resolve( sourceURI ).then( function ( sourceURI ) {\n\n\t\t\treturn new Promise( function ( resolve, reject ) {\n\n\t\t\t\tlet onLoad = resolve;\n\n\t\t\t\tif ( loader.isImageBitmapLoader === true ) {\n\n\t\t\t\t\tonLoad = function ( imageBitmap ) {\n\n\t\t\t\t\t\tconst texture = new Texture( imageBitmap );\n\t\t\t\t\t\ttexture.needsUpdate = true;\n\n\t\t\t\t\t\tresolve( texture );\n\n\t\t\t\t\t};\n\n\t\t\t\t}\n\n\t\t\t\tloader.load( LoaderUtils.resolveURL( sourceURI, options.path ), onLoad, undefined, reject );\n\n\t\t\t} );\n\n\t\t} ).then( function ( texture ) {\n\n\t\t\t// Clean up resources and configure Texture.\n\n\t\t\tif ( isObjectURL === true ) {\n\n\t\t\t\tURL.revokeObjectURL( sourceURI );\n\n\t\t\t}\n\n\t\t\ttexture.flipY = false;\n\n\t\t\tif ( textureDef.name ) texture.name = textureDef.name;\n\n\t\t\tconst samplers = json.samplers || {};\n\t\t\tconst sampler = samplers[ textureDef.sampler ] || {};\n\n\t\t\ttexture.magFilter = WEBGL_FILTERS[ sampler.magFilter ] || LinearFilter;\n\t\t\ttexture.minFilter = WEBGL_FILTERS[ sampler.minFilter ] || LinearMipmapLinearFilter;\n\t\t\ttexture.wrapS = WEBGL_WRAPPINGS[ sampler.wrapS ] || RepeatWrapping;\n\t\t\ttexture.wrapT = WEBGL_WRAPPINGS[ sampler.wrapT ] || RepeatWrapping;\n\n\t\t\tparser.associations.set( texture, { textures: textureIndex } );\n\n\t\t\treturn texture;\n\n\t\t} ).catch( function () {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader: Couldn\\'t load texture', sourceURI );\n\t\t\treturn null;\n\n\t\t} );\n\n\t\tthis.textureCache[ cacheKey ] = promise;\n\n\t\treturn promise;\n\n\t}\n\n\t/**\n\t * Asynchronously assigns a texture to the given material parameters.\n\t * @param {Object} materialParams\n\t * @param {string} mapName\n\t * @param {Object} mapDef\n\t * @return {Promise<Texture>}\n\t */\n\tassignTexture( materialParams, mapName, mapDef ) {\n\n\t\tconst parser = this;\n\n\t\treturn this.getDependency( 'texture', mapDef.index ).then( function ( texture ) {\n\n\t\t\t// Materials sample aoMap from UV set 1 and other maps from UV set 0 - this can't be configured\n\t\t\t// However, we will copy UV set 0 to UV set 1 on demand for aoMap\n\t\t\tif ( mapDef.texCoord !== undefined && mapDef.texCoord != 0 && ! ( mapName === 'aoMap' && mapDef.texCoord == 1 ) ) {\n\n\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Custom UV set ' + mapDef.texCoord + ' for texture ' + mapName + ' not yet supported.' );\n\n\t\t\t}\n\n\t\t\tif ( parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] ) {\n\n\t\t\t\tconst transform = mapDef.extensions !== undefined ? mapDef.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ] : undefined;\n\n\t\t\t\tif ( transform ) {\n\n\t\t\t\t\tconst gltfReference = parser.associations.get( texture );\n\t\t\t\t\ttexture = parser.extensions[ EXTENSIONS.KHR_TEXTURE_TRANSFORM ].extendTexture( texture, transform );\n\t\t\t\t\tparser.associations.set( texture, gltfReference );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tmaterialParams[ mapName ] = texture;\n\n\t\t\treturn texture;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Assigns final material to a Mesh, Line, or Points instance. The instance\n\t * already has a material (generated from the glTF material options alone)\n\t * but reuse of the same glTF material may require multiple threejs materials\n\t * to accommodate different primitive types, defines, etc. New materials will\n\t * be created if necessary, and reused from a cache.\n\t * @param  {Object3D} mesh Mesh, Line, or Points instance.\n\t */\n\tassignFinalMaterial( mesh ) {\n\n\t\tconst geometry = mesh.geometry;\n\t\tlet material = mesh.material;\n\n\t\tconst useDerivativeTangents = geometry.attributes.tangent === undefined;\n\t\tconst useVertexColors = geometry.attributes.color !== undefined;\n\t\tconst useFlatShading = geometry.attributes.normal === undefined;\n\n\t\tif ( mesh.isPoints ) {\n\n\t\t\tconst cacheKey = 'PointsMaterial:' + material.uuid;\n\n\t\t\tlet pointsMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! pointsMaterial ) {\n\n\t\t\t\tpointsMaterial = new PointsMaterial();\n\t\t\t\tMaterial.prototype.copy.call( pointsMaterial, material );\n\t\t\t\tpointsMaterial.color.copy( material.color );\n\t\t\t\tpointsMaterial.map = material.map;\n\t\t\t\tpointsMaterial.sizeAttenuation = false; // glTF spec says points should be 1px\n\n\t\t\t\tthis.cache.add( cacheKey, pointsMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = pointsMaterial;\n\n\t\t} else if ( mesh.isLine ) {\n\n\t\t\tconst cacheKey = 'LineBasicMaterial:' + material.uuid;\n\n\t\t\tlet lineMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! lineMaterial ) {\n\n\t\t\t\tlineMaterial = new LineBasicMaterial();\n\t\t\t\tMaterial.prototype.copy.call( lineMaterial, material );\n\t\t\t\tlineMaterial.color.copy( material.color );\n\n\t\t\t\tthis.cache.add( cacheKey, lineMaterial );\n\n\t\t\t}\n\n\t\t\tmaterial = lineMaterial;\n\n\t\t}\n\n\t\t// Clone the material if it will be modified\n\t\tif ( useDerivativeTangents || useVertexColors || useFlatShading ) {\n\n\t\t\tlet cacheKey = 'ClonedMaterial:' + material.uuid + ':';\n\n\t\t\tif ( material.isGLTFSpecularGlossinessMaterial ) cacheKey += 'specular-glossiness:';\n\t\t\tif ( useDerivativeTangents ) cacheKey += 'derivative-tangents:';\n\t\t\tif ( useVertexColors ) cacheKey += 'vertex-colors:';\n\t\t\tif ( useFlatShading ) cacheKey += 'flat-shading:';\n\n\t\t\tlet cachedMaterial = this.cache.get( cacheKey );\n\n\t\t\tif ( ! cachedMaterial ) {\n\n\t\t\t\tcachedMaterial = material.clone();\n\n\t\t\t\tif ( useVertexColors ) cachedMaterial.vertexColors = true;\n\t\t\t\tif ( useFlatShading ) cachedMaterial.flatShading = true;\n\n\t\t\t\tif ( useDerivativeTangents ) {\n\n\t\t\t\t\t// https://github.com/mrdoob/three.js/issues/11438#issuecomment-507003995\n\t\t\t\t\tif ( cachedMaterial.normalScale ) cachedMaterial.normalScale.y *= - 1;\n\t\t\t\t\tif ( cachedMaterial.clearcoatNormalScale ) cachedMaterial.clearcoatNormalScale.y *= - 1;\n\n\t\t\t\t}\n\n\t\t\t\tthis.cache.add( cacheKey, cachedMaterial );\n\n\t\t\t\tthis.associations.set( cachedMaterial, this.associations.get( material ) );\n\n\t\t\t}\n\n\t\t\tmaterial = cachedMaterial;\n\n\t\t}\n\n\t\t// workarounds for mesh and geometry\n\n\t\tif ( material.aoMap && geometry.attributes.uv2 === undefined && geometry.attributes.uv !== undefined ) {\n\n\t\t\tgeometry.setAttribute( 'uv2', geometry.attributes.uv );\n\n\t\t}\n\n\t\tmesh.material = material;\n\n\t}\n\n\tgetMaterialType( /* materialIndex */ ) {\n\n\t\treturn MeshStandardMaterial;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#materials\n\t * @param {number} materialIndex\n\t * @return {Promise<Material>}\n\t */\n\tloadMaterial( materialIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst materialDef = json.materials[ materialIndex ];\n\n\t\tlet materialType;\n\t\tconst materialParams = {};\n\t\tconst materialExtensions = materialDef.extensions || {};\n\n\t\tconst pending = [];\n\n\t\tif ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ] ) {\n\n\t\t\tconst sgExtension = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ];\n\t\t\tmaterialType = sgExtension.getMaterialType();\n\t\t\tpending.push( sgExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else if ( materialExtensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ] ) {\n\n\t\t\tconst kmuExtension = extensions[ EXTENSIONS.KHR_MATERIALS_UNLIT ];\n\t\t\tmaterialType = kmuExtension.getMaterialType();\n\t\t\tpending.push( kmuExtension.extendParams( materialParams, materialDef, parser ) );\n\n\t\t} else {\n\n\t\t\t// Specification:\n\t\t\t// https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#metallic-roughness-material\n\n\t\t\tconst metallicRoughness = materialDef.pbrMetallicRoughness || {};\n\n\t\t\tmaterialParams.color = new Color( 1.0, 1.0, 1.0 );\n\t\t\tmaterialParams.opacity = 1.0;\n\n\t\t\tif ( Array.isArray( metallicRoughness.baseColorFactor ) ) {\n\n\t\t\t\tconst array = metallicRoughness.baseColorFactor;\n\n\t\t\t\tmaterialParams.color.fromArray( array );\n\t\t\t\tmaterialParams.opacity = array[ 3 ];\n\n\t\t\t}\n\n\t\t\tif ( metallicRoughness.baseColorTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'map', metallicRoughness.baseColorTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialParams.metalness = metallicRoughness.metallicFactor !== undefined ? metallicRoughness.metallicFactor : 1.0;\n\t\t\tmaterialParams.roughness = metallicRoughness.roughnessFactor !== undefined ? metallicRoughness.roughnessFactor : 1.0;\n\n\t\t\tif ( metallicRoughness.metallicRoughnessTexture !== undefined ) {\n\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'metalnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\t\t\t\tpending.push( parser.assignTexture( materialParams, 'roughnessMap', metallicRoughness.metallicRoughnessTexture ) );\n\n\t\t\t}\n\n\t\t\tmaterialType = this._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.getMaterialType && ext.getMaterialType( materialIndex );\n\n\t\t\t} );\n\n\t\t\tpending.push( Promise.all( this._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.extendMaterialParams && ext.extendMaterialParams( materialIndex, materialParams );\n\n\t\t\t} ) ) );\n\n\t\t}\n\n\t\tif ( materialDef.doubleSided === true ) {\n\n\t\t\tmaterialParams.side = DoubleSide;\n\n\t\t}\n\n\t\tconst alphaMode = materialDef.alphaMode || ALPHA_MODES.OPAQUE;\n\n\t\tif ( alphaMode === ALPHA_MODES.BLEND ) {\n\n\t\t\tmaterialParams.transparent = true;\n\n\t\t\t// See: https://github.com/mrdoob/three.js/issues/17706\n\t\t\tmaterialParams.depthWrite = false;\n\n\t\t} else {\n\n\t\t\tmaterialParams.transparent = false;\n\n\t\t\tif ( alphaMode === ALPHA_MODES.MASK ) {\n\n\t\t\t\tmaterialParams.alphaTest = materialDef.alphaCutoff !== undefined ? materialDef.alphaCutoff : 0.5;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.normalTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'normalMap', materialDef.normalTexture ) );\n\n\t\t\tmaterialParams.normalScale = new Vector2( 1, 1 );\n\n\t\t\tif ( materialDef.normalTexture.scale !== undefined ) {\n\n\t\t\t\tconst scale = materialDef.normalTexture.scale;\n\n\t\t\t\tmaterialParams.normalScale.set( scale, scale );\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.occlusionTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'aoMap', materialDef.occlusionTexture ) );\n\n\t\t\tif ( materialDef.occlusionTexture.strength !== undefined ) {\n\n\t\t\t\tmaterialParams.aoMapIntensity = materialDef.occlusionTexture.strength;\n\n\t\t\t}\n\n\t\t}\n\n\t\tif ( materialDef.emissiveFactor !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tmaterialParams.emissive = new Color().fromArray( materialDef.emissiveFactor );\n\n\t\t}\n\n\t\tif ( materialDef.emissiveTexture !== undefined && materialType !== MeshBasicMaterial ) {\n\n\t\t\tpending.push( parser.assignTexture( materialParams, 'emissiveMap', materialDef.emissiveTexture ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\tlet material;\n\n\t\t\tif ( materialType === GLTFMeshStandardSGMaterial ) {\n\n\t\t\t\tmaterial = extensions[ EXTENSIONS.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS ].createMaterial( materialParams );\n\n\t\t\t} else {\n\n\t\t\t\tmaterial = new materialType( materialParams );\n\n\t\t\t}\n\n\t\t\tif ( materialDef.name ) material.name = materialDef.name;\n\n\t\t\t// baseColorTexture, emissiveTexture, and specularGlossinessTexture use sRGB encoding.\n\t\t\tif ( material.map ) material.map.encoding = sRGBEncoding;\n\t\t\tif ( material.emissiveMap ) material.emissiveMap.encoding = sRGBEncoding;\n\n\t\t\tassignExtrasToUserData( material, materialDef );\n\n\t\t\tparser.associations.set( material, { materials: materialIndex } );\n\n\t\t\tif ( materialDef.extensions ) addUnknownExtensionsToUserData( extensions, material, materialDef );\n\n\t\t\treturn material;\n\n\t\t} );\n\n\t}\n\n\t/** When Object3D instances are targeted by animation, they need unique names. */\n\tcreateUniqueName( originalName ) {\n\n\t\tconst sanitizedName = PropertyBinding.sanitizeNodeName( originalName || '' );\n\n\t\tlet name = sanitizedName;\n\n\t\tfor ( let i = 1; this.nodeNamesUsed[ name ]; ++ i ) {\n\n\t\t\tname = sanitizedName + '_' + i;\n\n\t\t}\n\n\t\tthis.nodeNamesUsed[ name ] = true;\n\n\t\treturn name;\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#geometry\n\t *\n\t * Creates BufferGeometries from primitives.\n\t *\n\t * @param {Array<GLTF.Primitive>} primitives\n\t * @return {Promise<Array<BufferGeometry>>}\n\t */\n\tloadGeometries( primitives ) {\n\n\t\tconst parser = this;\n\t\tconst extensions = this.extensions;\n\t\tconst cache = this.primitiveCache;\n\n\t\tfunction createDracoPrimitive( primitive ) {\n\n\t\t\treturn extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ]\n\t\t\t\t.decodePrimitive( primitive, parser )\n\t\t\t\t.then( function ( geometry ) {\n\n\t\t\t\t\treturn addPrimitiveAttributes( geometry, primitive, parser );\n\n\t\t\t\t} );\n\n\t\t}\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst primitive = primitives[ i ];\n\t\t\tconst cacheKey = createPrimitiveKey( primitive );\n\n\t\t\t// See if we've already created this geometry\n\t\t\tconst cached = cache[ cacheKey ];\n\n\t\t\tif ( cached ) {\n\n\t\t\t\t// Use the cached geometry if it exists\n\t\t\t\tpending.push( cached.promise );\n\n\t\t\t} else {\n\n\t\t\t\tlet geometryPromise;\n\n\t\t\t\tif ( primitive.extensions && primitive.extensions[ EXTENSIONS.KHR_DRACO_MESH_COMPRESSION ] ) {\n\n\t\t\t\t\t// Use DRACO geometry if available\n\t\t\t\t\tgeometryPromise = createDracoPrimitive( primitive );\n\n\t\t\t\t} else {\n\n\t\t\t\t\t// Otherwise create a new geometry\n\t\t\t\t\tgeometryPromise = addPrimitiveAttributes( new BufferGeometry(), primitive, parser );\n\n\t\t\t\t}\n\n\t\t\t\t// Cache this geometry\n\t\t\t\tcache[ cacheKey ] = { primitive: primitive, promise: geometryPromise };\n\n\t\t\t\tpending.push( geometryPromise );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/blob/master/specification/2.0/README.md#meshes\n\t * @param {number} meshIndex\n\t * @return {Promise<Group|Mesh|SkinnedMesh>}\n\t */\n\tloadMesh( meshIndex ) {\n\n\t\tconst parser = this;\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\n\t\tconst meshDef = json.meshes[ meshIndex ];\n\t\tconst primitives = meshDef.primitives;\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = primitives.length; i < il; i ++ ) {\n\n\t\t\tconst material = primitives[ i ].material === undefined\n\t\t\t\t? createDefaultMaterial( this.cache )\n\t\t\t\t: this.getDependency( 'material', primitives[ i ].material );\n\n\t\t\tpending.push( material );\n\n\t\t}\n\n\t\tpending.push( parser.loadGeometries( primitives ) );\n\n\t\treturn Promise.all( pending ).then( function ( results ) {\n\n\t\t\tconst materials = results.slice( 0, results.length - 1 );\n\t\t\tconst geometries = results[ results.length - 1 ];\n\n\t\t\tconst meshes = [];\n\n\t\t\tfor ( let i = 0, il = geometries.length; i < il; i ++ ) {\n\n\t\t\t\tconst geometry = geometries[ i ];\n\t\t\t\tconst primitive = primitives[ i ];\n\n\t\t\t\t// 1. create Mesh\n\n\t\t\t\tlet mesh;\n\n\t\t\t\tconst material = materials[ i ];\n\n\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLES ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ||\n\t\t\t\t\t\tprimitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ||\n\t\t\t\t\t\tprimitive.mode === undefined ) {\n\n\t\t\t\t\t// .isSkinnedMesh isn't in glTF spec. See ._markDefs()\n\t\t\t\t\tmesh = meshDef.isSkinnedMesh === true\n\t\t\t\t\t\t? new SkinnedMesh( geometry, material )\n\t\t\t\t\t\t: new Mesh( geometry, material );\n\n\t\t\t\t\tif ( mesh.isSkinnedMesh === true && ! mesh.geometry.attributes.skinWeight.normalized ) {\n\n\t\t\t\t\t\t// we normalize floating point skin weight array to fix malformed assets (see #15319)\n\t\t\t\t\t\t// it's important to skip this for non-float32 data since normalizeSkinWeights assumes non-normalized inputs\n\t\t\t\t\t\tmesh.normalizeSkinWeights();\n\n\t\t\t\t\t}\n\n\t\t\t\t\tif ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_STRIP ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleStripDrawMode );\n\n\t\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.TRIANGLE_FAN ) {\n\n\t\t\t\t\t\tmesh.geometry = toTrianglesDrawMode( mesh.geometry, TriangleFanDrawMode );\n\n\t\t\t\t\t}\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINES ) {\n\n\t\t\t\t\tmesh = new LineSegments( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_STRIP ) {\n\n\t\t\t\t\tmesh = new Line( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.LINE_LOOP ) {\n\n\t\t\t\t\tmesh = new LineLoop( geometry, material );\n\n\t\t\t\t} else if ( primitive.mode === WEBGL_CONSTANTS.POINTS ) {\n\n\t\t\t\t\tmesh = new Points( geometry, material );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tthrow new Error( 'THREE.GLTFLoader: Primitive mode unsupported: ' + primitive.mode );\n\n\t\t\t\t}\n\n\t\t\t\tif ( Object.keys( mesh.geometry.morphAttributes ).length > 0 ) {\n\n\t\t\t\t\tupdateMorphTargets( mesh, meshDef );\n\n\t\t\t\t}\n\n\t\t\t\tmesh.name = parser.createUniqueName( meshDef.name || ( 'mesh_' + meshIndex ) );\n\n\t\t\t\tassignExtrasToUserData( mesh, meshDef );\n\n\t\t\t\tif ( primitive.extensions ) addUnknownExtensionsToUserData( extensions, mesh, primitive );\n\n\t\t\t\tparser.assignFinalMaterial( mesh );\n\n\t\t\t\tmeshes.push( mesh );\n\n\t\t\t}\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tparser.associations.set( meshes[ i ], {\n\t\t\t\t\tmeshes: meshIndex,\n\t\t\t\t\tprimitives: i\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\tif ( meshes.length === 1 ) {\n\n\t\t\t\treturn meshes[ 0 ];\n\n\t\t\t}\n\n\t\t\tconst group = new Group();\n\n\t\t\tparser.associations.set( group, { meshes: meshIndex } );\n\n\t\t\tfor ( let i = 0, il = meshes.length; i < il; i ++ ) {\n\n\t\t\t\tgroup.add( meshes[ i ] );\n\n\t\t\t}\n\n\t\t\treturn group;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#cameras\n\t * @param {number} cameraIndex\n\t * @return {Promise<THREE.Camera>}\n\t */\n\tloadCamera( cameraIndex ) {\n\n\t\tlet camera;\n\t\tconst cameraDef = this.json.cameras[ cameraIndex ];\n\t\tconst params = cameraDef[ cameraDef.type ];\n\n\t\tif ( ! params ) {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing camera parameters.' );\n\t\t\treturn;\n\n\t\t}\n\n\t\tif ( cameraDef.type === 'perspective' ) {\n\n\t\t\tcamera = new PerspectiveCamera( MathUtils.radToDeg( params.yfov ), params.aspectRatio || 1, params.znear || 1, params.zfar || 2e6 );\n\n\t\t} else if ( cameraDef.type === 'orthographic' ) {\n\n\t\t\tcamera = new OrthographicCamera( - params.xmag, params.xmag, params.ymag, - params.ymag, params.znear, params.zfar );\n\n\t\t}\n\n\t\tif ( cameraDef.name ) camera.name = this.createUniqueName( cameraDef.name );\n\n\t\tassignExtrasToUserData( camera, cameraDef );\n\n\t\treturn Promise.resolve( camera );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#skins\n\t * @param {number} skinIndex\n\t * @return {Promise<Object>}\n\t */\n\tloadSkin( skinIndex ) {\n\n\t\tconst skinDef = this.json.skins[ skinIndex ];\n\n\t\tconst skinEntry = { joints: skinDef.joints };\n\n\t\tif ( skinDef.inverseBindMatrices === undefined ) {\n\n\t\t\treturn Promise.resolve( skinEntry );\n\n\t\t}\n\n\t\treturn this.getDependency( 'accessor', skinDef.inverseBindMatrices ).then( function ( accessor ) {\n\n\t\t\tskinEntry.inverseBindMatrices = accessor;\n\n\t\t\treturn skinEntry;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#animations\n\t * @param {number} animationIndex\n\t * @return {Promise<AnimationClip>}\n\t */\n\tloadAnimation( animationIndex ) {\n\n\t\tconst json = this.json;\n\n\t\tconst animationDef = json.animations[ animationIndex ];\n\n\t\tconst pendingNodes = [];\n\t\tconst pendingInputAccessors = [];\n\t\tconst pendingOutputAccessors = [];\n\t\tconst pendingSamplers = [];\n\t\tconst pendingTargets = [];\n\n\t\tfor ( let i = 0, il = animationDef.channels.length; i < il; i ++ ) {\n\n\t\t\tconst channel = animationDef.channels[ i ];\n\t\t\tconst sampler = animationDef.samplers[ channel.sampler ];\n\t\t\tconst target = channel.target;\n\t\t\tconst name = target.node !== undefined ? target.node : target.id; // NOTE: target.id is deprecated.\n\t\t\tconst input = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.input ] : sampler.input;\n\t\t\tconst output = animationDef.parameters !== undefined ? animationDef.parameters[ sampler.output ] : sampler.output;\n\n\t\t\tpendingNodes.push( this.getDependency( 'node', name ) );\n\t\t\tpendingInputAccessors.push( this.getDependency( 'accessor', input ) );\n\t\t\tpendingOutputAccessors.push( this.getDependency( 'accessor', output ) );\n\t\t\tpendingSamplers.push( sampler );\n\t\t\tpendingTargets.push( target );\n\n\t\t}\n\n\t\treturn Promise.all( [\n\n\t\t\tPromise.all( pendingNodes ),\n\t\t\tPromise.all( pendingInputAccessors ),\n\t\t\tPromise.all( pendingOutputAccessors ),\n\t\t\tPromise.all( pendingSamplers ),\n\t\t\tPromise.all( pendingTargets )\n\n\t\t] ).then( function ( dependencies ) {\n\n\t\t\tconst nodes = dependencies[ 0 ];\n\t\t\tconst inputAccessors = dependencies[ 1 ];\n\t\t\tconst outputAccessors = dependencies[ 2 ];\n\t\t\tconst samplers = dependencies[ 3 ];\n\t\t\tconst targets = dependencies[ 4 ];\n\n\t\t\tconst tracks = [];\n\n\t\t\tfor ( let i = 0, il = nodes.length; i < il; i ++ ) {\n\n\t\t\t\tconst node = nodes[ i ];\n\t\t\t\tconst inputAccessor = inputAccessors[ i ];\n\t\t\t\tconst outputAccessor = outputAccessors[ i ];\n\t\t\t\tconst sampler = samplers[ i ];\n\t\t\t\tconst target = targets[ i ];\n\n\t\t\t\tif ( node === undefined ) continue;\n\n\t\t\t\tnode.updateMatrix();\n\t\t\t\tnode.matrixAutoUpdate = true;\n\n\t\t\t\tlet TypedKeyframeTrack;\n\n\t\t\t\tswitch ( PATH_PROPERTIES[ target.path ] ) {\n\n\t\t\t\t\tcase PATH_PROPERTIES.weights:\n\n\t\t\t\t\t\tTypedKeyframeTrack = NumberKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.rotation:\n\n\t\t\t\t\t\tTypedKeyframeTrack = QuaternionKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase PATH_PROPERTIES.position:\n\t\t\t\t\tcase PATH_PROPERTIES.scale:\n\t\t\t\t\tdefault:\n\n\t\t\t\t\t\tTypedKeyframeTrack = VectorKeyframeTrack;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t}\n\n\t\t\t\tconst targetName = node.name ? node.name : node.uuid;\n\n\t\t\t\tconst interpolation = sampler.interpolation !== undefined ? INTERPOLATION[ sampler.interpolation ] : InterpolateLinear;\n\n\t\t\t\tconst targetNames = [];\n\n\t\t\t\tif ( PATH_PROPERTIES[ target.path ] === PATH_PROPERTIES.weights ) {\n\n\t\t\t\t\tnode.traverse( function ( object ) {\n\n\t\t\t\t\t\tif ( object.morphTargetInfluences ) {\n\n\t\t\t\t\t\t\ttargetNames.push( object.name ? object.name : object.uuid );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t} );\n\n\t\t\t\t} else {\n\n\t\t\t\t\ttargetNames.push( targetName );\n\n\t\t\t\t}\n\n\t\t\t\tlet outputArray = outputAccessor.array;\n\n\t\t\t\tif ( outputAccessor.normalized ) {\n\n\t\t\t\t\tconst scale = getNormalizedComponentScale( outputArray.constructor );\n\t\t\t\t\tconst scaled = new Float32Array( outputArray.length );\n\n\t\t\t\t\tfor ( let j = 0, jl = outputArray.length; j < jl; j ++ ) {\n\n\t\t\t\t\t\tscaled[ j ] = outputArray[ j ] * scale;\n\n\t\t\t\t\t}\n\n\t\t\t\t\toutputArray = scaled;\n\n\t\t\t\t}\n\n\t\t\t\tfor ( let j = 0, jl = targetNames.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst track = new TypedKeyframeTrack(\n\t\t\t\t\t\ttargetNames[ j ] + '.' + PATH_PROPERTIES[ target.path ],\n\t\t\t\t\t\tinputAccessor.array,\n\t\t\t\t\t\toutputArray,\n\t\t\t\t\t\tinterpolation\n\t\t\t\t\t);\n\n\t\t\t\t\t// Override interpolation with custom factory method.\n\t\t\t\t\tif ( sampler.interpolation === 'CUBICSPLINE' ) {\n\n\t\t\t\t\t\ttrack.createInterpolant = function InterpolantFactoryMethodGLTFCubicSpline( result ) {\n\n\t\t\t\t\t\t\t// A CUBICSPLINE keyframe in glTF has three output values for each input value,\n\t\t\t\t\t\t\t// representing inTangent, splineVertex, and outTangent. As a result, track.getValueSize()\n\t\t\t\t\t\t\t// must be divided by three to get the interpolant's sampleSize argument.\n\n\t\t\t\t\t\t\tconst interpolantType = ( this instanceof QuaternionKeyframeTrack ) ? GLTFCubicSplineQuaternionInterpolant : GLTFCubicSplineInterpolant;\n\n\t\t\t\t\t\t\treturn new interpolantType( this.times, this.values, this.getValueSize() / 3, result );\n\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\t// Mark as CUBICSPLINE. `track.getInterpolation()` doesn't support custom interpolants.\n\t\t\t\t\t\ttrack.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline = true;\n\n\t\t\t\t\t}\n\n\t\t\t\t\ttracks.push( track );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tconst name = animationDef.name ? animationDef.name : 'animation_' + animationIndex;\n\n\t\t\treturn new AnimationClip( name, undefined, tracks );\n\n\t\t} );\n\n\t}\n\n\tcreateNodeMesh( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst parser = this;\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\tif ( nodeDef.mesh === undefined ) return null;\n\n\t\treturn parser.getDependency( 'mesh', nodeDef.mesh ).then( function ( mesh ) {\n\n\t\t\tconst node = parser._getNodeRef( parser.meshCache, nodeDef.mesh, mesh );\n\n\t\t\t// if weights are provided on the node, override weights on the mesh.\n\t\t\tif ( nodeDef.weights !== undefined ) {\n\n\t\t\t\tnode.traverse( function ( o ) {\n\n\t\t\t\t\tif ( ! o.isMesh ) return;\n\n\t\t\t\t\tfor ( let i = 0, il = nodeDef.weights.length; i < il; i ++ ) {\n\n\t\t\t\t\t\to.morphTargetInfluences[ i ] = nodeDef.weights[ i ];\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t}\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#nodes-and-hierarchy\n\t * @param {number} nodeIndex\n\t * @return {Promise<Object3D>}\n\t */\n\tloadNode( nodeIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst parser = this;\n\n\t\tconst nodeDef = json.nodes[ nodeIndex ];\n\n\t\t// reserve node's name before its dependencies, so the root has the intended name.\n\t\tconst nodeName = nodeDef.name ? parser.createUniqueName( nodeDef.name ) : '';\n\n\t\treturn ( function () {\n\n\t\t\tconst pending = [];\n\n\t\t\tconst meshPromise = parser._invokeOne( function ( ext ) {\n\n\t\t\t\treturn ext.createNodeMesh && ext.createNodeMesh( nodeIndex );\n\n\t\t\t} );\n\n\t\t\tif ( meshPromise ) {\n\n\t\t\t\tpending.push( meshPromise );\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.camera !== undefined ) {\n\n\t\t\t\tpending.push( parser.getDependency( 'camera', nodeDef.camera ).then( function ( camera ) {\n\n\t\t\t\t\treturn parser._getNodeRef( parser.cameraCache, nodeDef.camera, camera );\n\n\t\t\t\t} ) );\n\n\t\t\t}\n\n\t\t\tparser._invokeAll( function ( ext ) {\n\n\t\t\t\treturn ext.createNodeAttachment && ext.createNodeAttachment( nodeIndex );\n\n\t\t\t} ).forEach( function ( promise ) {\n\n\t\t\t\tpending.push( promise );\n\n\t\t\t} );\n\n\t\t\treturn Promise.all( pending );\n\n\t\t}() ).then( function ( objects ) {\n\n\t\t\tlet node;\n\n\t\t\t// .isBone isn't in glTF spec. See ._markDefs\n\t\t\tif ( nodeDef.isBone === true ) {\n\n\t\t\t\tnode = new Bone();\n\n\t\t\t} else if ( objects.length > 1 ) {\n\n\t\t\t\tnode = new Group();\n\n\t\t\t} else if ( objects.length === 1 ) {\n\n\t\t\t\tnode = objects[ 0 ];\n\n\t\t\t} else {\n\n\t\t\t\tnode = new Object3D();\n\n\t\t\t}\n\n\t\t\tif ( node !== objects[ 0 ] ) {\n\n\t\t\t\tfor ( let i = 0, il = objects.length; i < il; i ++ ) {\n\n\t\t\t\t\tnode.add( objects[ i ] );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( nodeDef.name ) {\n\n\t\t\t\tnode.userData.name = nodeDef.name;\n\t\t\t\tnode.name = nodeName;\n\n\t\t\t}\n\n\t\t\tassignExtrasToUserData( node, nodeDef );\n\n\t\t\tif ( nodeDef.extensions ) addUnknownExtensionsToUserData( extensions, node, nodeDef );\n\n\t\t\tif ( nodeDef.matrix !== undefined ) {\n\n\t\t\t\tconst matrix = new Matrix4();\n\t\t\t\tmatrix.fromArray( nodeDef.matrix );\n\t\t\t\tnode.applyMatrix4( matrix );\n\n\t\t\t} else {\n\n\t\t\t\tif ( nodeDef.translation !== undefined ) {\n\n\t\t\t\t\tnode.position.fromArray( nodeDef.translation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.rotation !== undefined ) {\n\n\t\t\t\t\tnode.quaternion.fromArray( nodeDef.rotation );\n\n\t\t\t\t}\n\n\t\t\t\tif ( nodeDef.scale !== undefined ) {\n\n\t\t\t\t\tnode.scale.fromArray( nodeDef.scale );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\tif ( ! parser.associations.has( node ) ) {\n\n\t\t\t\tparser.associations.set( node, {} );\n\n\t\t\t}\n\n\t\t\tparser.associations.get( node ).nodes = nodeIndex;\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t}\n\n\t/**\n\t * Specification: https://github.com/KhronosGroup/glTF/tree/master/specification/2.0#scenes\n\t * @param {number} sceneIndex\n\t * @return {Promise<Group>}\n\t */\n\tloadScene( sceneIndex ) {\n\n\t\tconst json = this.json;\n\t\tconst extensions = this.extensions;\n\t\tconst sceneDef = this.json.scenes[ sceneIndex ];\n\t\tconst parser = this;\n\n\t\t// Loader returns Group, not Scene.\n\t\t// See: https://github.com/mrdoob/three.js/issues/18342#issuecomment-578981172\n\t\tconst scene = new Group();\n\t\tif ( sceneDef.name ) scene.name = parser.createUniqueName( sceneDef.name );\n\n\t\tassignExtrasToUserData( scene, sceneDef );\n\n\t\tif ( sceneDef.extensions ) addUnknownExtensionsToUserData( extensions, scene, sceneDef );\n\n\t\tconst nodeIds = sceneDef.nodes || [];\n\n\t\tconst pending = [];\n\n\t\tfor ( let i = 0, il = nodeIds.length; i < il; i ++ ) {\n\n\t\t\tpending.push( buildNodeHierarchy( nodeIds[ i ], scene, json, parser ) );\n\n\t\t}\n\n\t\treturn Promise.all( pending ).then( function () {\n\n\t\t\t// Removes dangling associations, associations that reference a node that\n\t\t\t// didn't make it into the scene.\n\t\t\tconst reduceAssociations = ( node ) => {\n\n\t\t\t\tconst reducedAssociations = new Map();\n\n\t\t\t\tfor ( const [ key, value ] of parser.associations ) {\n\n\t\t\t\t\tif ( key instanceof Material || key instanceof Texture ) {\n\n\t\t\t\t\t\treducedAssociations.set( key, value );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tnode.traverse( ( node ) => {\n\n\t\t\t\t\tconst mappings = parser.associations.get( node );\n\n\t\t\t\t\tif ( mappings != null ) {\n\n\t\t\t\t\t\treducedAssociations.set( node, mappings );\n\n\t\t\t\t\t}\n\n\t\t\t\t} );\n\n\t\t\t\treturn reducedAssociations;\n\n\t\t\t};\n\n\t\t\tparser.associations = reduceAssociations( scene );\n\n\t\t\treturn scene;\n\n\t\t} );\n\n\t}\n\n}\n\nfunction buildNodeHierarchy( nodeId, parentObject, json, parser ) {\n\n\tconst nodeDef = json.nodes[ nodeId ];\n\n\treturn parser.getDependency( 'node', nodeId ).then( function ( node ) {\n\n\t\tif ( nodeDef.skin === undefined ) return node;\n\n\t\t// build skeleton here as well\n\n\t\tlet skinEntry;\n\n\t\treturn parser.getDependency( 'skin', nodeDef.skin ).then( function ( skin ) {\n\n\t\t\tskinEntry = skin;\n\n\t\t\tconst pendingJoints = [];\n\n\t\t\tfor ( let i = 0, il = skinEntry.joints.length; i < il; i ++ ) {\n\n\t\t\t\tpendingJoints.push( parser.getDependency( 'node', skinEntry.joints[ i ] ) );\n\n\t\t\t}\n\n\t\t\treturn Promise.all( pendingJoints );\n\n\t\t} ).then( function ( jointNodes ) {\n\n\t\t\tnode.traverse( function ( mesh ) {\n\n\t\t\t\tif ( ! mesh.isMesh ) return;\n\n\t\t\t\tconst bones = [];\n\t\t\t\tconst boneInverses = [];\n\n\t\t\t\tfor ( let j = 0, jl = jointNodes.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst jointNode = jointNodes[ j ];\n\n\t\t\t\t\tif ( jointNode ) {\n\n\t\t\t\t\t\tbones.push( jointNode );\n\n\t\t\t\t\t\tconst mat = new Matrix4();\n\n\t\t\t\t\t\tif ( skinEntry.inverseBindMatrices !== undefined ) {\n\n\t\t\t\t\t\t\tmat.fromArray( skinEntry.inverseBindMatrices.array, j * 16 );\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tboneInverses.push( mat );\n\n\t\t\t\t\t} else {\n\n\t\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Joint \"%s\" could not be found.', skinEntry.joints[ j ] );\n\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\tmesh.bind( new Skeleton( bones, boneInverses ), mesh.matrixWorld );\n\n\t\t\t} );\n\n\t\t\treturn node;\n\n\t\t} );\n\n\t} ).then( function ( node ) {\n\n\t\t// build node hierachy\n\n\t\tparentObject.add( node );\n\n\t\tconst pending = [];\n\n\t\tif ( nodeDef.children ) {\n\n\t\t\tconst children = nodeDef.children;\n\n\t\t\tfor ( let i = 0, il = children.length; i < il; i ++ ) {\n\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tpending.push( buildNodeHierarchy( child, node, json, parser ) );\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn Promise.all( pending );\n\n\t} );\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n */\nfunction computeBounds( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst box = new Box3();\n\n\tif ( attributes.POSITION !== undefined ) {\n\n\t\tconst accessor = parser.json.accessors[ attributes.POSITION ];\n\n\t\tconst min = accessor.min;\n\t\tconst max = accessor.max;\n\n\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\tbox.set(\n\t\t\t\tnew Vector3( min[ 0 ], min[ 1 ], min[ 2 ] ),\n\t\t\t\tnew Vector3( max[ 0 ], max[ 1 ], max[ 2 ] )\n\t\t\t);\n\n\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\tbox.min.multiplyScalar( boxScale );\n\t\t\t\tbox.max.multiplyScalar( boxScale );\n\n\t\t\t}\n\n\t\t} else {\n\n\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\treturn;\n\n\t\t}\n\n\t} else {\n\n\t\treturn;\n\n\t}\n\n\tconst targets = primitiveDef.targets;\n\n\tif ( targets !== undefined ) {\n\n\t\tconst maxDisplacement = new Vector3();\n\t\tconst vector = new Vector3();\n\n\t\tfor ( let i = 0, il = targets.length; i < il; i ++ ) {\n\n\t\t\tconst target = targets[ i ];\n\n\t\t\tif ( target.POSITION !== undefined ) {\n\n\t\t\t\tconst accessor = parser.json.accessors[ target.POSITION ];\n\t\t\t\tconst min = accessor.min;\n\t\t\t\tconst max = accessor.max;\n\n\t\t\t\t// glTF requires 'min' and 'max', but VRM (which extends glTF) currently ignores that requirement.\n\n\t\t\t\tif ( min !== undefined && max !== undefined ) {\n\n\t\t\t\t\t// we need to get max of absolute components because target weight is [-1,1]\n\t\t\t\t\tvector.setX( Math.max( Math.abs( min[ 0 ] ), Math.abs( max[ 0 ] ) ) );\n\t\t\t\t\tvector.setY( Math.max( Math.abs( min[ 1 ] ), Math.abs( max[ 1 ] ) ) );\n\t\t\t\t\tvector.setZ( Math.max( Math.abs( min[ 2 ] ), Math.abs( max[ 2 ] ) ) );\n\n\n\t\t\t\t\tif ( accessor.normalized ) {\n\n\t\t\t\t\t\tconst boxScale = getNormalizedComponentScale( WEBGL_COMPONENT_TYPES[ accessor.componentType ] );\n\t\t\t\t\t\tvector.multiplyScalar( boxScale );\n\n\t\t\t\t\t}\n\n\t\t\t\t\t// Note: this assumes that the sum of all weights is at most 1. This isn't quite correct - it's more conservative\n\t\t\t\t\t// to assume that each target can have a max weight of 1. However, for some use cases - notably, when morph targets\n\t\t\t\t\t// are used to implement key-frame animations and as such only two are active at a time - this results in very large\n\t\t\t\t\t// boxes. So for now we make a box that's sometimes a touch too small but is hopefully mostly of reasonable size.\n\t\t\t\t\tmaxDisplacement.max( vector );\n\n\t\t\t\t} else {\n\n\t\t\t\t\tconsole.warn( 'THREE.GLTFLoader: Missing min/max properties for accessor POSITION.' );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t}\n\n\t\t// As per comment above this box isn't conservative, but has a reasonable size for a very large number of morph targets.\n\t\tbox.expandByVector( maxDisplacement );\n\n\t}\n\n\tgeometry.boundingBox = box;\n\n\tconst sphere = new Sphere();\n\n\tbox.getCenter( sphere.center );\n\tsphere.radius = box.min.distanceTo( box.max ) / 2;\n\n\tgeometry.boundingSphere = sphere;\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {GLTF.Primitive} primitiveDef\n * @param {GLTFParser} parser\n * @return {Promise<BufferGeometry>}\n */\nfunction addPrimitiveAttributes( geometry, primitiveDef, parser ) {\n\n\tconst attributes = primitiveDef.attributes;\n\n\tconst pending = [];\n\n\tfunction assignAttributeAccessor( accessorIndex, attributeName ) {\n\n\t\treturn parser.getDependency( 'accessor', accessorIndex )\n\t\t\t.then( function ( accessor ) {\n\n\t\t\t\tgeometry.setAttribute( attributeName, accessor );\n\n\t\t\t} );\n\n\t}\n\n\tfor ( const gltfAttributeName in attributes ) {\n\n\t\tconst threeAttributeName = ATTRIBUTES[ gltfAttributeName ] || gltfAttributeName.toLowerCase();\n\n\t\t// Skip attributes already provided by e.g. Draco extension.\n\t\tif ( threeAttributeName in geometry.attributes ) continue;\n\n\t\tpending.push( assignAttributeAccessor( attributes[ gltfAttributeName ], threeAttributeName ) );\n\n\t}\n\n\tif ( primitiveDef.indices !== undefined && ! geometry.index ) {\n\n\t\tconst accessor = parser.getDependency( 'accessor', primitiveDef.indices ).then( function ( accessor ) {\n\n\t\t\tgeometry.setIndex( accessor );\n\n\t\t} );\n\n\t\tpending.push( accessor );\n\n\t}\n\n\tassignExtrasToUserData( geometry, primitiveDef );\n\n\tcomputeBounds( geometry, primitiveDef, parser );\n\n\treturn Promise.all( pending ).then( function () {\n\n\t\treturn primitiveDef.targets !== undefined\n\t\t\t? addMorphTargets( geometry, primitiveDef.targets, parser )\n\t\t\t: geometry;\n\n\t} );\n\n}\n\n/**\n * @param {BufferGeometry} geometry\n * @param {Number} drawMode\n * @return {BufferGeometry}\n */\nfunction toTrianglesDrawMode( geometry, drawMode ) {\n\n\tlet index = geometry.getIndex();\n\n\t// generate index if not present\n\n\tif ( index === null ) {\n\n\t\tconst indices = [];\n\n\t\tconst position = geometry.getAttribute( 'position' );\n\n\t\tif ( position !== undefined ) {\n\n\t\t\tfor ( let i = 0; i < position.count; i ++ ) {\n\n\t\t\t\tindices.push( i );\n\n\t\t\t}\n\n\t\t\tgeometry.setIndex( indices );\n\t\t\tindex = geometry.getIndex();\n\n\t\t} else {\n\n\t\t\tconsole.error( 'THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible.' );\n\t\t\treturn geometry;\n\n\t\t}\n\n\t}\n\n\t//\n\n\tconst numberOfTriangles = index.count - 2;\n\tconst newIndices = [];\n\n\tif ( drawMode === TriangleFanDrawMode ) {\n\n\t\t// gl.TRIANGLE_FAN\n\n\t\tfor ( let i = 1; i <= numberOfTriangles; i ++ ) {\n\n\t\t\tnewIndices.push( index.getX( 0 ) );\n\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\n\t\t}\n\n\t} else {\n\n\t\t// gl.TRIANGLE_STRIP\n\n\t\tfor ( let i = 0; i < numberOfTriangles; i ++ ) {\n\n\t\t\tif ( i % 2 === 0 ) {\n\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\n\n\t\t\t} else {\n\n\t\t\t\tnewIndices.push( index.getX( i + 2 ) );\n\t\t\t\tnewIndices.push( index.getX( i + 1 ) );\n\t\t\t\tnewIndices.push( index.getX( i ) );\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n\tif ( ( newIndices.length / 3 ) !== numberOfTriangles ) {\n\n\t\tconsole.error( 'THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.' );\n\n\t}\n\n\t// build final geometry\n\n\tconst newGeometry = geometry.clone();\n\tnewGeometry.setIndex( newIndices );\n\n\treturn newGeometry;\n\n}\n\nexport { GLTFLoader };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}